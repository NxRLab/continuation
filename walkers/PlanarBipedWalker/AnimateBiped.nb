(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52527,       1047]
NotebookOptionsPosition[     51876,       1020]
NotebookOutlinePosition[     52253,       1036]
CellTagsIndexPosition[     52210,       1033]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"AnimateBiped", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "A", " ", "list", " ", "of", " ", "routines", " ", "that", " ", 
         "will", " ", "find", " ", "gaits", " ", "for", " ", "a", " ", 
         "physically"}], "-", 
        RowBox[{"symmetric", " ", "biped", " ", "walker"}]}], ".."}], "\n", 
      "Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2014", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103715538125486`*^9, 3.6103716079966354`*^9}, {
  3.610371704956188*^9, 3.610371726308409*^9}, {3.6184100462976465`*^9, 
  3.6184101083121977`*^9}, {3.6185351312823167`*^9, 3.618535132047942*^9}, {
  3.6196509377450175`*^9, 3.619650939592123*^9}, {3.619717209020617*^9, 
  3.619717212614356*^9}}],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", "\"\<PlanarBipedWalker`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367653922082*^9, 3.5933676540470953`*^9}, {
   3.60224862205973*^9, 3.602248628162079*^9}, {3.618410239888734*^9, 
   3.618410243607942*^9}, {3.618411402838331*^9, 3.6184114053624744`*^9}, 
   3.618648264733282*^9, {3.618648379655821*^9, 3.6186484159840155`*^9}, {
   3.6186600689430113`*^9, 3.618660147690508*^9}, 3.61866274541527*^9, {
   3.6186633481607847`*^9, 3.6186633510349493`*^9}, 3.618663382293741*^9, {
   3.618664471157302*^9, 3.6186644734544353`*^9}, 3.618676224046091*^9, {
   3.6186981040546894`*^9, 3.6186981152563276`*^9}, {3.6196234592833757`*^9, 
   3.6196234777521663`*^9}, {3.619623515299116*^9, 3.6196235156741133`*^9}, 
   3.6196328601116304`*^9, 3.6196401674237742`*^9, {3.6196488597011433`*^9, 
   3.619648863131336*^9}, {3.6196492958539968`*^9, 3.6196493018480144`*^9}, {
   3.6196509453301587`*^9, 3.6196509471502633`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"slope", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nl0", ",", " ", "nl", ",", " ", "p", ",", " ", "feet"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"nl0", " ", "=", " ", 
         RowBox[{
          RowBox[{"Length", "[", "hip", "]"}], " ", "+", " ", 
          RowBox[{"Length", "[", "torso", "]"}], " ", "+", " ", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nl", " ", "=", " ", 
         RowBox[{"nl0", " ", "+", " ", 
          RowBox[{"2", 
           RowBox[{"Length", "[", "legs", "]"}]}], " ", "-", " ", "1"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"a1", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"q", "\[LeftDoubleBracket]", 
             RowBox[{"nl0", ";;", "nl"}], "\[RightDoubleBracket]"}], "]"}], 
           "/", "2"}], "/", "Degree"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"1", "+", 
         RowBox[{"Sign", "[", 
          RowBox[{"Length", "[", "torso", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"feet", " ", "=", " ", 
        RowBox[{"poi", "\[LeftDoubleBracket]", 
         RowBox[{"p", ";;", 
          RowBox[{"p", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"feet", " ", "=", " ", 
        RowBox[{
         RowBox[{"NLink`Private`GetPointsAndLines", "[", 
          RowBox[{"q", ",", " ", "feet"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], ",", " ", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"feet", " ", "=", " ", 
        RowBox[{
         RowBox[{
         "feet", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
         "-", " ", 
         RowBox[{
         "feet", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"Norm", "[", "feet", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"p", " ", ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"ArcCos", "[", 
            RowBox[{
             RowBox[{"feet", ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "/", "p"}], "]"}]}], 
          "/", "Degree"}], ",", " ", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fcnanim", "[", 
     RowBox[{
      RowBox[{"s_", "?", "NumberQ"}], ",", " ", "x_"}], "]"}], " ", ":=", " ", 
    RowBox[{"fanim", "[", 
     RowBox[{"x", ",", " ", "ueq"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimulateGait", "[", 
     RowBox[{"i_Integer", ",", " ", "j_Integer"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "gaits", "]"}], " ", "\[GreaterEqual]", " ", 
        RowBox[{"Abs", "[", "i", "]"}]}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
         "gaits", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}], " ", "\[GreaterEqual]", " ", 
        RowBox[{"Abs", "[", "j", "]"}]}]}], ",", " ", 
      RowBox[{"SimulateGait", "[", 
       RowBox[{"gaits", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", " ", "j", ",", " ", "1"}], 
        "\[RightDoubleBracket]"}], "]"}], ",", " ", 
      RowBox[{"Message", "[", 
       RowBox[{"PlanarBipedWalker", "::", "index"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimulateGait", "[", "\[Lambda]_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0", ",", " ", "x", ",", " ", "T"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "\[Lambda]", "]"}], " ", "\[NotEqual]", " ", 
          RowBox[{"(", 
           RowBox[{"NLink`Private`nx", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"PlanarBipedWalker", "::", "input"}], ",", " ", 
            "\"\<equal to\>\"", ",", " ", 
            RowBox[{"NLink`Private`nx", "+", "1"}], ",", " ", 
            RowBox[{"Length", "[", "\[Lambda]", "]"}]}], "]"}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"x0", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "this", " ", "has", " ", "to", " ", "be", " ", "kept", " ", "in", " ",
          "sync", " ", "with", " ", 
         RowBox[{"map", "'"}], "s", " ", "NDSolve", " ", "in", " ", "terms", 
         " ", "of", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x", "/.", " ", 
        RowBox[{"First", "@", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "'"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
              RowBox[{"T", " ", 
               RowBox[{"fcnanim", "[", 
                RowBox[{"s", ",", " ", 
                 RowBox[{"x", "[", "s", "]"}]}], "]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", "x0"}]}], 
            "}"}], ",", " ", "x", ",", " ", 
           RowBox[{"{", 
            RowBox[{"s", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
           "mapopts"}], "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawBiped", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Line", "\[Rule]", " ", "True"}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", " ", 
      RowBox[{"Blur", "\[Rule]", " ", "True"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawBiped", "[", 
     RowBox[{"i_Integer", ",", " ", "j_Integer", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "gaits", "]"}], " ", "\[GreaterEqual]", " ", 
        RowBox[{"Abs", "[", "i", "]"}]}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
         "gaits", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}], " ", "\[GreaterEqual]", " ", 
        RowBox[{"Abs", "[", "j", "]"}]}]}], ",", " ", 
      RowBox[{"DrawBiped", "[", 
       RowBox[{
        RowBox[{"gaits", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", " ", "j", ",", " ", "1"}], 
         "\[RightDoubleBracket]"}], ",", " ", "opts"}], "]"}], ",", " ", 
      RowBox[{"Message", "[", 
       RowBox[{"PlanarBipedWalker", "::", "index"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawBiped", "[", 
     RowBox[{
      RowBox[{"q_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"DrawBiped", "[", 
     RowBox[{"q", ",", " ", "q", ",", " ", "opts", ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawBiped", "[", 
     RowBox[{
      RowBox[{"flow_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"flow0_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Sigma]", ",", " ", "w", ",", " ", "r", ",", " ", "op", ",", " ", 
        "lnks", ",", " ", "jnts", ",", " ", "slp", ",", " ", "gnd", ",", " ", 
        "pos0", ",", " ", "pos", ",", " ", "pr", ",", " ", "pl", ",", " ", 
        "is", ",", " ", "data", ",", " ", "j", ",", " ", "L", ",", " ", "m", 
        ",", " ", "soc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", "NLink`Private`nq"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "flow0", "]"}], " ", "<", " ", "m"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"PlanarBipedWalker", "::", "input"}], ",", " ", 
            "\"\<not less than\>\"", ",", " ", "m", ",", " ", 
            RowBox[{"Length", "[", "flow0", "]"}]}], "]"}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "flow", "]"}], " ", "<", " ", "m"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"PlanarBipedWalker", "::", "input"}], ",", " ", 
            "\"\<not less than\>\"", ",", " ", "m", ",", " ", 
            RowBox[{"Length", "[", "flow", "]"}]}], "]"}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "16"}], " ", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "12"}], " ", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"op", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Opacity", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"data", " ", "=", " ", 
        RowBox[{"Join", "@@", 
         RowBox[{"{", 
          RowBox[{
          "hip", ",", " ", "torso", ",", " ", "legs", ",", " ", "legs", ",", 
           " ", "head", ",", " ", "arms", ",", " ", "arms"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{
         RowBox[{"slope", "[", "flow0", "]"}], "Degree"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"j", " ", "=", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"2", 
          RowBox[{"Sign", "[", 
           RowBox[{"Length", "[", "arms", "]"}], "]"}]}], " ", "-", " ", 
         RowBox[{"Sign", "[", 
          RowBox[{"Length", "[", "head", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos0", " ", "=", " ", 
        RowBox[{
         RowBox[{"NLink`Private`GetPointsAndLines", "[", 
          RowBox[{"flow0", ",", " ", "poi"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", "j", ",", " ", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{"NLink`Private`GetPoints", "[", "flow", "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "absolute", " ", "angles"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"j", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "start", " ", "of", " ", "each", " ", "chain"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"soc", " ", "=", " ", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"poi", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], " ", 
           "+", " ", "1"}], ",", " ", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "mapping", " ", "between", " ", "bodies", " ", "and", " ", "dof"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", "NLink`Private`map"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", " ", "\[GreaterEqual]", " ", 
             RowBox[{"soc", "\[LeftDoubleBracket]", 
              RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", " ", 
            RowBox[{"j", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pos", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", "3"}], "\[RightDoubleBracket]"}], " ", "=",
            " ", 
           RowBox[{"Total", "[", 
            RowBox[{"flow", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"m", "\[LeftDoubleBracket]", 
               RowBox[{
               "soc", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ";;", 
              RowBox[{
              "m", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "\[RightDoubleBracket]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "2", ",", " ", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "is", " ", "image", " ", "part", " ", "of", " ", "motion", " ", 
         "blur", " ", "or", " ", "individual", " ", 
         RowBox[{"frame", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"lnks", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "[", "op", "]"}], ",", " ", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", " ", "Black"}], "}"}], "]"}], ",", " ", 
            "Gray", ",", " ", "Thick", ",", " ", 
            RowBox[{"Translate", "[", 
             RowBox[{
              RowBox[{"Rotate", "[", 
               RowBox[{
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "w"}], ",", " ", "0"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"w", ",", " ", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", " ", "5"}], "\[RightDoubleBracket]"}]}],
                    "}"}]}], "]"}], ",", " ", 
                RowBox[{"pos", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", "3"}], "\[RightDoubleBracket]"}], ",",
                 " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", " ", 
              RowBox[{"pos", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", " ", 
                RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
             "]"}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "2", ",", " ", 
            RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"OptionValue", "[", "Blur", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", " ", "=", " ", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"2", 
             RowBox[{"Sign", "[", 
              RowBox[{"Length", "[", "arms", "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{"Sign", "[", 
             RowBox[{"Length", "[", "head", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"m", " ", "=", " ", 
           RowBox[{"j", " ", "-", " ", 
            RowBox[{"Length", "[", "legs", "]"}], " ", "+", " ", "1"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lnks", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"m", ";;", "j"}], ",", " ", "3"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", "LightGray"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"lnks", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Join", "@@", "lnks"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"jnts", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "op", "]"}], ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", " ", "Black"}], "}"}], "]"}], ",", " ", 
              "White", ",", " ", 
              RowBox[{"Disk", "[", 
               RowBox[{"#", ",", " ", "r"}], "]"}]}], "}"}], "&"}], " ", "/@",
            " ", 
           RowBox[{"pos", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", 
             RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"L", " ", "=", " ", 
        RowBox[{"Abs", "@", 
         RowBox[{"Total", "[", 
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "5"}], "\[RightDoubleBracket]"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"slp", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", " ", "Black", ",", " ", 
          RowBox[{"Rotate", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "L"}], ",", " ", 
                 RowBox[{
                 "pos0", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"L", ",", " ", 
                 RowBox[{
                 "pos0", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "}"}], "]"}], ",", 
            " ", "\[Sigma]", ",", " ", "pos0"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"slp", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", " ", "Black", ",", " ", 
          RowBox[{"Rotate", "[", 
           RowBox[{
            RowBox[{"InfiniteLine", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "L"}], ",", " ", 
                 RowBox[{
                 "pos0", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"L", ",", " ", 
                 RowBox[{
                 "pos0", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "}"}], "]"}], ",", 
            " ", "\[Sigma]", ",", " ", "pos0"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"gnd", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighter", "@", "Black"}], ",", " ", 
          RowBox[{"InfiniteLine", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "L"}], ",", " ", 
               RowBox[{
               "pos0", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"L", ",", " ", 
               RowBox[{
               "pos0", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pr", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pr", " ", "\[Equal]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{
          RowBox[{"pr", " ", "=", " ", 
           RowBox[{"L", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pl", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Line", "]"}], ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"gnd", ",", " ", "slp"}], "]"}], ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"is", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "ImageSize", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"lnks", ",", " ", "jnts", ",", " ", 
         RowBox[{"PlotRange", "\[Rule]", " ", "pr"}], ",", " ", 
         RowBox[{"Prolog", "\[Rule]", " ", "pl"}], ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "is"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AnimateGait", "[", 
     RowBox[{"i_Integer", ",", " ", "j_Integer", ",", " ", 
      RowBox[{"steps_:", "1"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "gaits", "]"}], " ", "\[GreaterEqual]", " ", 
        RowBox[{"Abs", "[", "i", "]"}]}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
         "gaits", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}], " ", "\[GreaterEqual]", " ", 
        RowBox[{"Abs", "[", "j", "]"}]}]}], ",", " ", 
      RowBox[{"AnimateGait", "[", 
       RowBox[{
        RowBox[{"gaits", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", " ", "j", ",", " ", "1"}], 
         "\[RightDoubleBracket]"}], ",", " ", "steps"}], "]"}], ",", " ", 
      RowBox[{"Message", "[", 
       RowBox[{"PlanarBipedWalker", "::", "index"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AnimateGait", "[", 
    RowBox[{"\[Lambda]_", ",", " ", 
     RowBox[{"steps_:", "1"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "flow", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"flow", " ", "=", " ", 
       RowBox[{"SimulateGait", "[", "\[Lambda]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DrawBiped", "[", 
         RowBox[{
          RowBox[{"flow", "[", "s", "]"}], ",", " ", 
          RowBox[{"flow", "[", "0", "]"}]}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6184103998248963`*^9, 3.6184104065752783`*^9}, {
   3.6184104688478436`*^9, 3.618410525544091*^9}, {3.618411628574258*^9, 
   3.6184116536326933`*^9}, {3.618411686120554*^9, 3.618411695752105*^9}, {
   3.6184117324212046`*^9, 3.6184117352223654`*^9}, {3.618411767360206*^9, 
   3.6184117678082323`*^9}, {3.618411801632169*^9, 3.6184118056643953`*^9}, {
   3.618411964664505*^9, 3.618412013057276*^9}, {3.6185351488448467`*^9, 
   3.6185352163293586`*^9}, {3.6185353050635457`*^9, 
   3.6185353077026978`*^9}, {3.618535351465203*^9, 3.6185353526322703`*^9}, {
   3.618535395294711*^9, 3.6185353973668323`*^9}, {3.6185354641976566`*^9, 
   3.6185354836797748`*^9}, {3.618535606431804*^9, 3.6185358547560425`*^9}, {
   3.6185358865808477`*^9, 3.61853589038006*^9}, {3.618578466833031*^9, 
   3.6185785529113445`*^9}, {3.618578602239567*^9, 3.61857863792712*^9}, {
   3.6185786990366135`*^9, 3.6185787138491445`*^9}, {3.618578766833623*^9, 
   3.6185787910836763`*^9}, {3.618578828271246*^9, 3.6185788778026047`*^9}, {
   3.6185789285526867`*^9, 3.6185789518808575`*^9}, {3.618579030927887*^9, 
   3.6185791419437337`*^9}, {3.6185791910532017`*^9, 
   3.6185792557564526`*^9}, {3.6185793164597*^9, 3.618579412038023*^9}, {
   3.6185794458193245`*^9, 3.6185794858037767`*^9}, {3.618579553163283*^9, 
   3.6185795928039875`*^9}, {3.618590038412656*^9, 3.6185900539595623`*^9}, {
   3.6185901449909887`*^9, 3.618590194209837*^9}, {3.6185909029455976`*^9, 
   3.618591016633321*^9}, {3.6185910481646276`*^9, 3.6185911786180115`*^9}, {
   3.6185913493270483`*^9, 3.6185914596553903`*^9}, {3.618591553968074*^9, 
   3.6185916718745584`*^9}, {3.6185917063902483`*^9, 
   3.6185917141715145`*^9}, {3.6185917763903885`*^9, 
   3.6185919018125067`*^9}, {3.6185919743126464`*^9, 3.61859198203141*^9}, {
   3.6185922376725388`*^9, 3.6185923476102514`*^9}, 3.6185924187666583`*^9, {
   3.618592477969884*^9, 3.618592621392054*^9}, {3.618592655985855*^9, 
   3.6185926704702606`*^9}, {3.6185927014390836`*^9, 3.618592834470597*^9}, {
   3.618592868173769*^9, 3.6185929703770943`*^9}, {3.618593270971449*^9, 
   3.6185934206592236`*^9}, {3.618660269868504*^9, 3.61866031396603*^9}, {
   3.6186603494290595`*^9, 3.6186603850361166`*^9}, {3.618660420393124*^9, 
   3.6186604558131523`*^9}, {3.6186605538237824`*^9, 3.618660553880768*^9}, {
   3.6186606332743278`*^9, 3.618660647126113*^9}, {3.6186621203404746`*^9, 
   3.6186621209385076`*^9}, 3.618662159397715*^9, {3.618662196428832*^9, 
   3.6186622349700384`*^9}, {3.6186622680459332`*^9, 3.618662317168747*^9}, 
   3.6186623503876495`*^9, {3.6186624505033865`*^9, 3.618662773331869*^9}, {
   3.618662806667775*^9, 3.6186629040923567`*^9}, {3.618662985123997*^9, 
   3.618663058846219*^9}, {3.6186631001626034`*^9, 3.6186631236589317`*^9}, {
   3.618663166758397*^9, 3.618663263696951*^9}, {3.6186634446043105`*^9, 
   3.6186634518007236`*^9}, {3.6186635131352344`*^9, 
   3.6186635155963707`*^9}, {3.618663545719101*^9, 3.618663575923835*^9}, {
   3.618663667385068*^9, 3.6186636859051285`*^9}, {3.618663720526125*^9, 
   3.6186637829416857`*^9}, {3.6186639671522317`*^9, 
   3.6186640010271883`*^9}, {3.618664050129986*^9, 3.618664079698679*^9}, {
   3.618664164622548*^9, 3.618664238484773*^9}, {3.618664281733249*^9, 
   3.618664290936781*^9}, {3.6186643298880067`*^9, 3.618664347252002*^9}, {
   3.618664479584786*^9, 3.6186644802158213`*^9}, {3.6186645348059483`*^9, 
   3.618664536347039*^9}, {3.6186647745576773`*^9, 3.6186648050454206`*^9}, {
   3.618664843083602*^9, 3.6186649302815957`*^9}, {3.618665015169456*^9, 
   3.6186650953770494`*^9}, {3.618665173066497*^9, 3.618665173330514*^9}, {
   3.618665249776889*^9, 3.618665276259427*^9}, {3.6186653289334292`*^9, 
   3.6186653415041633`*^9}, {3.618665415883404*^9, 3.618665555633404*^9}, {
   3.6186655956456957`*^9, 3.6186656179339743`*^9}, {3.618665669025904*^9, 
   3.618665697409523*^9}, 3.6186657582290106`*^9, {3.618665855082573*^9, 
   3.618665862295971*^9}, {3.618666021186067*^9, 3.618666025849334*^9}, {
   3.61866606772873*^9, 3.61866609981157*^9}, {3.618666333192935*^9, 
   3.6186663513699737`*^9}, 3.6186664479085045`*^9, {3.618666527208043*^9, 
   3.618666547415203*^9}, {3.618666747362653*^9, 3.6186667552791023`*^9}, {
   3.6186669571456804`*^9, 3.618667040851461*^9}, {3.6186671563520794`*^9, 
   3.6186672611470733`*^9}, {3.618667320714484*^9, 3.618667344013822*^9}, {
   3.61866737534562*^9, 3.618667408816531*^9}, {3.618667656051688*^9, 
   3.6186676962299895`*^9}, {3.6186677845110474`*^9, 3.618667811180572*^9}, {
   3.618670142602086*^9, 3.6186701650583763`*^9}, {3.618670208240844*^9, 
   3.6186702120180597`*^9}, {3.6186702494182043`*^9, 3.618670273249566*^9}, {
   3.618670306009442*^9, 3.6186703157009974`*^9}, {3.6186703767924957`*^9, 
   3.618670456082039*^9}, {3.6186706387234945`*^9, 3.618670697834883*^9}, {
   3.6186707334979253`*^9, 3.6186708044249873`*^9}, {3.6186708396750236`*^9, 
   3.6186708671555796`*^9}, {3.618671099948914*^9, 3.6186711755882397`*^9}, {
   3.6186712342115965`*^9, 3.618671300097372*^9}, {3.6186713947637987`*^9, 
   3.618671403593297*^9}, {3.618671437339246*^9, 3.6186714444736404`*^9}, {
   3.618671487652109*^9, 3.618671504390069*^9}, {3.61867156180438*^9, 
   3.618671565219556*^9}, 3.6186717839468217`*^9, {3.618671817818762*^9, 
   3.618671835614781*^9}, {3.618671960560933*^9, 3.618671980639087*^9}, {
   3.618672250041517*^9, 3.618672325975862*^9}, {3.618672372181508*^9, 
   3.618672380980013*^9}, {3.618672436605202*^9, 3.6186724569633603`*^9}, {
   3.618672681732236*^9, 3.618672775812628*^9}, {3.6186728079084663`*^9, 
   3.618673004058691*^9}, {3.6186730355534983`*^9, 3.6186730432689404`*^9}, {
   3.6186731082216597`*^9, 3.6186731187202578`*^9}, {3.618673157606485*^9, 
   3.618673281951605*^9}, {3.6186733618791857`*^9, 3.6186735173880916`*^9}, {
   3.6186736180388517`*^9, 3.6186737163024793`*^9}, {3.6186737731197357`*^9, 
   3.6186737795020995`*^9}, {3.6186738129490137`*^9, 
   3.6186738477950125`*^9}, {3.6186738789187913`*^9, 3.61867388291302*^9}, {
   3.618673991017214*^9, 3.6186740531067705`*^9}, {3.61867433318681*^9, 
   3.6186745802629614`*^9}, {3.6186746179481163`*^9, 
   3.6186746187221575`*^9}, {3.6186746490818996`*^9, 3.6186746532921534`*^9}, 
   3.618674739034047*^9, 3.618674774387074*^9, {3.618674819239646*^9, 
   3.618674822483824*^9}, 3.6186750684009085`*^9, {3.618675130070445*^9, 
   3.6186751346177006`*^9}, {3.6186755254460835`*^9, 3.618675558100955*^9}, {
   3.6186756464840164`*^9, 3.6186758025029483`*^9}, {3.6186758732650003`*^9, 
   3.6186758737710295`*^9}, 3.6186763255799055`*^9, {3.618676373383644*^9, 
   3.6186764285558023`*^9}, {3.6186982832679453`*^9, 
   3.6186982854260693`*^9}, {3.6186983297466116`*^9, 
   3.6186983621394663`*^9}, {3.6186984459462843`*^9, 3.618698466963485*^9}, {
   3.618698667436949*^9, 3.618698700476841*^9}, {3.6186989596506834`*^9, 
   3.618698978481762*^9}, {3.6186990537390714`*^9, 3.6186990902411623`*^9}, {
   3.618699126045212*^9, 3.618699373919408*^9}, {3.6186994086624136`*^9, 
   3.6186994143537188`*^9}, {3.618699502071748*^9, 3.618699502247757*^9}, {
   3.6186996057196994`*^9, 3.618699606104703*^9}, {3.6186996660801387`*^9, 
   3.6186996957698517`*^9}, {3.6186997624416537`*^9, 3.618699857996126*^9}, {
   3.6186999494043636`*^9, 3.6186999901876984`*^9}, {3.6187000464209166`*^9, 
   3.618700103804222*^9}, {3.618700155189148*^9, 3.618700239067949*^9}, {
   3.618700272275854*^9, 3.618700276476094*^9}, {3.6187004259316473`*^9, 
   3.618700442929626*^9}, {3.6187007255728264`*^9, 3.618700785279231*^9}, {
   3.6187008173890696`*^9, 3.618700818010105*^9}, {3.6187008494469085`*^9, 
   3.6187009076812396`*^9}, {3.6187009378609676`*^9, 3.618701041032877*^9}, {
   3.618701097741124*^9, 3.618701108056715*^9}, {3.6187011520042315`*^9, 
   3.6187011864762053`*^9}, {3.618701296972537*^9, 3.618701352701739*^9}, {
   3.618701391012919*^9, 3.618701391194929*^9}, 3.618701449811286*^9, 
   3.6187015915374017`*^9, {3.618701740808951*^9, 3.618701741113968*^9}, {
   3.6187017865055685`*^9, 3.6187017983132443`*^9}, {3.6187020449583774`*^9, 
   3.618702047856535*^9}, {3.6196227804624786`*^9, 3.6196227808843517`*^9}, {
   3.619623185876609*^9, 3.6196232384860873`*^9}, {3.619623452955239*^9, 
   3.6196234546896152`*^9}, {3.6196234847834253`*^9, 3.6196235107522273`*^9}, 
   3.6196309683217125`*^9, {3.6196310009467893`*^9, 3.619631027149948*^9}, {
   3.6196310784312963`*^9, 3.619631123243889*^9}, {3.619631312447383*^9, 
   3.6196313142598853`*^9}, {3.619631385947521*^9, 3.61963140168193*^9}, {
   3.6196315198696594`*^9, 3.619631544072834*^9}, {3.61963169035437*^9, 
   3.619631706385651*^9}, {3.619631739729463*^9, 3.619631752401366*^9}, {
   3.619631846917176*^9, 3.619631900401656*^9}, {3.6196319386048565`*^9, 
   3.6196320332769146`*^9}, {3.619632228542921*^9, 3.6196322953243027`*^9}, {
   3.6196323412775145`*^9, 3.6196323961369963`*^9}, {3.61963245226211*^9, 
   3.6196324736684*^9}, {3.619632661387533*^9, 3.6196327312207346`*^9}, {
   3.619632761798917*^9, 3.6196327966271105`*^9}, 3.6196328600334835`*^9, 
   3.619633213674801*^9, {3.6196334103001847`*^9, 3.6196335573629727`*^9}, {
   3.619633610425578*^9, 3.61963381416035*^9}, {3.6196338463479123`*^9, 
   3.6196338611604385`*^9}, {3.6196339343480873`*^9, 3.619634022770133*^9}, {
   3.6196340887546363`*^9, 3.6196341144890623`*^9}, {3.6196346546619935`*^9, 
   3.619634672708909*^9}, {3.619634766896587*^9, 3.6196347873341284`*^9}, {
   3.619634877740554*^9, 3.619634905959361*^9}, {3.6196349976939163`*^9, 
   3.6196349982407913`*^9}, {3.619635101272243*^9, 3.6196351154753942`*^9}, {
   3.6196351876942863`*^9, 3.619635229584992*^9}, {3.6196353100382752`*^9, 
   3.6196353121164093`*^9}, {3.6196353673352737`*^9, 
   3.6196354099759755`*^9}, {3.619635728179717*^9, 3.6196357477578816`*^9}, {
   3.6196360176490517`*^9, 3.6196360183209305`*^9}, {3.619636298337101*^9, 
   3.61963634950906*^9}, {3.619636454759262*^9, 3.619636479415561*^9}, {
   3.6196365208531404`*^9, 3.6196365221968946`*^9}, 3.6196365541344585`*^9, {
   3.6196367344941874`*^9, 3.6196368607756824`*^9}, {3.6196369036664047`*^9, 
   3.619636955307118*^9}, {3.6196370003540792`*^9, 3.6196371984794683`*^9}, {
   3.6196372301670322`*^9, 3.6196372355889115`*^9}, {3.6196372729327393`*^9, 
   3.6196373142765703`*^9}, {3.6196373564797773`*^9, 3.619637472464379*^9}, {
   3.619637553839546*^9, 3.6196375822927184`*^9}, 3.6196376821366644`*^9, {
   3.6196377140586014`*^9, 3.6196377476055527`*^9}, {3.619637915793372*^9, 
   3.619637921949633*^9}, {3.6196382379033766`*^9, 3.6196382449658895`*^9}, {
   3.619638282528462*^9, 3.6196382933878603`*^9}, {3.6196384040297003`*^9, 
   3.619638404576576*^9}, {3.619638461717311*^9, 3.6196385189986753`*^9}, {
   3.6196385601081295`*^9, 3.619638563123761*^9}, {3.6196386000925827`*^9, 
   3.619638615920738*^9}, {3.6196387197334456`*^9, 3.619638800936725*^9}, {
   3.6196388440149355`*^9, 3.619638844108684*^9}, {3.6196389129525704`*^9, 
   3.6196389332338595`*^9}, {3.6196392197187967`*^9, 
   3.6196393716097174`*^9}, {3.619639482203684*^9, 3.6196394934693274`*^9}, {
   3.619639533313156*^9, 3.6196395593600855`*^9}, {3.619639639703992*^9, 
   3.619639640813369*^9}, {3.619639936063946*^9, 3.619639969126511*^9}, {
   3.6196401037048993`*^9, 3.6196401082986584`*^9}, 3.6196401674550247`*^9, 
   3.6196402544239445`*^9, {3.6196407054560757`*^9, 3.61964072531549*^9}, {
   3.619641503785758*^9, 3.6196415099264*^9}, {3.619641542332711*^9, 
   3.619641577004655*^9}, {3.619641912755312*^9, 3.619641922927206*^9}, 
   3.619641968083544*^9, {3.61964204811495*^9, 3.619642065974357*^9}, {
   3.619642238959092*^9, 3.6196422409590845`*^9}, {3.619642310849839*^9, 
   3.6196423300530024`*^9}, {3.619642385584361*^9, 3.6196424049125223`*^9}, {
   3.619647515687639*^9, 3.6196475170782905`*^9}, {3.6196476079846973`*^9, 
   3.619647609281579*^9}, {3.6196476689379377`*^9, 3.6196477042192583`*^9}, {
   3.6196478297820034`*^9, 3.6196478318601336`*^9}, {3.6196485753827744`*^9, 
   3.619648660400223*^9}, {3.619648737738014*^9, 3.6196487847018003`*^9}, {
   3.6196488179395065`*^9, 3.6196488316272874`*^9}, 3.619648882993207*^9, {
   3.6196489289033732`*^9, 3.619648942224885*^9}, {3.619648985127706*^9, 
   3.619648985661733*^9}, {3.619649106681037*^9, 3.6196491686886992`*^9}, 
   3.6196491990358744`*^9, 3.619649762747835*^9, {3.619649795940443*^9, 
   3.6196497962914553`*^9}, {3.6196511107160463`*^9, 3.619651111495676*^9}, {
   3.619652315019839*^9, 3.619652315435867*^9}, {3.6196523742424154`*^9, 
   3.6196523757015038`*^9}, {3.6196524539002943`*^9, 3.619652470604253*^9}, {
   3.619717180208043*^9, 3.619717181442423*^9}, {3.6197180358648777`*^9, 
   3.619718038052385*^9}, {3.6197390777062163`*^9, 3.61973910958128*^9}, {
   3.6197395940509777`*^9, 3.61973961284789*^9}, {3.619739652957343*^9, 
   3.6197397578325467`*^9}, {3.6197398306139402`*^9, 3.619739856754616*^9}, {
   3.619740012708046*^9, 3.6197400127549205`*^9}, 3.6197401280363965`*^9, {
   3.6197401616770887`*^9, 3.6197401744114876`*^9}, {3.61974060796323*^9, 
   3.619740621510132*^9}, {3.6197406866977606`*^9, 3.61974094704202*^9}, {
   3.6197410680110035`*^9, 3.6197410684485044`*^9}, {3.6197411703549566`*^9, 
   3.619741180198725*^9}, {3.6197412326519537`*^9, 3.6197412863551826`*^9}, {
   3.619742082505355*^9, 3.6197421385210896`*^9}, {3.619742185505557*^9, 
   3.619742284943252*^9}, {3.6197423193026943`*^9, 3.6197423196464453`*^9}, {
   3.619742392505963*^9, 3.6197424093028708`*^9}, {3.619742478756131*^9, 
   3.619742478818634*^9}, {3.6197427729442067`*^9, 3.619742892397565*^9}, {
   3.619743141991804*^9, 3.619743333882804*^9}, {3.6197434403048863`*^9, 
   3.619743543898844*^9}, {3.6197435989926977`*^9, 3.6197436195083623`*^9}, {
   3.61974366463345*^9, 3.619743692352255*^9}, {3.619743755899254*^9, 
   3.619743756274254*^9}, {3.619743962680909*^9, 3.6197439701652975`*^9}, {
   3.6197440004309826`*^9, 3.6197440018997345`*^9}, {3.6197440368998036`*^9, 
   3.619744114103079*^9}, {3.619744172525069*^9, 3.619744196493865*^9}, {
   3.6197442612127404`*^9, 3.61974426779088*^9}, {3.619744303744092*^9, 
   3.6197443170409803`*^9}, {3.619744364525444*^9, 3.6197443681817007`*^9}, {
   3.61974440855678*^9, 3.619744408900531*^9}, {3.619744448588111*^9, 
   3.619744455400622*^9}, {3.619744504666345*^9, 3.6197445662133384`*^9}, {
   3.619744642838488*^9, 3.619744678604183*^9}, {3.619744713526126*^9, 
   3.6197447179480276`*^9}, {3.619744765323098*^9, 3.619744798307547*^9}, {
   3.6197448725889378`*^9, 3.619744895276481*^9}, {3.6197452634022017`*^9, 
   3.6197452749334745`*^9}, {3.6197453792930555`*^9, 
   3.6197454009649715`*^9}, {3.619745689746786*^9, 3.619745689824909*^9}, {
   3.619745977387992*^9, 3.6197459806223545`*^9}, {3.6197461369976597`*^9, 
   3.6197461406539164`*^9}, {3.6197463403730555`*^9, 3.619746343826189*^9}, 
   3.6197468165458603`*^9, {3.619746983499316*^9, 3.619746984202442*^9}, {
   3.61974730107806*^9, 3.6197473082343435`*^9}, {3.6197473919688625`*^9, 
   3.6197473922344885`*^9}, {3.6197482494988375`*^9, 
   3.6197483711553264`*^9}, {3.6197485952338843`*^9, 
   3.6197487353435388`*^9}, {3.6197487930155277`*^9, 
   3.6197489025313654`*^9}, {3.6197489421720695`*^9, 3.619748944297073*^9}, {
   3.6197489934221697`*^9, 3.619749052969165*^9}, {3.6197490898754835`*^9, 
   3.619749095125492*^9}, {3.6197493084071603`*^9, 3.6197494615012093`*^9}, {
   3.6197499866584883`*^9, 3.6197501436431713`*^9}, {3.619750179861989*^9, 
   3.6197501857995014`*^9}, {3.619750225705829*^9, 3.61975022586208*^9}, {
   3.6197503007997255`*^9, 3.619750337034172*^9}, {3.6197505032219963`*^9, 
   3.6197505057376285`*^9}, 3.6197508910040207`*^9, {3.6197509552541285`*^9, 
   3.6197510163011246`*^9}, {3.619751053879323*^9, 3.619751077238744*^9}, {
   3.6197511267544665`*^9, 3.619751200801486*^9}, {3.619751285614152*^9, 
   3.6197513225204744`*^9}, {3.6197513620674267`*^9, 
   3.6197513733330727`*^9}, {3.6197514060518885`*^9, 3.619751413239401*^9}, {
   3.6197514833176637`*^9, 3.619751483505164*^9}, {3.619751528255251*^9, 
   3.619751528802128*^9}, {3.6197516846618056`*^9, 3.6197516885680647`*^9}, {
   3.619751743193172*^9, 3.619751760661955*^9}, {3.6197519000841208`*^9, 
   3.6197519728967447`*^9}, {3.6197520891313477`*^9, 
   3.6197520893969736`*^9}, {3.6197521216314073`*^9, 
   3.6197521878034124`*^9}, {3.6197522194909782`*^9, 3.61975231164742*^9}, {
   3.6197526076636114`*^9, 3.619752768132675*^9}, {3.6197528461015778`*^9, 
   3.619752869351621*^9}, {3.6197529336017475`*^9, 3.619752959679926*^9}, {
   3.619753149602167*^9, 3.61975323818047*^9}, {3.619753349852559*^9, 
   3.619753364774466*^9}, {3.6198048498903255`*^9, 3.6198049066716723`*^9}, {
   3.619805004609377*^9, 3.6198050297969327`*^9}, {3.619805409750782*^9, 
   3.619805411375786*^9}, {3.6198054670008945`*^9, 3.6198054706102767`*^9}, {
   3.619805786204644*^9, 3.619805789204651*^9}, {3.619830998558628*^9, 
   3.6198310510431037`*^9}, {3.619831115605734*^9, 3.6198311168244867`*^9}, {
   3.619831271809164*^9, 3.619831315027999*^9}, {3.6198313810593786`*^9, 
   3.6198314012312927`*^9}, {3.619867843820674*^9, 3.619867849289422*^9}, {
   3.6198678886801195`*^9, 3.619867957805256*^9}, {3.619867990227192*^9, 
   3.6198680147428875`*^9}, {3.6198680459616756`*^9, 3.619868063664837*^9}, {
   3.61986842046241*^9, 3.6198684694000096`*^9}, {3.6198693375594196`*^9, 
   3.6198693375750456`*^9}, {3.619869388012643*^9, 3.619869424434589*^9}, {
   3.619917843126641*^9, 3.6199178450507507`*^9}, {3.6199213815242724`*^9, 
   3.6199213834353848`*^9}, {3.619922790976986*^9, 3.6199227930200987`*^9}, {
   3.619923571332676*^9, 3.6199235723857484`*^9}, {3.619923875943119*^9, 
   3.619923933783431*^9}, {3.619923990307667*^9, 3.6199240379043937`*^9}, {
   3.619924101758052*^9, 3.619924109054486*^9}, {3.6199241694189224`*^9, 
   3.6199242805232925`*^9}, {3.6199247856462097`*^9, 
   3.6199248705550766`*^9}, {3.6199249656915383`*^9, 
   3.6199249662165546`*^9}, {3.619942525206463*^9, 3.6199425353190436`*^9}, {
   3.6236875076418085`*^9, 3.623687524219971*^9}, {3.6236876470170803`*^9, 
   3.62368765939211*^9}, {3.6236881497211933`*^9, 3.6236882692995477`*^9}, {
   3.6236883055652447`*^9, 3.6236883094090023`*^9}, {3.6236883623309793`*^9, 
   3.6236884928624983`*^9}, {3.6236886425502834`*^9, 3.6236886674722023`*^9}, 
   3.6236888148631163`*^9, {3.6236892117545147`*^9, 3.623689212942024*^9}, {
   3.623689367504826*^9, 3.6236894175205626`*^9}, {3.623689839740118*^9, 
   3.623689902740247*^9}, {3.6236899417871933`*^9, 3.623690023443603*^9}, {
   3.6236902455534134`*^9, 3.6236903213035603`*^9}, 3.6236906103632317`*^9, {
   3.623690748097875*^9, 3.623690784722947*^9}, {3.6236913967649555`*^9, 
   3.623691410608732*^9}, {3.6428135181060925`*^9, 3.6428135209891376`*^9}, {
   3.642872311907417*^9, 3.6428723592924223`*^9}, {3.6428724469658723`*^9, 
   3.6428724700417075`*^9}, {3.6428732279912643`*^9, 
   3.6428732309143314`*^9}, {3.642875082440296*^9, 3.642875093299637*^9}, {
   3.642875299420698*^9, 3.6428753007521906`*^9}, {3.6429373399317074`*^9, 
   3.642937342777542*^9}, {3.642939713874081*^9, 3.6429397442280445`*^9}, {
   3.642939801321723*^9, 3.642939814418805*^9}, {3.6429399906866493`*^9, 
   3.642940019799033*^9}, 3.642940244567275*^9, {3.642940288616612*^9, 
   3.642940291216118*^9}, {3.6429403436983614`*^9, 3.642940405024129*^9}, {
   3.6429404651493807`*^9, 3.64294046524715*^9}, {3.6429407007749324`*^9, 
   3.6429407222169404`*^9}, {3.642940783260172*^9, 3.6429408984368687`*^9}, {
   3.642940960502682*^9, 3.6429409818606186`*^9}, 3.64294103519438*^9, {
   3.6429412674286833`*^9, 3.6429412710683274`*^9}, {3.642941355564535*^9, 
   3.642941384654439*^9}, {3.6429434769758835`*^9, 3.6429435356993523`*^9}, {
   3.6429436863822103`*^9, 3.6429437949312954`*^9}, {3.6429438486991067`*^9, 
   3.6429438490657005`*^9}, {3.6429439089917336`*^9, 
   3.6429439274452868`*^9}, {3.6429513675443506`*^9, 
   3.6429513777056775`*^9}, {3.6429514922656927`*^9, 
   3.6429514936450925`*^9}, {3.6429515371636295`*^9, 
   3.6429516137483144`*^9}, {3.642951677374467*^9, 3.642951682396473*^9}, {
   3.642951754984579*^9, 3.6429517809715137`*^9}, {3.6429518728585606`*^9, 
   3.642951878470068*^9}, {3.6430387628379717`*^9, 3.6430387640879855`*^9}, {
   3.6430411951335354`*^9, 3.6430412373058476`*^9}, {3.643041314228569*^9, 
   3.6430413226662164`*^9}, {3.6430414446362576`*^9, 
   3.6430414574957747`*^9}, {3.6430479534364643`*^9, 
   3.6430479595455756`*^9}, {3.6430481137050614`*^9, 3.643048136448444*^9}, {
   3.643107781557948*^9, 3.6431077946150045`*^9}, {3.643107900799695*^9, 
   3.643107900972742*^9}, {3.6431084106183953`*^9, 3.643108413515071*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 3.5914868026208353`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{775, 607},
WindowMargins->{{Automatic, 146}, {21, Automatic}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3194, 64, 313, "Code",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3777, 88, 100, 1, 70, "Section"],
Cell[3880, 91, 2162, 31, 52, "Input",
 InitializationCell->True],
Cell[6045, 124, 45538, 882, 2472, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51620, 1011, 30, 0, 70, "Section"],
Cell[51653, 1013, 207, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
