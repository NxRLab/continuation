(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71311,       1475]
NotebookOptionsPosition[     70443,       1440]
NotebookOutlinePosition[     70819,       1456]
CellTagsIndexPosition[     70776,       1453]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"FindGaits", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "A", " ", "list", " ", "of", " ", "routines", " ", "that", " ", 
         "will", " ", "find", " ", "gaits", " ", "for", " ", "a", " ", 
         "physically"}], "-", 
        RowBox[{"symmetric", " ", "biped", " ", "walker"}]}], ".."}], "\n", 
      "Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2014", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103715538125486`*^9, 3.6103716079966354`*^9}, {
  3.610371704956188*^9, 3.610371726308409*^9}, {3.6184100462976465`*^9, 
  3.6184101083121977`*^9}, {3.6185351312823167`*^9, 3.618535132047942*^9}, {
  3.6196509377450175`*^9, 3.619650939592123*^9}, {3.619651069169732*^9, 
  3.6196510704478097`*^9}}],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", "\"\<PlanarBipedWalker`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367653922082*^9, 3.5933676540470953`*^9}, {
   3.60224862205973*^9, 3.602248628162079*^9}, {3.618410239888734*^9, 
   3.618410243607942*^9}, {3.618411402838331*^9, 3.6184114053624744`*^9}, 
   3.618648264733282*^9, {3.618648379655821*^9, 3.6186484159840155`*^9}, {
   3.6186600689430113`*^9, 3.618660147690508*^9}, 3.61866274541527*^9, {
   3.6186633481607847`*^9, 3.6186633510349493`*^9}, 3.618663382293741*^9, {
   3.618664471157302*^9, 3.6186644734544353`*^9}, 3.618676224046091*^9, {
   3.6186981040546894`*^9, 3.6186981152563276`*^9}, {3.6196234592833757`*^9, 
   3.6196234777521663`*^9}, {3.619623515299116*^9, 3.6196235156741133`*^9}, 
   3.6196328601116304`*^9, 3.6196401674237742`*^9, {3.6196488597011433`*^9, 
   3.619648863131336*^9}, {3.6196492958539968`*^9, 3.6196493018480144`*^9}, {
   3.6196509453301587`*^9, 3.6196509471502633`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find Time", "Section",
 CellChangeTimes->{{3.6196514146905727`*^9, 3.6196514193018365`*^9}, {
  3.619651457663819*^9, 3.619651460339968*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotBipedDet", "[", 
     RowBox[{"t0_", ",", " ", "tf_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "Plot", "]"}]}]}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"cost", "[", "s", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"s", ",", " ", "t0", ",", " ", "tf"}], "}"}], ",", " ", "opts",
       ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cost", "[", 
     RowBox[{"s_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"C", ",", " ", "n", ",", " ", "m"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", "NLink`Private`mb"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{
         RowBox[{"A", ".", "dh", ".", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{"df", " ", "s"}], "]"}]}], " ", "-", " ", 
         RowBox[{"dx0", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"n", "+", "m"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
        RowBox[{"-", "dv"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Det", "[", "C", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dcost", "[", 
     RowBox[{"s_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"C", ",", " ", "dC", ",", " ", "n", ",", " ", "m"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", "NLink`Private`mb"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{
         RowBox[{"A", ".", "dh", ".", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{"df", " ", "s"}], "]"}]}], " ", "-", " ", 
         RowBox[{"dx0", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"n", "+", "m"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
        RowBox[{"-", "dv"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dC", " ", "=", " ", 
        RowBox[{"A", ".", "dh", ".", "df", ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"df", " ", "s"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dC", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"n", "+", "m"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"Dimensions", "@", "dv"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Det", "[", "C", "]"}], " ", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"PseudoInverse", "[", "C", "]"}], ".", "dC"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"approxRoots", "[", 
     RowBox[{"tf_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "NDSolve", "]"}]}]}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"approxRoots", "[", 
     RowBox[{"0", ",", " ", "tf", ",", " ", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"approxRoots", "[", 
     RowBox[{"t0_", ",", " ", "tf_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "s"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", " ", "=", " ", 
        RowBox[{
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Off", "[", 
            RowBox[{
             StyleBox[
              RowBox[{"Inverse", "::", "sing"}], "MessageName"], 
             StyleBox[",", "MessageName"], " ", 
             StyleBox[
              RowBox[{"Inverse", "::", "luc"}], "MessageName"]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"y", "'"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
                RowBox[{"dcost", "[", "s", "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"y", "[", "t0", "]"}], " ", "\[Equal]", " ", 
                RowBox[{"cost", "[", "t0", "]"}]}], ",", " ", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "s", "]"}], "\[Equal]", "0"}], ",", 
                 RowBox[{"Sow", "[", "s", "]"}]}], "]"}]}], 
              RowBox[{"(*", 
               RowBox[{",", " ", 
                RowBox[{"WhenEvent", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"y", "'"}], "[", "s", "]"}], "\[Equal]", "0"}], 
                   " ", "&&", " ", 
                   RowBox[{
                    RowBox[{"y", "[", "s", "]"}], "\[Equal]", "0"}]}], ",", 
                  RowBox[{"Sow", "[", "s", "]"}]}], "]"}]}], "*)"}], "}"}], 
             ",", " ", 
             RowBox[{"{", "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"s", ",", " ", "tf", ",", " ", "tf"}], "}"}], ",", 
             "\[IndentingNewLine]", "opts"}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"On", "[", 
            RowBox[{
             StyleBox[
              RowBox[{"Inverse", "::", "sing"}], "MessageName"], 
             StyleBox[",", "MessageName"], " ", 
             StyleBox[
              RowBox[{"Inverse", "::", "luc"}], "MessageName"]}], "]"}], 
           ";"}], "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"First", "[", "y", "]"}], ",", " ", "y"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"refineRoots", ",", " ", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"refineRoots", "[", "t_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", " ", "T"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Off", "[", 
        StyleBox[
         RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
        StyleBox["]", "MessageName"]}], 
       StyleBox[";", "MessageName"], "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cost", "[", "s", "]"}], " ", "\[Equal]", " ", "0"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"s", ",", " ", "t"}], "}"}], ",", " ", 
          RowBox[{"AccuracyGoal", "\[Rule]", "15"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "15"}], ",", " ", 
          RowBox[{"MaxIterations", "\[Rule]", "5000"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"On", "[", 
        StyleBox[
         RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
        StyleBox["]", "MessageName"]}], 
       StyleBox[";", "MessageName"], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "T", "]"}], " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"s", "/.", " ", "T"}], ",", " ", "T"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reallyRefineRoot", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", " ", "T", ",", " ", "c", ",", " ", "\[Lambda]"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"xeq", ",", " ", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{"x_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          "x"}], ";", 
         RowBox[{"Det", "[", 
          RowBox[{
           RowBox[{"root", "[", "\[Lambda]", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], "]"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       StyleBox[
        RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
       StyleBox["]", "MessageName"]}], 
      StyleBox[";", "MessageName"], "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "s", "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"s", ",", " ", "t"}], "}"}], ",", " ", 
         RowBox[{"AccuracyGoal", "\[Rule]", "15"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "15"}], ",", " ", 
         RowBox[{"MaxIterations", "\[Rule]", "5000"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"On", "[", 
       StyleBox[
        RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
       StyleBox["]", "MessageName"]}], 
      StyleBox[";", "MessageName"], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "T", "]"}], " ", ">", " ", "0"}], ",", " ", 
        RowBox[{"s", "/.", " ", "T"}], ",", " ", "\[Infinity]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619651519816166*^9, 3.6196515417734265`*^9}, {
   3.619651693307093*^9, 3.619651721802081*^9}, {3.6196518359836226`*^9, 
   3.61965185986799*^9}, {3.619651891383377*^9, 3.619651939682478*^9}, {
   3.619652003787507*^9, 3.6196520132990556`*^9}, {3.61965270029597*^9, 
   3.619652713536729*^9}, {3.6196527444427505`*^9, 3.6196528400846834`*^9}, 
   3.619653771128993*^9, 3.6196583389639797`*^9, {3.619658414777321*^9, 
   3.6196584891025777`*^9}, {3.6196611746263685`*^9, 
   3.6196612200469694`*^9}, {3.619661296925372*^9, 3.619661299543527*^9}, {
   3.6196614557524686`*^9, 3.6196614577005777`*^9}, {3.6196614883443336`*^9, 
   3.6196616011257877`*^9}, {3.619661670876788*^9, 3.6196616818244133`*^9}, {
   3.6196617135742316`*^9, 3.619661731088234*^9}, {3.6196617687183905`*^9, 
   3.6196618394654417`*^9}, 3.619661885658087*^9, {3.619661944118439*^9, 
   3.619661947774644*^9}, {3.6196621751386604`*^9, 3.6196621759667115`*^9}, {
   3.6196639108470626`*^9, 3.6196639125391636`*^9}, {3.619664100994951*^9, 
   3.6196641282845144`*^9}, {3.619664592058072*^9, 3.619664593867175*^9}, 
   3.6196648202111425`*^9, {3.6196650624810123`*^9, 3.619665130132887*^9}, {
   3.619665264192563*^9, 3.6196652949953275`*^9}, {3.61966534277306*^9, 
   3.619665344856181*^9}, {3.6196654236726923`*^9, 3.6196654513062787`*^9}, {
   3.6198663640802174`*^9, 3.6198663702364783`*^9}, {3.6198664473303785`*^9, 
   3.619866447674129*^9}, {3.6198664887054596`*^9, 3.619866519143018*^9}, {
   3.619866580736889*^9, 3.61986658101814*^9}, {3.6198715930060453`*^9, 
   3.619871621429669*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find Gaits", "Section",
 CellChangeTimes->{{3.6196514226080303`*^9, 3.61965144328821*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaitInfo", "[", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "b"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "gaits", "]"}], " ", ">", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<There are \>\"", ",", " ", 
           RowBox[{"Length", "[", "gaits", "]"}], ",", " ", 
           "\"\< walking branches found.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "switching", " ", "times"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"gaits", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", " ", "1", ",", " ", "1", ",", " ", 
                   RowBox[{"1", ";;", 
                    RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], "]"}], 
                " ", "\[Equal]", " ", "0"}], ",", " ", 
               RowBox[{"gaits", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", "1", ",", " ", "1"}], 
                "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{"gaits", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"-", "1"}], ",", " ", "1"}], 
                "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Length", "[", "gaits", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Branch: \>\"", ",", " ", "i"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t switching time: \>\"", ",", " ", 
              RowBox[{
              "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t # of gaits in this branch: \>\"", ",", " ", 
              RowBox[{"Length", "@", 
               RowBox[{
               "gaits", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<\\t max normed error between post-impact states: \>\"", ",",
               " ", 
              RowBox[{"Max", "[", 
               RowBox[{"gaits", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", "All", ",", " ", "2"}], 
                "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t shortest gait time: \>\"", ",", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"gaits", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", "All", ",", " ", "1", ",", " ", 
                 RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t longest gait time: \>\"", ",", " ", 
              RowBox[{"Max", "[", 
               RowBox[{"gaits", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", "All", ",", " ", "1", ",", " ", 
                 RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t steepest incline: \>\"", ",", " ", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{"slope", " ", "/@", " ", 
                 RowBox[{"gaits", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", " ", "All", ",", " ", "1"}], 
                  "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", " ", 
              "\"\<\[Degree]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t min step size: \>\"", ",", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"Abs", "@", 
                RowBox[{"gaits", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", "All", ",", " ", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<\\t max step size: \>\"", ",", " ", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "@", 
                RowBox[{"gaits", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", "All", ",", " ", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
             "]"}], ";"}], "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", "gaits", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Singular Points: \>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"#", ",", " ", "0"}], "}"}], "]"}], "&"}], " ", "/@", 
           " ", "a"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "@", 
          RowBox[{"PlotBipedDet", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", "a", "]"}], " ", "-", " ", 
             RowBox[{"1", "/", "100"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Max", "[", "a", "]"}], " ", "+", " ", 
             RowBox[{"1", "/", "100"}]}], ",", " ", 
            RowBox[{"Epilog", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "@", "Large"}], ",", " ", "b"}], 
              "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<State-Time Plot: \>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{"slope", "[", "#", "]"}]}], "}"}], "&"}], ",", " ", 
            RowBox[{"gaits", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", " ", "All", ",", " ", "1"}], 
             "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"a", ",", " ", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
           RowBox[{"Prolog", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", " ", "Red", ",", " ", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"100", ",", " ", "0"}], "}"}]}], "}"}], "]"}], 
                ",", " ", "\"\<Equilibrium Branch\>\""}], "]"}]}], "}"}]}], 
           ",", " ", 
           RowBox[{"Epilog", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "@", "Large"}], ",", " ", "b"}], "}"}]}], 
           ",", " ", 
           RowBox[{"Mesh", "\[Rule]", "All"}], ",", " ", 
           RowBox[{"MeshStyle", "\[Rule]", "Black"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FindGaits", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<nlc0\>\"", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<nlac\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<ders\>\"", "\[Rule]", " ", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "50"}], ",", " ", 
            RowBox[{"1", "/", "15"}], ",", " ", 
            RowBox[{"1", "/", "25"}]}], "}"}]}]}], "}"}]}], ",", " ", 
      RowBox[{"\"\<approxRoot\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"StartingStepSize", "\[Rule]", " ", 
          RowBox[{"1", "/", "1500"}]}], ",", " ", 
         RowBox[{"Method", "\[Rule]", " ", "\"\<ExplicitEuler\>\""}]}], 
        "}"}]}], ",", " ", 
      RowBox[{"\"\<nlcurve\>\"", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<map\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AccuracyGoal", "\[Rule]", " ", "13"}], ",", " ", 
         RowBox[{"PrecisionGoal", "\[Rule]", " ", "13"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Compiled", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"MaxSteps", "\[Rule]", " ", "Infinity"}]}], "}"}]}], ",", 
      " ", 
      RowBox[{"Constant", "\[Rule]", " ", "False"}], ",", " ", 
      RowBox[{"NullSpace", "\[Rule]", " ", "False"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindGaits", "[", 
     RowBox[{"t0_", ",", " ", "tf_", ",", " ", 
      RowBox[{"n_:", "35"}], ",", " ", 
      RowBox[{"step_:", 
       RowBox[{"1", "/", "50."}]}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "ns", ",", " ", "\[Lambda]", ",", " ", "tol"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"approxRoots", "[", 
         RowBox[{"t0", ",", " ", "tf", ",", " ", 
          RowBox[{"OptionValue", "[", "\"\<approxRoot\>\"", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "t", "]"}], " ", "\[Equal]", " ", "0"}], ",",
          " ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"PlanarBipedWalker", "::", "time"}], ",", " ", 
            RowBox[{"ToString", "@", "t0"}], ",", " ", 
            RowBox[{"ToString", "@", "tf"}]}], "]"}], ";", " ", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"refineRoots", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "t", "]"}], " ", "\[Equal]", " ", "0"}], ",",
          " ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"PlanarBipedWalker", "::", "time"}], ",", " ", 
            RowBox[{"ToString", "@", "t0"}], ",", " ", 
            RowBox[{"ToString", "@", "tf"}]}], "]"}], ";", " ", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"xeq", ",", " ", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ContinuationMethods`nlroot", "[", "root", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Found \>\"", ",", 
         RowBox[{"Length", "[", "t", "]"}], ",", " ", 
         "\"\< switching time(s).  About to search for gaits at these times.  \
To abort a search from the current switching time, use the notebook's Abort \
Evaluation command 'ALT+.'.  Don't worry about aborting, any gaits found will \
be saved.\>\""}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mapopts", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<map\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<nlc0\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tol", " ", "=", " ", 
        RowBox[{"N", "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tol", " ", "\[Equal]", " ", 
            RowBox[{"{", "}"}]}], ",", " ", 
           RowBox[{"10", "^", 
            RowBox[{"-", "10"}]}], ",", " ", 
           RowBox[{"OptionValue", "[", 
            RowBox[{"tol", ",", " ", "Tolerance"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"t", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#1", "-", "#2"}], "]"}], " ", "<", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "8"}]}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gaits", " ", "=", " ", 
        RowBox[{
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Off", "[", 
            StyleBox[
             RowBox[{"OptionValue", "::", "nodef"}], "MessageName"], 
            StyleBox["]", "MessageName"]}], 
           StyleBox[";", "MessageName"], "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"is", " ", "it", " ", "a", " ", "valid", " ", 
              RowBox[{"root", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
                RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
               RowBox[{
               "t", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"ns", " ", "=", " ", 
               RowBox[{"NullSpace", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"root", "[", "\[Lambda]", "]"}], 
                  "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
                  " ", 
                 RowBox[{"Tolerance", "\[Rule]", "tol"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "NullSpace", "]"}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "Print", "[", "\"\<Null space at singular point:\>\"", "]"}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"MatrixForm", "@", "ns"}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"if", " ", "not"}], ",", " ", 
                RowBox[{"try", " ", "using", " ", 
                 RowBox[{"root", "[", "...", "]"}], " ", "in", " ", "cost", 
                 " ", "function"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "ns", "]"}], " ", "\[LessEqual]", " ",
                  "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", 
                  " ", 
                  RowBox[{"reallyRefineRoot", "[", 
                   RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", 
                    "\[Equal]", " ", "\[Infinity]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"PlanarBipedWalker", "::", "time"}], ",", " ", 
                    RowBox[{"ToString", "@", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", " ", 
                    RowBox[{"ToString", "@", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ";", " ", 
                    RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ns", " ", "=", " ", 
                  RowBox[{"NullSpace", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"root", "[", "\[Lambda]", "]"}], 
                    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                    ",", " ", 
                    RowBox[{"Tolerance", "\[Rule]", "tol"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "ns", "]"}], " ", "\[LessEqual]", 
                    " ", "1"}], ",", " ", 
                   RowBox[{
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"PlanarBipedWalker", "::", "time"}], ",", " ", 
                    RowBox[{"ToString", "@", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", " ", 
                    RowBox[{"ToString", "@", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ";", " ", 
                    RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "choose", " ", "between", " ", "fixed", " ", "or", " ", 
                "adaptive", " ", "step", " ", "length"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"ns", " ", "=", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "[", "Constant", "]"}], ",", " ", 
                 "ContinuationMethods`nlc", ",", " ", 
                 "ContinuationMethods`nlac"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Sow", "[", "\[IndentingNewLine]", 
               RowBox[{"ContinuationMethods`nlcurve", "[", 
                RowBox[{
                "\"\<biped gait\>\"", ",", " ", "ns", ",", " ", "\[Lambda]", 
                 ",", " ", 
                 RowBox[{"N", "@", "step"}], ",", " ", "n", ",", " ", 
                 RowBox[{"OptionValue", "[", "\"\<nlc0\>\"", "]"}], ",", " ", 
                 RowBox[{"OptionValue", "[", "\"\<nlac\>\"", "]"}], ",", " ", 
                 RowBox[{"OptionValue", "[", "\"\<nlcurve\>\"", "]"}], ",", 
                 " ", 
                 RowBox[{"Tolerance", "\[Rule]", "tol"}]}], "]"}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"On", "[", 
            StyleBox[
             RowBox[{"OptionValue", "::", "nodef"}], "MessageName"], 
            StyleBox["]", "MessageName"]}], 
           StyleBox[";", "MessageName"]}], "\[IndentingNewLine]", "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "gaits", "]"}], " ", ">", " ", "0"}], " ",
             "&&", " ", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"gaits", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], " ",
              ">", " ", "0"}]}], ",", " ", 
           RowBox[{"gaits", " ", "=", " ", 
            RowBox[{"First", "@", "gaits"}]}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"just", " ", "return", " ", 
         RowBox[{"(", 
          RowBox[{"x0", ",", " ", "t"}], ")"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "gaits", "]"}], " ", "\[Equal]", " ", "0"}], 
         ",", " ", 
         RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"gaits", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], " ", 
          "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"gaits", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", "True", ",", 
         RowBox[{
          RowBox[{"gaits", " ", "=", " ", 
           RowBox[{"First", "@", "gaits"}]}], ";", " ", 
          RowBox[{"gaits", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "All", ",", " ", "1"}], 
           "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fcn", "[", 
     RowBox[{
      RowBox[{"s_", "?", "NumberQ"}], ",", " ", "x_"}], "]"}], " ", ":=", " ", 
    RowBox[{"f", "[", 
     RowBox[{"x", ",", " ", "u0du0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FixAngles", ",", " ", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixAngles", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{" ", 
        RowBox[{
        "make", " ", "sure", " ", "angles", " ", "are", " ", "btw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "pi"}], " ", "pi"}]}]}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"q", ",", " ", 
          RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", ">", "\[Pi]"}], ",", " ", 
         RowBox[{"x", " ", "-", " ", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", "x"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixState", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", " ", "=", " ", "x"}], ",", " ", "n"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", 
          RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"3", ";;", "n"}]}], "\[RightDoubleBracket]"}], " ", "=", 
          " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", 
             RowBox[{"3", ";;", "n"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;", "n"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"3", ";;", "n"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "y"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"map", "[", 
     RowBox[{"x0_", ",", " ", "t_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", " ", "x", ",", " ", "f", ",", " ", "n"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "NLink`Private`nx"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x0dx0", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
        "x0"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "f"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], ",", " ", 
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}]}], "}"}], "/.", " ", 
         RowBox[{"First", "@", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x", "'"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
               RowBox[{"fcn", "[", 
                RowBox[{"s", ",", " ", 
                 RowBox[{"x", "[", "s", "]"}]}], "]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", 
               "x0dx0"}]}], "}"}], ",", " ", "x", ",", " ", 
            RowBox[{"{", 
             RowBox[{"s", ",", " ", "t", ",", " ", "t"}], "}"}], ",", " ", 
            "mapopts"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "n"}], "+", "1"}], ";;", ";;", "NLink`Private`nd"}], 
         "\[RightDoubleBracket]"}], " ", "=", " ", 
        RowBox[{"f", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"h", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
           " ", "NLink`Private`nd"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"root", "[", 
   RowBox[{"\[Lambda]_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x0", ",", " ", "t", ",", " ", "M", ",", " ", "root", ",", " ", "droot", 
      ",", " ", "vc", ",", " ", "dvc", ",", " ", "n", ",", " ", "m"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", "NLink`Private`mb"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x0", " ", "=", " ", 
      RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", " ", "=", " ", 
      RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"map", "[", 
       RowBox[{"x0", ",", " ", "t", ",", " ", "opts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vc", " ", "=", " ", 
      RowBox[{"v", "[", "x0dx0", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"x0dx0", " ", "set", " ", "in", " ", 
       RowBox[{"map", "[", "...", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dvc", " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"vc", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"m", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
        " ", "NLink`Private`nd"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"root", " ", "=", " ", 
      RowBox[{"FixState", "[", 
       RowBox[{
        RowBox[{"A", ".", 
         RowBox[{
         "M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], " ", 
        "-", " ", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"root", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ";;", 
        RowBox[{"n", "+", "m"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{"vc", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "m"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"droot", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", ".", 
        RowBox[{"M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        " ", "-", " ", "dx0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"droot", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ";;", 
        RowBox[{"n", "+", "m"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
      RowBox[{"-", "dvc"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"root", ",", " ", "droot", ",", " ", "0"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6184103998248963`*^9, 3.6184104065752783`*^9}, {
   3.6184104688478436`*^9, 3.618410525544091*^9}, {3.618411628574258*^9, 
   3.6184116536326933`*^9}, {3.618411686120554*^9, 3.618411695752105*^9}, {
   3.6184117324212046`*^9, 3.6184117352223654`*^9}, {3.618411767360206*^9, 
   3.6184117678082323`*^9}, {3.618411801632169*^9, 3.6184118056643953`*^9}, {
   3.618411964664505*^9, 3.618412013057276*^9}, {3.6185351488448467`*^9, 
   3.6185352163293586`*^9}, {3.6185353050635457`*^9, 
   3.6185353077026978`*^9}, {3.618535351465203*^9, 3.6185353526322703`*^9}, {
   3.618535395294711*^9, 3.6185353973668323`*^9}, {3.6185354641976566`*^9, 
   3.6185354836797748`*^9}, {3.618535606431804*^9, 3.6185358547560425`*^9}, {
   3.6185358865808477`*^9, 3.61853589038006*^9}, {3.618578466833031*^9, 
   3.6185785529113445`*^9}, {3.618578602239567*^9, 3.61857863792712*^9}, {
   3.6185786990366135`*^9, 3.6185787138491445`*^9}, {3.618578766833623*^9, 
   3.6185787910836763`*^9}, {3.618578828271246*^9, 3.6185788778026047`*^9}, {
   3.6185789285526867`*^9, 3.6185789518808575`*^9}, {3.618579030927887*^9, 
   3.6185791419437337`*^9}, {3.6185791910532017`*^9, 
   3.6185792557564526`*^9}, {3.6185793164597*^9, 3.618579412038023*^9}, {
   3.6185794458193245`*^9, 3.6185794858037767`*^9}, {3.618579553163283*^9, 
   3.6185795928039875`*^9}, {3.618590038412656*^9, 3.6185900539595623`*^9}, {
   3.6185901449909887`*^9, 3.618590194209837*^9}, {3.6185909029455976`*^9, 
   3.618591016633321*^9}, {3.6185910481646276`*^9, 3.6185911786180115`*^9}, {
   3.6185913493270483`*^9, 3.6185914596553903`*^9}, {3.618591553968074*^9, 
   3.6185916718745584`*^9}, {3.6185917063902483`*^9, 
   3.6185917141715145`*^9}, {3.6185917763903885`*^9, 
   3.6185919018125067`*^9}, {3.6185919743126464`*^9, 3.61859198203141*^9}, {
   3.6185922376725388`*^9, 3.6185923476102514`*^9}, 3.6185924187666583`*^9, {
   3.618592477969884*^9, 3.618592621392054*^9}, {3.618592655985855*^9, 
   3.6185926704702606`*^9}, {3.6185927014390836`*^9, 3.618592834470597*^9}, {
   3.618592868173769*^9, 3.6185929703770943`*^9}, {3.618593270971449*^9, 
   3.6185934206592236`*^9}, {3.618660269868504*^9, 3.61866031396603*^9}, {
   3.6186603494290595`*^9, 3.6186603850361166`*^9}, {3.618660420393124*^9, 
   3.6186604558131523`*^9}, {3.6186605538237824`*^9, 3.618660553880768*^9}, {
   3.6186606332743278`*^9, 3.618660647126113*^9}, {3.6186621203404746`*^9, 
   3.6186621209385076`*^9}, 3.618662159397715*^9, {3.618662196428832*^9, 
   3.6186622349700384`*^9}, {3.6186622680459332`*^9, 3.618662317168747*^9}, 
   3.6186623503876495`*^9, {3.6186624505033865`*^9, 3.618662773331869*^9}, {
   3.618662806667775*^9, 3.6186629040923567`*^9}, {3.618662985123997*^9, 
   3.618663058846219*^9}, {3.6186631001626034`*^9, 3.6186631236589317`*^9}, {
   3.618663166758397*^9, 3.618663263696951*^9}, {3.6186634446043105`*^9, 
   3.6186634518007236`*^9}, {3.6186635131352344`*^9, 
   3.6186635155963707`*^9}, {3.618663545719101*^9, 3.618663575923835*^9}, {
   3.618663667385068*^9, 3.6186636859051285`*^9}, {3.618663720526125*^9, 
   3.6186637829416857`*^9}, {3.6186639671522317`*^9, 
   3.6186640010271883`*^9}, {3.618664050129986*^9, 3.618664079698679*^9}, {
   3.618664164622548*^9, 3.618664238484773*^9}, {3.618664281733249*^9, 
   3.618664290936781*^9}, {3.6186643298880067`*^9, 3.618664347252002*^9}, {
   3.618664479584786*^9, 3.6186644802158213`*^9}, {3.6186645348059483`*^9, 
   3.618664536347039*^9}, {3.6186647745576773`*^9, 3.6186648050454206`*^9}, {
   3.618664843083602*^9, 3.6186649302815957`*^9}, {3.618665015169456*^9, 
   3.6186650953770494`*^9}, {3.618665173066497*^9, 3.618665173330514*^9}, {
   3.618665249776889*^9, 3.618665276259427*^9}, {3.6186653289334292`*^9, 
   3.6186653415041633`*^9}, {3.618665415883404*^9, 3.618665555633404*^9}, {
   3.6186655956456957`*^9, 3.6186656179339743`*^9}, {3.618665669025904*^9, 
   3.618665697409523*^9}, 3.6186657582290106`*^9, {3.618665855082573*^9, 
   3.618665862295971*^9}, {3.618666021186067*^9, 3.618666025849334*^9}, {
   3.61866606772873*^9, 3.61866609981157*^9}, {3.618666333192935*^9, 
   3.6186663513699737`*^9}, 3.6186664479085045`*^9, {3.618666527208043*^9, 
   3.618666547415203*^9}, {3.618666747362653*^9, 3.6186667552791023`*^9}, {
   3.6186669571456804`*^9, 3.618667040851461*^9}, {3.6186671563520794`*^9, 
   3.6186672611470733`*^9}, {3.618667320714484*^9, 3.618667344013822*^9}, {
   3.61866737534562*^9, 3.618667408816531*^9}, {3.618667656051688*^9, 
   3.6186676962299895`*^9}, {3.6186677845110474`*^9, 3.618667811180572*^9}, {
   3.618670142602086*^9, 3.6186701650583763`*^9}, {3.618670208240844*^9, 
   3.6186702120180597`*^9}, {3.6186702494182043`*^9, 3.618670273249566*^9}, {
   3.618670306009442*^9, 3.6186703157009974`*^9}, {3.6186703767924957`*^9, 
   3.618670456082039*^9}, {3.6186706387234945`*^9, 3.618670697834883*^9}, {
   3.6186707334979253`*^9, 3.6186708044249873`*^9}, {3.6186708396750236`*^9, 
   3.6186708671555796`*^9}, {3.618671099948914*^9, 3.6186711755882397`*^9}, {
   3.6186712342115965`*^9, 3.618671300097372*^9}, {3.6186713947637987`*^9, 
   3.618671403593297*^9}, {3.618671437339246*^9, 3.6186714444736404`*^9}, {
   3.618671487652109*^9, 3.618671504390069*^9}, {3.61867156180438*^9, 
   3.618671565219556*^9}, 3.6186717839468217`*^9, {3.618671817818762*^9, 
   3.618671835614781*^9}, {3.618671960560933*^9, 3.618671980639087*^9}, {
   3.618672250041517*^9, 3.618672325975862*^9}, {3.618672372181508*^9, 
   3.618672380980013*^9}, {3.618672436605202*^9, 3.6186724569633603`*^9}, {
   3.618672681732236*^9, 3.618672775812628*^9}, {3.6186728079084663`*^9, 
   3.618673004058691*^9}, {3.6186730355534983`*^9, 3.6186730432689404`*^9}, {
   3.6186731082216597`*^9, 3.6186731187202578`*^9}, {3.618673157606485*^9, 
   3.618673281951605*^9}, {3.6186733618791857`*^9, 3.6186735173880916`*^9}, {
   3.6186736180388517`*^9, 3.6186737163024793`*^9}, {3.6186737731197357`*^9, 
   3.6186737795020995`*^9}, {3.6186738129490137`*^9, 
   3.6186738477950125`*^9}, {3.6186738789187913`*^9, 3.61867388291302*^9}, {
   3.618673991017214*^9, 3.6186740531067705`*^9}, {3.61867433318681*^9, 
   3.6186745802629614`*^9}, {3.6186746179481163`*^9, 
   3.6186746187221575`*^9}, {3.6186746490818996`*^9, 3.6186746532921534`*^9}, 
   3.618674739034047*^9, 3.618674774387074*^9, {3.618674819239646*^9, 
   3.618674822483824*^9}, 3.6186750684009085`*^9, {3.618675130070445*^9, 
   3.6186751346177006`*^9}, {3.6186755254460835`*^9, 3.618675558100955*^9}, {
   3.6186756464840164`*^9, 3.6186758025029483`*^9}, {3.6186758732650003`*^9, 
   3.6186758737710295`*^9}, 3.6186763255799055`*^9, {3.618676373383644*^9, 
   3.6186764285558023`*^9}, {3.6186982832679453`*^9, 
   3.6186982854260693`*^9}, {3.6186983297466116`*^9, 
   3.6186983621394663`*^9}, {3.6186984459462843`*^9, 3.618698466963485*^9}, {
   3.618698667436949*^9, 3.618698700476841*^9}, {3.6186989596506834`*^9, 
   3.618698978481762*^9}, {3.6186990537390714`*^9, 3.6186990902411623`*^9}, {
   3.618699126045212*^9, 3.618699373919408*^9}, {3.6186994086624136`*^9, 
   3.6186994143537188`*^9}, {3.618699502071748*^9, 3.618699502247757*^9}, {
   3.6186996057196994`*^9, 3.618699606104703*^9}, {3.6186996660801387`*^9, 
   3.6186996957698517`*^9}, {3.6186997624416537`*^9, 3.618699857996126*^9}, {
   3.6186999494043636`*^9, 3.6186999901876984`*^9}, {3.6187000464209166`*^9, 
   3.618700103804222*^9}, {3.618700155189148*^9, 3.618700239067949*^9}, {
   3.618700272275854*^9, 3.618700276476094*^9}, {3.6187004259316473`*^9, 
   3.618700442929626*^9}, {3.6187007255728264`*^9, 3.618700785279231*^9}, {
   3.6187008173890696`*^9, 3.618700818010105*^9}, {3.6187008494469085`*^9, 
   3.6187009076812396`*^9}, {3.6187009378609676`*^9, 3.618701041032877*^9}, {
   3.618701097741124*^9, 3.618701108056715*^9}, {3.6187011520042315`*^9, 
   3.6187011864762053`*^9}, {3.618701296972537*^9, 3.618701352701739*^9}, {
   3.618701391012919*^9, 3.618701391194929*^9}, 3.618701449811286*^9, 
   3.6187015915374017`*^9, {3.618701740808951*^9, 3.618701741113968*^9}, {
   3.6187017865055685`*^9, 3.6187017983132443`*^9}, {3.6187020449583774`*^9, 
   3.618702047856535*^9}, {3.6196227804624786`*^9, 3.6196227808843517`*^9}, {
   3.619623185876609*^9, 3.6196232384860873`*^9}, {3.619623452955239*^9, 
   3.6196234546896152`*^9}, {3.6196234847834253`*^9, 3.6196235107522273`*^9}, 
   3.6196309683217125`*^9, {3.6196310009467893`*^9, 3.619631027149948*^9}, {
   3.6196310784312963`*^9, 3.619631123243889*^9}, {3.619631312447383*^9, 
   3.6196313142598853`*^9}, {3.619631385947521*^9, 3.61963140168193*^9}, {
   3.6196315198696594`*^9, 3.619631544072834*^9}, {3.61963169035437*^9, 
   3.619631706385651*^9}, {3.619631739729463*^9, 3.619631752401366*^9}, {
   3.619631846917176*^9, 3.619631900401656*^9}, {3.6196319386048565`*^9, 
   3.6196320332769146`*^9}, {3.619632228542921*^9, 3.6196322953243027`*^9}, {
   3.6196323412775145`*^9, 3.6196323961369963`*^9}, {3.61963245226211*^9, 
   3.6196324736684*^9}, {3.619632661387533*^9, 3.6196327312207346`*^9}, {
   3.619632761798917*^9, 3.6196327966271105`*^9}, 3.6196328600334835`*^9, 
   3.619633213674801*^9, {3.6196334103001847`*^9, 3.6196335573629727`*^9}, {
   3.619633610425578*^9, 3.61963381416035*^9}, {3.6196338463479123`*^9, 
   3.6196338611604385`*^9}, {3.6196339343480873`*^9, 3.619634022770133*^9}, {
   3.6196340887546363`*^9, 3.6196341144890623`*^9}, {3.6196346546619935`*^9, 
   3.619634672708909*^9}, {3.619634766896587*^9, 3.6196347873341284`*^9}, {
   3.619634877740554*^9, 3.619634905959361*^9}, {3.6196349976939163`*^9, 
   3.6196349982407913`*^9}, {3.619635101272243*^9, 3.6196351154753942`*^9}, {
   3.6196351876942863`*^9, 3.619635229584992*^9}, {3.6196353100382752`*^9, 
   3.6196353121164093`*^9}, {3.6196353673352737`*^9, 
   3.6196354099759755`*^9}, {3.619635728179717*^9, 3.6196357477578816`*^9}, {
   3.6196360176490517`*^9, 3.6196360183209305`*^9}, {3.619636298337101*^9, 
   3.61963634950906*^9}, {3.619636454759262*^9, 3.619636479415561*^9}, {
   3.6196365208531404`*^9, 3.6196365221968946`*^9}, 3.6196365541344585`*^9, {
   3.6196367344941874`*^9, 3.6196368607756824`*^9}, {3.6196369036664047`*^9, 
   3.619636955307118*^9}, {3.6196370003540792`*^9, 3.6196371984794683`*^9}, {
   3.6196372301670322`*^9, 3.6196372355889115`*^9}, {3.6196372729327393`*^9, 
   3.6196373142765703`*^9}, {3.6196373564797773`*^9, 3.619637472464379*^9}, {
   3.619637553839546*^9, 3.6196375822927184`*^9}, 3.6196376821366644`*^9, {
   3.6196377140586014`*^9, 3.6196377476055527`*^9}, {3.619637915793372*^9, 
   3.619637921949633*^9}, {3.6196382379033766`*^9, 3.6196382449658895`*^9}, {
   3.619638282528462*^9, 3.6196382933878603`*^9}, {3.6196384040297003`*^9, 
   3.619638404576576*^9}, {3.619638461717311*^9, 3.6196385189986753`*^9}, {
   3.6196385601081295`*^9, 3.619638563123761*^9}, {3.6196386000925827`*^9, 
   3.619638615920738*^9}, {3.6196387197334456`*^9, 3.619638800936725*^9}, {
   3.6196388440149355`*^9, 3.619638844108684*^9}, {3.6196389129525704`*^9, 
   3.6196389332338595`*^9}, {3.6196392197187967`*^9, 
   3.6196393716097174`*^9}, {3.619639482203684*^9, 3.6196394934693274`*^9}, {
   3.619639533313156*^9, 3.6196395593600855`*^9}, {3.619639639703992*^9, 
   3.619639640813369*^9}, {3.619639936063946*^9, 3.619639969126511*^9}, {
   3.6196401037048993`*^9, 3.6196401082986584`*^9}, 3.6196401674550247`*^9, 
   3.6196402544239445`*^9, {3.6196407054560757`*^9, 3.61964072531549*^9}, {
   3.619641503785758*^9, 3.6196415099264*^9}, {3.619641542332711*^9, 
   3.619641577004655*^9}, {3.619641912755312*^9, 3.619641922927206*^9}, 
   3.619641968083544*^9, {3.61964204811495*^9, 3.619642065974357*^9}, {
   3.619642238959092*^9, 3.6196422409590845`*^9}, {3.619642310849839*^9, 
   3.6196423300530024`*^9}, {3.619642385584361*^9, 3.6196424049125223`*^9}, {
   3.619647515687639*^9, 3.6196475170782905`*^9}, {3.6196476079846973`*^9, 
   3.619647609281579*^9}, {3.6196476689379377`*^9, 3.6196477042192583`*^9}, {
   3.6196478297820034`*^9, 3.6196478318601336`*^9}, {3.6196485753827744`*^9, 
   3.619648660400223*^9}, {3.619648737738014*^9, 3.6196487847018003`*^9}, {
   3.6196488179395065`*^9, 3.6196488316272874`*^9}, 3.619648882993207*^9, {
   3.6196489289033732`*^9, 3.619648942224885*^9}, {3.619648985127706*^9, 
   3.619648985661733*^9}, {3.619649106681037*^9, 3.6196491686886992`*^9}, 
   3.6196491990358744`*^9, 3.619649762747835*^9, {3.619649795940443*^9, 
   3.6196497962914553`*^9}, {3.6196510056642923`*^9, 
   3.6196510249331036`*^9}, {3.6196570505821943`*^9, 
   3.6196570567505484`*^9}, {3.619657111519685*^9, 3.6196571173980217`*^9}, {
   3.61965718487889*^9, 3.619657221516988*^9}, {3.6196578239504833`*^9, 
   3.6196578682750216`*^9}, 3.619658002402706*^9, {3.6196581214575195`*^9, 
   3.61965814131266*^9}, {3.6196581733755145`*^9, 3.619658180344894*^9}, {
   3.619658286981003*^9, 3.619658295761506*^9}, {3.619658559988637*^9, 
   3.619658580118791*^9}, {3.619658697509512*^9, 3.6196587136534367`*^9}, {
   3.619658759550065*^9, 3.61965879190792*^9}, {3.619658839173622*^9, 
   3.619658849133195*^9}, {3.619658969002065*^9, 3.6196589715182085`*^9}, {
   3.6196590393980904`*^9, 3.619659040986183*^9}, {3.619659091855095*^9, 
   3.6196590924591293`*^9}, {3.619659154192664*^9, 3.619659192962901*^9}, {
   3.6196592357473392`*^9, 3.6196592368964014`*^9}, {3.619659474881029*^9, 
   3.6196594767201385`*^9}, 3.6196595467881527`*^9, {3.61965959746105*^9, 
   3.619659598496112*^9}, {3.619659970512412*^9, 3.619659971634477*^9}, {
   3.6196600193102074`*^9, 3.6196600318579264`*^9}, {3.6196603542553883`*^9, 
   3.619660376033631*^9}, {3.619660453765088*^9, 3.619660455337177*^9}, {
   3.6196605259582205`*^9, 3.6196605874847507`*^9}, {3.61966062056264*^9, 
   3.619660684133275*^9}, {3.6196607677310715`*^9, 3.619660775504512*^9}, {
   3.619660842789362*^9, 3.6196608440924406`*^9}, {3.6196609065160203`*^9, 
   3.6196610450389605`*^9}, {3.6196611086045876`*^9, 3.619661111574757*^9}, {
   3.6196613116962156`*^9, 3.6196613239009333`*^9}, {3.6196616042199697`*^9, 
   3.6196616209319267`*^9}, {3.619662043206108*^9, 3.619662167058202*^9}, 
   3.6196622007131286`*^9, {3.6196623501156826`*^9, 3.6196623502366924`*^9}, 
   3.6196639418058352`*^9, {3.619664005816501*^9, 3.6196640297978735`*^9}, {
   3.619664205796953*^9, 3.619664258537979*^9}, {3.6196643096999025`*^9, 
   3.6196643313811426`*^9}, {3.6196644185811377`*^9, 3.619664449401903*^9}, 
   3.6196645183738527`*^9, {3.6196646952139764`*^9, 3.6196646954259925`*^9}, {
   3.61966552312239*^9, 3.619665610050372*^9}, {3.6196656663795953`*^9, 
   3.61966575464365*^9}, {3.619665885740157*^9, 3.619665904190214*^9}, 
   3.6196660122114115`*^9, {3.6196661657361917`*^9, 3.619666171406516*^9}, {
   3.6196662400194454`*^9, 3.6196662713232393`*^9}, 3.6196663208060727`*^9, {
   3.61966638702186*^9, 3.619666389098988*^9}, {3.6196664250470424`*^9, 
   3.6196664260211005`*^9}, {3.619666491420842*^9, 3.6196665426407795`*^9}, {
   3.6196667242211742`*^9, 3.61966685527468*^9}, {3.6196668867904835`*^9, 
   3.6196669474159555`*^9}, {3.619739128675069*^9, 3.6197391637063828`*^9}, {
   3.6197391978627033`*^9, 3.6197392074877224`*^9}, {3.6197393520661287`*^9, 
   3.619739356675514*^9}, {3.6197394486131935`*^9, 3.6197394608007174`*^9}, {
   3.619831567231721*^9, 3.6198318033884325`*^9}, {3.6198318424666367`*^9, 
   3.6198321505922375`*^9}, {3.619832196420452*^9, 3.619832198857958*^9}, {
   3.6198325148117013`*^9, 3.619832570499305*^9}, {3.6198326979370584`*^9, 
   3.619832724890236*^9}, {3.619832766843443*^9, 3.619832799109132*^9}, {
   3.619832931531266*^9, 3.6198329780782256`*^9}, {3.619833030828334*^9, 
   3.619833344000821*^9}, {3.6198334132040844`*^9, 3.619833600516946*^9}, {
   3.6198336785796013`*^9, 3.619833680970231*^9}, {3.6198337837985563`*^9, 
   3.6198338349236565`*^9}, {3.6198338811581225`*^9, 
   3.6198339747833056`*^9}, {3.619834008767747*^9, 3.61983420008062*^9}, {
   3.619834253737568*^9, 3.619834254675069*^9}, {3.619834464784856*^9, 
   3.619834473003623*^9}, {3.6198577979072657`*^9, 3.6198578500479927`*^9}, {
   3.6198579039387255`*^9, 3.619857913969995*^9}, {3.6198579867201347`*^9, 
   3.6198580111420603`*^9}, 3.6198580488140078`*^9, {3.6198580891422124`*^9, 
   3.619858100501609*^9}, {3.6198584390491505`*^9, 3.6198585256586895`*^9}, {
   3.619858593361948*^9, 3.6198586045026035`*^9}, {3.619858670112097*^9, 
   3.619858731768468*^9}, {3.619858774706053*^9, 3.6198588093779917`*^9}, {
   3.619858852596831*^9, 3.6198589360032444`*^9}, 3.619859056347237*^9, {
   3.6198591363161354`*^9, 3.6198591434723997`*^9}, {3.6198591908162417`*^9, 
   3.619859205097519*^9}, {3.6198592621913805`*^9, 3.6198592629257755`*^9}, {
   3.619860628812437*^9, 3.619860718109486*^9}, {3.6198607547658095`*^9, 
   3.619860841297229*^9}, 3.6198608760472946`*^9, {3.6198609631880913`*^9, 
   3.6198609637662177`*^9}, {3.619861029938222*^9, 3.6198610304225974`*^9}, {
   3.619861096125851*^9, 3.619861096735227*^9}, {3.6198635982310567`*^9, 
   3.61986363268425*^9}, 3.6198642863730288`*^9, {3.6198643274356084`*^9, 
   3.6198643318418674`*^9}, {3.619864580420476*^9, 3.6198645941080036`*^9}, {
   3.6198655596880183`*^9, 3.6198655606255383`*^9}, {3.619865640235051*^9, 
   3.6198656402975545`*^9}, {3.6198714887840767`*^9, 
   3.6198715329056034`*^9}, {3.6198720132781563`*^9, 
   3.6198720139441943`*^9}, {3.619872421460531*^9, 3.61987242212757*^9}, {
   3.619872503692236*^9, 3.6198725060703783`*^9}, {3.6198725541551304`*^9, 
   3.6198725590704117`*^9}, {3.6198726096783066`*^9, 
   3.6198726392679996`*^9}, {3.6198726927530856`*^9, 3.619872698128373*^9}, {
   3.619872733584406*^9, 3.6198727342604413`*^9}, {3.619872819678335*^9, 
   3.619872820428378*^9}, {3.6198728793807545`*^9, 3.619872914148746*^9}, {
   3.61987302231594*^9, 3.619873031155447*^9}, {3.6198730667354846`*^9, 
   3.619873089837805*^9}, {3.6198738978311634`*^9, 3.6198739047999315`*^9}, {
   3.619874322597931*^9, 3.6198744345105085`*^9}, {3.619874465885571*^9, 
   3.6198745149004493`*^9}, {3.6198746423820405`*^9, 
   3.6198747128330097`*^9}, {3.619874872932845*^9, 3.6198750480729494`*^9}, 
   3.6198752149971347`*^9, {3.6198752753022623`*^9, 3.619875275458514*^9}, {
   3.6198753449587135`*^9, 3.6198753452868385`*^9}, {3.6198756669691706`*^9, 
   3.6198756737838297`*^9}, {3.6198760979101424`*^9, 
   3.6198761021203804`*^9}, {3.6198762043692355`*^9, 3.619876209974556*^9}, {
   3.619876323030031*^9, 3.619876323661069*^9}, {3.6198764428668933`*^9, 
   3.6198764514373875`*^9}, {3.6199163116069355`*^9, 
   3.6199163203454356`*^9}, {3.6199165755420465`*^9, 
   3.6199165806943464`*^9}, {3.619917639148959*^9, 3.6199176575400124`*^9}, {
   3.6199177121821413`*^9, 3.6199177134502134`*^9}, {3.619917756331669*^9, 
   3.6199177670842857`*^9}, {3.619918293687442*^9, 3.6199183196579294`*^9}, {
   3.6199183666996236`*^9, 3.619918370471839*^9}, {3.6199184039857535`*^9, 
   3.6199184274711046`*^9}, {3.6199185172062426`*^9, 
   3.6199185765116396`*^9}, {3.61991914073995*^9, 3.619919148704404*^9}, {
   3.6199206071339245`*^9, 3.6199206179275436`*^9}, {3.6199207878302727`*^9, 
   3.6199207903324175`*^9}, 3.619920823045289*^9, {3.6199209389319263`*^9, 
   3.6199209631373124`*^9}, {3.6199209934340477`*^9, 
   3.6199209936810613`*^9}, {3.619921055946627*^9, 3.6199210563046474`*^9}, 
   3.6236850878398876`*^9, {3.623685272277734*^9, 3.623685281012124*^9}, {
   3.6236853510122633`*^9, 3.623685374465435*^9}, {3.6236869051093807`*^9, 
   3.623686914000024*^9}, {3.6236869530938487`*^9, 3.6236870169221*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 3.5914868026208353`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{624, 925},
WindowMargins->{{Automatic, 219}, {Automatic, 0}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3193, 64, 313, "Code",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3776, 88, 100, 1, 70, "Section"],
Cell[3879, 91, 2162, 31, 52, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6078, 127, 147, 2, 70, "Section"],
Cell[6228, 131, 12866, 307, 1252, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[19131, 443, 96, 1, 70, "Section"],
Cell[19230, 446, 50920, 980, 3532, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[70187, 1431, 30, 0, 70, "Section"],
Cell[70220, 1433, 207, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
