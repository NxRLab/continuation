(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    180526,       3809]
NotebookOptionsPosition[    178356,       3741]
NotebookOutlinePosition[    178721,       3757]
CellTagsIndexPosition[    178678,       3754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\<../\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"NDSolve", ",", " ", 
    RowBox[{"AccuracyGoal", "\[Rule]", " ", "13"}], ",", " ", 
    RowBox[{"PrecisionGoal", "\[Rule]", " ", "13"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Compiled", "\[Rule]", " ", "False"}], ",", " ", 
    RowBox[{"MaxSteps", "\[Rule]", " ", "Infinity"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<NLink`\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.602095934984855*^9, 3.602095940641183*^9}, {
  3.6020959794324055`*^9, 3.6020960452321663`*^9}, {3.6020960916088247`*^9, 
  3.6020961631929235`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"np", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "puppeteers"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nl", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "links"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", " ", "=", " ", 
    RowBox[{"np", " ", "+", " ", "nl"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "bodies"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"puppeteer", " ", 
    RowBox[{"(", 
     RowBox[{"string", " ", "+", " ", "wheel", " ", "+", " ", "winch"}], 
     ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"1", "/", "2"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"wheel", " ", "radius"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"M", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"wheel", " ", "mass"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"r", " ", "=", " ", 
     RowBox[{"1", "/", "4"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"winch", " ", "radius"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"m", " ", "=", " ", 
     RowBox[{"1", "/", "2"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"winch", " ", "mass"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "doll", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"L", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"md", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Alpha]", " ", "=", " ", 
     RowBox[{"1", "/", "2"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"c", ".", "o", ".", "m"}], " ", 
     RowBox[{"position", " ", "/", " ", "link"}], " ", "length"}], " ", 
    "*)"}], "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5938593516290765`*^9, 3.593859371822229*^9}, 
   3.593859457086112*^9, {3.593859531702386*^9, 3.5938595484463434`*^9}, 
   3.593859728422651*^9, {3.5938599208146677`*^9, 3.5938600193503103`*^9}, {
   3.593860441262472*^9, 3.593860506702219*^9}, {3.5938606833833375`*^9, 
   3.593860729126957*^9}, {3.5938607597357063`*^9, 3.593860855151174*^9}, {
   3.593860890943224*^9, 3.5938608959115086`*^9}, {3.593860965991522*^9, 
   3.5938610380946503`*^9}, {3.593861209230451*^9, 3.593861312447359*^9}, {
   3.5938613586320066`*^9, 3.5938615062434607`*^9}, {3.59386153854531*^9, 
   3.5938615886171727`*^9}, {3.5938620697057247`*^9, 
   3.5938620827614727`*^9}, {3.593862223302523*^9, 3.593862231727001*^9}, {
   3.5938623058712516`*^9, 3.593862411442295*^9}, {3.593862496147148*^9, 
   3.5938625714754624`*^9}, {3.5938626031912737`*^9, 3.593862729051483*^9}, {
   3.5938628170415287`*^9, 3.5938628174255466`*^9}, {3.5938631780081964`*^9, 
   3.5938631933590727`*^9}, {3.5938638804314203`*^9, 3.59386391689251*^9}, {
   3.5938640387894955`*^9, 3.5938640517492275`*^9}, {3.593864261357236*^9, 
   3.5938642779491863`*^9}, 3.5938644271517277`*^9, {3.593864463104785*^9, 
   3.5938645691868773`*^9}, {3.5938646105112305`*^9, 
   3.5938646337825584`*^9}, {3.5938647824240713`*^9, 3.593864808646573*^9}, {
   3.593864951623762*^9, 3.59386497262398*^9}, {3.5938652083664675`*^9, 
   3.593865267975879*^9}, 3.5938810583071356`*^9, 3.5938816884852223`*^9, {
   3.5938817434183683`*^9, 3.593881779394436*^9}, 3.5938900852510786`*^9, {
   3.593890177261346*^9, 3.5938902009737043`*^9}, {3.593890371521473*^9, 
   3.5938904351731195`*^9}, {3.5938905942222233`*^9, 3.593890646846237*^9}, {
   3.5938907308060493`*^9, 3.593890784446119*^9}, {3.593890816335949*^9, 
   3.5938908268875523`*^9}, {3.593890917729754*^9, 3.5938909528357644`*^9}, {
   3.593890989785878*^9, 3.5938909953521996`*^9}, {3.5938910267619977`*^9, 
   3.593891040145765*^9}, {3.5938910788089786`*^9, 3.5938910846363134`*^9}, {
   3.593891129434874*^9, 3.593891171322276*^9}, {3.593891231742736*^9, 
   3.5938912484456935`*^9}, {3.593891284109733*^9, 3.5938913157345467`*^9}, {
   3.593891406517743*^9, 3.593891450575271*^9}, {3.593891786126484*^9, 
   3.593891855912481*^9}, 3.5938919797265673`*^9, {3.5938920297854414`*^9, 
   3.5938921229447737`*^9}, {3.5938921633910885`*^9, 
   3.5938921999981813`*^9}, {3.5938922418465815`*^9, 
   3.5938922469048715`*^9}, {3.593892308849422*^9, 3.5938923093104568`*^9}, {
   3.593892352676928*^9, 3.593892399141591*^9}, {3.5938925575186586`*^9, 
   3.593892634691079*^9}, {3.5938927430902863`*^9, 3.5938927487536087`*^9}, {
   3.5938940261127605`*^9, 3.5938940398465424`*^9}, {3.5939197472213397`*^9, 
   3.593919840094658*^9}, {3.593919885456256*^9, 3.5939199299538045`*^9}, {
   3.593919964916806*^9, 3.593919982736825*^9}, {3.5939200727269807`*^9, 
   3.5939200818575*^9}, {3.5939201128352785`*^9, 3.59392011342533*^9}, {
   3.59392015295657*^9, 3.5939202137170734`*^9}, {3.593920249395095*^9, 
   3.593920251076194*^9}, {3.593920305441307*^9, 3.593920350844907*^9}, {
   3.593920532878338*^9, 3.5939208253480997`*^9}, {3.5939208841534433`*^9, 
   3.593920929439041*^9}, {3.5939210012391543`*^9, 3.5939210193551917`*^9}, {
   3.5939210605245667`*^9, 3.593921165225544*^9}, {3.593921195280266*^9, 
   3.593921195834296*^9}, {3.593923158403686*^9, 3.5939231596217537`*^9}, {
   3.593923282848813*^9, 3.593923297193633*^9}, {3.593923457851835*^9, 
   3.5939234686784697`*^9}, {3.593923534861244*^9, 3.5939235448368177`*^9}, {
   3.593923915894065*^9, 3.59392394602279*^9}, {3.5939240617934217`*^9, 
   3.593924090570072*^9}, 3.5939241633992352`*^9, {3.5939241971361713`*^9, 
   3.5939242268778696`*^9}, {3.593924303011235*^9, 3.5939243236784177`*^9}, {
   3.5939244740230227`*^9, 3.593924599952257*^9}, {3.5939246655669966`*^9, 
   3.5939247024031053`*^9}, {3.5939247678158517`*^9, 
   3.5939247685769005`*^9}, {3.593924941807816*^9, 3.5939249643121047`*^9}, {
   3.5939250375653*^9, 3.59392503791832*^9}, {3.593965243986782*^9, 
   3.593965287987303*^9}, {3.5939653241853747`*^9, 3.593965332015823*^9}, {
   3.5939653650157104`*^9, 3.593965387904023*^9}, {3.5939654735929317`*^9, 
   3.593965487911751*^9}, {3.593965535199456*^9, 3.5939656085196686`*^9}, {
   3.59396656042817*^9, 3.5939666008814864`*^9}, {3.593966693171769*^9, 
   3.5939668001758966`*^9}, {3.593966882396609*^9, 3.593966884000697*^9}, {
   3.5939669693275857`*^9, 3.5939669726547904`*^9}, 3.5939670334152555`*^9, {
   3.5939670652960835`*^9, 3.593967119277171*^9}, {3.593967176493451*^9, 
   3.593967198188694*^9}, {3.5939672340057383`*^9, 3.5939672479275413`*^9}, {
   3.593967287502805*^9, 3.593967327924122*^9}, {3.5939674675381174`*^9, 
   3.593967468848192*^9}, {3.5939675098095374`*^9, 3.5939676145705557`*^9}, {
   3.5939676647354283`*^9, 3.5939677112680745`*^9}, {3.593967778825945*^9, 
   3.593967787812456*^9}, {3.5939678179831862`*^9, 3.5939678299418697`*^9}, {
   3.593967872319295*^9, 3.59396788347094*^9}, {3.59396792074407*^9, 
   3.5939680029517813`*^9}, {3.5939680350886354`*^9, 
   3.5939680353116317`*^9}, {3.593968091097825*^9, 3.5939681097198925`*^9}, {
   3.5939683685007114`*^9, 3.5939684499313717`*^9}, 3.5939685067806306`*^9, {
   3.5939685615667677`*^9, 3.593968606803376*^9}, {3.5939686460656123`*^9, 
   3.59396866656178*^9}, {3.5939687044269476`*^9, 3.5939687119954004`*^9}, {
   3.593968742628137*^9, 3.593968748657482*^9}, 3.5939688281090283`*^9, {
   3.593969020949075*^9, 3.5939690260763693`*^9}, {3.5939690861488113`*^9, 
   3.5939691754899263`*^9}, {3.593969248305096*^9, 3.5939692644230185`*^9}, {
   3.593971615654684*^9, 3.593971662372341*^9}, {3.5939724158404846`*^9, 
   3.5939724170115557`*^9}, {3.593974256074873*^9, 3.593974279677223*^9}, {
   3.596391026824274*^9, 3.5963910272732954`*^9}, 3.5990900642419386`*^9, {
   3.5990901226752667`*^9, 3.5990901526119814`*^9}, {3.599090954390897*^9, 
   3.5990909547869196`*^9}, {3.5990913473694015`*^9, 3.599091347454423*^9}, {
   3.599091599916864*^9, 3.59909160037689*^9}, {3.5990918883133793`*^9, 
   3.5990918884233875`*^9}, {3.599092668743072*^9, 3.5990927707979155`*^9}, {
   3.5990937319669604`*^9, 3.599093749190946*^9}, {3.599144396990856*^9, 
   3.599144397022108*^9}, {3.5991448474605*^9, 3.5991448491792355`*^9}, {
   3.5992565778328485`*^9, 3.599256577914835*^9}, {3.599260426869246*^9, 
   3.5992604454593105`*^9}, {3.5992639371112704`*^9, 3.599263937546291*^9}, 
   3.5993120427282906`*^9, {3.6020963538337235`*^9, 3.6020963999583864`*^9}, {
   3.6020965305038433`*^9, 3.602096570031107*^9}, 3.6020966140806293`*^9, {
   3.602102131145573*^9, 3.602102150791694*^9}, {3.602102265274254*^9, 
   3.6021023583606033`*^9}, {3.602102426162467*^9, 3.602102453345024*^9}, {
   3.602102491421218*^9, 3.602102512816429*^9}, {3.6021025687546463`*^9, 
   3.6021025976883087`*^9}, {3.6021037050427046`*^9, 3.602103760131859*^9}, {
   3.602103897643752*^9, 3.6021039112045083`*^9}, {3.6021040035487986`*^9, 
   3.602104062921199*^9}, {3.602104155581506*^9, 3.602104218837123*^9}, {
   3.6021048206845903`*^9, 3.602104820756598*^9}, {3.6021151640639277`*^9, 
   3.6021151799798355`*^9}, 3.6021228204236946`*^9, {3.6021230925912848`*^9, 
   3.602123104931988*^9}, {3.602124520476054*^9, 3.6021245363309755`*^9}, 
   3.6021247068017216`*^9, {3.602126466863514*^9, 3.6021264747489653`*^9}, 
   3.6021270444565897`*^9, {3.6021286634043007`*^9, 3.6021286658154435`*^9}, {
   3.602128960081295*^9, 3.602128960100296*^9}, 3.602129672329083*^9, 
   3.602175399216091*^9, {3.602177823917263*^9, 3.602177823932887*^9}, 
   3.602180520516281*^9, {3.6021806039539614`*^9, 3.602180604032073*^9}, {
   3.602180756547996*^9, 3.6021807566261215`*^9}, {3.602180814157487*^9, 
   3.602180814282484*^9}, {3.6021808931732626`*^9, 3.602180933267093*^9}, {
   3.6021812464864683`*^9, 3.602181273658383*^9}, {3.6021813121428356`*^9, 
   3.602181320002222*^9}, {3.6021813527679124`*^9, 3.6021813553929205`*^9}, {
   3.602181440439974*^9, 3.6021814560493636`*^9}, {3.6022453684736156`*^9, 
   3.6022453962080345`*^9}, {3.6022467880388813`*^9, 3.602246788054504*^9}, {
   3.6022478204668446`*^9, 3.602247839949941*^9}, 3.6022501891132903`*^9, 
   3.602251975135355*^9, {3.6022525050738955`*^9, 3.602252509902027*^9}, {
   3.6022633349021807`*^9, 3.602263335089677*^9}, {3.602627909226551*^9, 
   3.60262791423184*^9}, {3.6028241084250436`*^9, 3.6028241089400935`*^9}, {
   3.602873775341962*^9, 3.60287377674822*^9}, 3.6028884073158684`*^9, {
   3.6028900332203054`*^9, 3.602890051751602*^9}, 3.6028911508474913`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frames", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "6"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "doll", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"frames", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"np", "+", "1"}], ",", " ", "5"}], "\[RightDoubleBracket]"}], 
     " ", "=", " ", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "puppeteer", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frames", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", " ", "4"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
    RowBox[{"L", "+", "R"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", " ", "//", " ", "N"}], " ", "//", " ", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.5938593516290765`*^9, 3.593859371822229*^9}, 
   3.593859457086112*^9, {3.593859531702386*^9, 3.5938595484463434`*^9}, 
   3.593859728422651*^9, {3.5938599208146677`*^9, 3.5938600193503103`*^9}, {
   3.593860441262472*^9, 3.593860506702219*^9}, {3.5938606833833375`*^9, 
   3.593860729126957*^9}, {3.5938607597357063`*^9, 3.593860855151174*^9}, {
   3.593860890943224*^9, 3.5938608959115086`*^9}, {3.593860965991522*^9, 
   3.5938610380946503`*^9}, {3.593861209230451*^9, 3.593861312447359*^9}, {
   3.5938613586320066`*^9, 3.5938615062434607`*^9}, {3.59386153854531*^9, 
   3.5938615886171727`*^9}, {3.5938620697057247`*^9, 
   3.5938620827614727`*^9}, {3.593862223302523*^9, 3.593862231727001*^9}, {
   3.5938623058712516`*^9, 3.593862411442295*^9}, {3.593862496147148*^9, 
   3.5938625714754624`*^9}, {3.5938626031912737`*^9, 3.593862729051483*^9}, {
   3.5938628170415287`*^9, 3.5938628174255466`*^9}, {3.5938631780081964`*^9, 
   3.5938631933590727`*^9}, {3.5938638804314203`*^9, 3.59386391689251*^9}, {
   3.5938640387894955`*^9, 3.5938640517492275`*^9}, {3.593864261357236*^9, 
   3.5938642779491863`*^9}, 3.5938644271517277`*^9, {3.593864463104785*^9, 
   3.5938645691868773`*^9}, {3.5938646105112305`*^9, 
   3.5938646337825584`*^9}, {3.5938647824240713`*^9, 3.593864808646573*^9}, {
   3.593864951623762*^9, 3.59386497262398*^9}, {3.5938652083664675`*^9, 
   3.593865267975879*^9}, 3.5938810583071356`*^9, 3.5938816884852223`*^9, {
   3.5938817434183683`*^9, 3.593881779394436*^9}, 3.5938900852510786`*^9, {
   3.593890177261346*^9, 3.5938902009737043`*^9}, {3.593890371521473*^9, 
   3.5938904351731195`*^9}, {3.5938905942222233`*^9, 3.593890646846237*^9}, {
   3.5938907308060493`*^9, 3.593890784446119*^9}, {3.593890816335949*^9, 
   3.5938908268875523`*^9}, {3.593890917729754*^9, 3.5938909528357644`*^9}, {
   3.593890989785878*^9, 3.5938909953521996`*^9}, {3.5938910267619977`*^9, 
   3.593891040145765*^9}, {3.5938910788089786`*^9, 3.5938910846363134`*^9}, {
   3.593891129434874*^9, 3.593891171322276*^9}, {3.593891231742736*^9, 
   3.5938912484456935`*^9}, {3.593891284109733*^9, 3.5938913157345467`*^9}, {
   3.593891406517743*^9, 3.593891450575271*^9}, {3.593891786126484*^9, 
   3.593891855912481*^9}, 3.5938919797265673`*^9, {3.5938920297854414`*^9, 
   3.5938921229447737`*^9}, {3.5938921633910885`*^9, 
   3.5938921999981813`*^9}, {3.5938922418465815`*^9, 
   3.5938922469048715`*^9}, {3.593892308849422*^9, 3.5938923093104568`*^9}, {
   3.593892352676928*^9, 3.593892399141591*^9}, {3.5938925575186586`*^9, 
   3.593892634691079*^9}, {3.5938927430902863`*^9, 3.5938927487536087`*^9}, {
   3.5938940261127605`*^9, 3.5938940398465424`*^9}, {3.5939197472213397`*^9, 
   3.593919840094658*^9}, {3.593919885456256*^9, 3.5939199299538045`*^9}, {
   3.593919964916806*^9, 3.593919982736825*^9}, {3.5939200727269807`*^9, 
   3.5939200818575*^9}, {3.5939201128352785`*^9, 3.59392011342533*^9}, {
   3.59392015295657*^9, 3.5939202137170734`*^9}, {3.593920249395095*^9, 
   3.593920251076194*^9}, {3.593920305441307*^9, 3.593920350844907*^9}, {
   3.593920532878338*^9, 3.5939208253480997`*^9}, {3.5939208841534433`*^9, 
   3.593920929439041*^9}, {3.5939210012391543`*^9, 3.5939210193551917`*^9}, {
   3.5939210605245667`*^9, 3.593921165225544*^9}, {3.593921195280266*^9, 
   3.593921195834296*^9}, {3.593923158403686*^9, 3.5939231596217537`*^9}, {
   3.593923282848813*^9, 3.593923297193633*^9}, {3.593923457851835*^9, 
   3.5939234686784697`*^9}, {3.593923534861244*^9, 3.5939235448368177`*^9}, {
   3.593923915894065*^9, 3.59392394602279*^9}, {3.5939240617934217`*^9, 
   3.593924090570072*^9}, 3.5939241633992352`*^9, {3.5939241971361713`*^9, 
   3.5939242268778696`*^9}, {3.593924303011235*^9, 3.5939243236784177`*^9}, {
   3.5939244740230227`*^9, 3.593924599952257*^9}, {3.5939246655669966`*^9, 
   3.5939247024031053`*^9}, {3.5939247678158517`*^9, 
   3.5939247685769005`*^9}, {3.593924941807816*^9, 3.5939249643121047`*^9}, {
   3.5939250375653*^9, 3.59392503791832*^9}, {3.593965243986782*^9, 
   3.593965287987303*^9}, {3.5939653241853747`*^9, 3.593965332015823*^9}, {
   3.5939653650157104`*^9, 3.593965387904023*^9}, {3.5939654735929317`*^9, 
   3.593965487911751*^9}, {3.593965535199456*^9, 3.5939656085196686`*^9}, {
   3.59396656042817*^9, 3.5939666008814864`*^9}, {3.593966693171769*^9, 
   3.5939668001758966`*^9}, {3.593966882396609*^9, 3.593966884000697*^9}, {
   3.5939669693275857`*^9, 3.5939669726547904`*^9}, 3.5939670334152555`*^9, {
   3.5939670652960835`*^9, 3.593967119277171*^9}, {3.593967176493451*^9, 
   3.593967198188694*^9}, {3.5939672340057383`*^9, 3.5939672479275413`*^9}, {
   3.593967287502805*^9, 3.593967327924122*^9}, {3.5939674675381174`*^9, 
   3.593967468848192*^9}, {3.5939675098095374`*^9, 3.5939676145705557`*^9}, {
   3.5939676647354283`*^9, 3.5939677112680745`*^9}, {3.593967778825945*^9, 
   3.593967787812456*^9}, {3.5939678179831862`*^9, 3.5939678299418697`*^9}, {
   3.593967872319295*^9, 3.59396788347094*^9}, {3.59396792074407*^9, 
   3.5939680029517813`*^9}, {3.5939680350886354`*^9, 
   3.5939680353116317`*^9}, {3.593968091097825*^9, 3.5939681097198925`*^9}, {
   3.5939683685007114`*^9, 3.5939684499313717`*^9}, 3.5939685067806306`*^9, 
   3.5939685615667677`*^9, {3.5939708427064013`*^9, 3.593970847810689*^9}, {
   3.59397146328294*^9, 3.5939714922705956`*^9}, {3.5939782205448513`*^9, 
   3.593978300368427*^9}, {3.593978350325285*^9, 3.593978368993357*^9}, {
   3.5939785488236537`*^9, 3.593978555057012*^9}, {3.5940477796373243`*^9, 
   3.5940477799133396`*^9}, 3.5940479436757183`*^9, {3.5963910051110134`*^9, 
   3.59639100737514*^9}, {3.5990903238437886`*^9, 3.59909036682825*^9}, {
   3.599090398642072*^9, 3.599090456376378*^9}, {3.599090575120178*^9, 
   3.5990905833896513`*^9}, {3.599090638092785*^9, 3.599090674576873*^9}, {
   3.5990907045925927`*^9, 3.599090752353327*^9}, {3.599090783199094*^9, 
   3.5990908202692165`*^9}, 3.5990908649307747`*^9, {3.5990909171817665`*^9, 
   3.5990909280253887`*^9}, {3.5990910975800977`*^9, 3.599091185672141*^9}, {
   3.5990913679335794`*^9, 3.5990914774528503`*^9}, {3.599091537246277*^9, 
   3.5990915381383266`*^9}, {3.5990919329199333`*^9, 3.59909196586182*^9}, {
   3.599092143760008*^9, 3.5990922182502737`*^9}, {3.5990922769426355`*^9, 
   3.599092286538184*^9}, {3.5990923401032534`*^9, 3.5990923440374775`*^9}, {
   3.5990924336096067`*^9, 3.599092441881081*^9}, {3.5990927593592625`*^9, 
   3.59909275951827*^9}, {3.599092856944849*^9, 3.599092894408995*^9}, {
   3.599093716240059*^9, 3.5990937264286423`*^9}, {3.5991444462253404`*^9, 
   3.599144453209715*^9}, {3.5991459343416862`*^9, 3.599145964885438*^9}, {
   3.599256591426606*^9, 3.599256615381985*^9}, {3.599260434403682*^9, 
   3.5992604381578927`*^9}, {3.5992639482359076`*^9, 
   3.5992639802987432`*^9}, {3.599312058183173*^9, 3.599312127638155*^9}, {
   3.5993135311115265`*^9, 3.5993135389839725`*^9}, {3.602096413186125*^9, 
   3.602096430815132*^9}, {3.6021023660890307`*^9, 3.6021023713763304`*^9}, {
   3.602103930698628*^9, 3.602103962072424*^9}, {3.6021040932749367`*^9, 
   3.602104093329938*^9}, {3.6021147211955624`*^9, 3.6021147347713375`*^9}, {
   3.6021147686362867`*^9, 3.602114770291374*^9}, {3.6021150562997527`*^9, 
   3.6021150574278145`*^9}, 3.6021189449484425`*^9, {3.602119845764029*^9, 
   3.6021198463220615`*^9}, 3.602121870069274*^9, 3.6021227889568944`*^9, {
   3.602124713228092*^9, 3.602124725661801*^9}, {3.6021270972036333`*^9, 
   3.602127097595637*^9}, {3.6021778424329257`*^9, 3.602177893729912*^9}, {
   3.6021779244643326`*^9, 3.6021779249330835`*^9}, {3.602177961839408*^9, 
   3.602177981995696*^9}, {3.6021780216207724`*^9, 3.6021780315426674`*^9}, {
   3.6021805099537644`*^9, 3.6021805137193966`*^9}, {3.602180711204157*^9, 
   3.602180751329239*^9}, {3.602180826813761*^9, 3.602180827063759*^9}, {
   3.6022454023017936`*^9, 3.6022454038955464`*^9}, {3.6022468000857773`*^9, 
   3.6022468300545855`*^9}, {3.6022478266631804`*^9, 3.602247829226327*^9}, {
   3.6022503200979214`*^9, 3.6022503208166733`*^9}, {3.6022506322391596`*^9, 
   3.602250632473546*^9}, {3.602251982760373*^9, 3.602251983150996*^9}, 
   3.602252975746701*^9, {3.6022633491834517`*^9, 3.602263354558463*^9}, {
   3.602263777028042*^9, 3.6022637772155533`*^9}, 3.60226429357594*^9, {
   3.6024395175384426`*^9, 3.602439517819708*^9}, {3.602467971488529*^9, 
   3.602467971732556*^9}, {3.6026196174579926`*^9, 3.602619622864256*^9}, {
   3.6026279188761044`*^9, 3.6026279494648557`*^9}, {3.602631539886237*^9, 
   3.602631541417491*^9}, {3.6028737861701097`*^9, 3.6028737892638674`*^9}, {
   3.6028884582534723`*^9, 3.602888478581637*^9}, {3.602888798624138*^9, 
   3.602888838702344*^9}, {3.602890177908086*^9, 3.6028901830487237`*^9}, {
   3.602890621471453*^9, 3.6028906217058315`*^9}, {3.6028908762219515`*^9, 
   3.6028908823625917`*^9}, {3.6028911598943815`*^9, 
   3.6028911600818815`*^9}, {3.6029378726432023`*^9, 3.6029378765963507`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"L", "+", "R"}], "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.602467914036229*^9, 3.6024679847252684`*^9, 3.6024680565793886`*^9, 
   3.6024691938695173`*^9, 3.6025064809242496`*^9, 3.6025065180783772`*^9, 
   3.602506650732974*^9, 3.602512351035412*^9, 3.6025430058199224`*^9, 
   3.602617602607339*^9, 3.6026196233642554`*^9, {3.602627939215271*^9, 
   3.602627949810877*^9}, {3.602631541917492*^9, 3.60263154619875*^9}, 
   3.602691430302478*^9, 3.6027021640835238`*^9, {3.6028737870294895`*^9, 
   3.6028737895607557`*^9}, {3.6028884496753407`*^9, 
   3.6028884790191345`*^9}, {3.6028888001241426`*^9, 3.602888841217977*^9}, 
   3.602890055579729*^9, 3.6028901833612423`*^9, 3.602890622268332*^9, 
   3.6028908827688403`*^9, 3.602891160988136*^9, 3.6028919360209007`*^9, 
   3.602893250242221*^9, 3.602893555352193*^9, 3.602907402311171*^9, {
   3.602937877455714*^9, 3.602937882377599*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"inertia", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "10"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"inertia", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "6", ",", " ", "10"}], "}"}]}], 
      "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"md", " ", ",", " ", 
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], " ", "L"}], ",", " ", 
       RowBox[{
        RowBox[{"1", "/", "12"}], " ", "md", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]", " ", "L"}], ")"}], "^", "2"}]}]}], "}"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inertia", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "6", ",", " ", "10"}], "}"}]}], 
    "\[RightDoubleBracket]"}], " ", "=", "  ", 
   RowBox[{"{", 
    RowBox[{"m1", " ", ",", " ", 
     RowBox[{
      RowBox[{"-", "\[Alpha]"}], " ", "L"}], ",", " ", 
     RowBox[{
      RowBox[{"1", "/", "12"}], " ", "m1", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Alpha]", " ", "L"}], ")"}], "^", "2"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"inertia", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "10"}], "}"}]}], "\[RightDoubleBracket]"}], " ",
     "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "m"}], " ", "+", 
         RowBox[{"3", "M"}]}], ")"}]}], " ", ",", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "m", " ", 
       RowBox[{"r", "^", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"inertia", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "10"}], "}"}]}], "\[RightDoubleBracket]"}], 
     " ", "=", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "m"}], " ", "+", 
          RowBox[{"3", "M"}]}], ")"}]}], " ", ",", " ", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", "m", " ", 
        RowBox[{"r", "^", "2"}]}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inertia", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"np", "+", "1"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "6", ",", " ", "10"}], "}"}]}], 
      "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"md", " ", ",", " ", 
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], " ", "L"}], ",", " ", 
       RowBox[{
        RowBox[{"1", "/", "12"}], " ", "md", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]", " ", "L"}], ")"}], "^", "2"}]}]}], "}"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"inertia", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"np", "+", "2"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "6", ",", " ", "10"}], "}"}]}], 
      "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"md", " ", ",", " ", 
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], " ", "L"}], ",", " ", 
       RowBox[{
        RowBox[{"1", "/", "12"}], " ", "md", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]", " ", "L"}], ")"}], "^", "2"}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inertia", " ", "//", " ", "N"}], "//", " ", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.59909176346023*^9, 3.5990918050126095`*^9}, {
   3.5990924297883873`*^9, 3.5990925871033974`*^9}, {3.599092617752152*^9, 
   3.599092681968831*^9}, {3.599092925502775*^9, 3.5990929997750297`*^9}, {
   3.5990930673839006`*^9, 3.5990930829017897`*^9}, {3.599093191104987*^9, 
   3.599093206744882*^9}, {3.599093239984786*^9, 3.5990932405848207`*^9}, {
   3.5990932745927677`*^9, 3.599093364214899*^9}, {3.599093413811741*^9, 
   3.599093701938239*^9}, {3.599093898474495*^9, 3.5990939326404524`*^9}, {
   3.5990939662913804`*^9, 3.5990939720737104`*^9}, {3.5990940236956654`*^9, 
   3.5990940237666693`*^9}, {3.5990968795512137`*^9, 
   3.5990969899215384`*^9}, {3.599144475194152*^9, 3.599144482616026*^9}, {
   3.599256637592248*^9, 3.5992566432655773`*^9}, {3.5992604525797234`*^9, 
   3.599260459630123*^9}, {3.5992640270164185`*^9, 3.59926404719357*^9}, {
   3.5993125503053565`*^9, 3.5993126144550447`*^9}, {3.6020964914606066`*^9, 
   3.6020965163380313`*^9}, {3.602096577906557*^9, 3.6020966347888155`*^9}, {
   3.602096673145011*^9, 3.602096674009061*^9}, {3.60210238569715*^9, 
   3.602102388690322*^9}, {3.602102522212968*^9, 3.6021025547318296`*^9}, {
   3.6021026053387413`*^9, 3.602102617818443*^9}, {3.6021038447077026`*^9, 
   3.602103877347575*^9}, {3.602104104531579*^9, 3.6021041157152224`*^9}, 
   3.6021141022451167`*^9, {3.602114739924632*^9, 3.6021147618928933`*^9}, {
   3.602114799149026*^9, 3.6021148008451233`*^9}, 3.602115126364764*^9, {
   3.6021214358554087`*^9, 3.602121447827112*^9}, {3.60212284384404*^9, 
   3.6021228600209613`*^9}, {3.6021229592286654`*^9, 3.602122989684391*^9}, {
   3.6021263941403527`*^9, 3.602126456869944*^9}, {3.602126499374376*^9, 
   3.602126514830264*^9}, {3.60212699168659*^9, 3.6021269921736*^9}, {
   3.6021270608615465`*^9, 3.602127088765128*^9}, {3.6021272688214426`*^9, 
   3.6021273189093113`*^9}, {3.6021281098136168`*^9, 3.602128110037616*^9}, {
   3.6021281423504653`*^9, 3.6021281436135387`*^9}, {3.6021806572665524`*^9, 
   3.602180675766588*^9}, {3.6021808500638175`*^9, 3.6021808837669973`*^9}, {
   3.6021809591733923`*^9, 3.602180973642171*^9}, {3.6021811893300953`*^9, 
   3.6021811927207274`*^9}, {3.60218146276813*^9, 3.6021815006432047`*^9}, {
   3.6021872014382105`*^9, 3.602187203992361*^9}, {3.6022454185362005`*^9, 
   3.6022454248956013`*^9}, {3.602246875695298*^9, 3.6022469258047724`*^9}, {
   3.6022478493014727`*^9, 3.6022478526596823`*^9}, {3.602250348582366*^9, 
   3.6022503487698684`*^9}, {3.6022503815042915`*^9, 
   3.6022504019574566`*^9}, {3.6022505680359087`*^9, 
   3.6022505890203223`*^9}, {3.6022519907603855`*^9, 3.602251996838523*^9}, {
   3.6022633691991196`*^9, 3.602263392964802*^9}, {3.602263962762781*^9, 
   3.6022639628096533`*^9}, {3.6022643102322044`*^9, 3.602264310325957*^9}, {
   3.6023004794207296`*^9, 3.6023005065602837`*^9}, {3.6024395503822546`*^9, 
   3.6024395523978844`*^9}, {3.602469181232812*^9, 3.602469188384222*^9}, 
   3.6026196362549043`*^9, {3.6026397599648113`*^9, 3.6026397752460923`*^9}, {
   3.602873803185768*^9, 3.6028738076232786`*^9}, {3.602888857124253*^9, 
   3.602888945530676*^9}, {3.602890891675105*^9, 3.6028909105188932`*^9}, {
   3.602891029112878*^9, 3.6028910298941293`*^9}, {3.602891182519424*^9, 
   3.602891207519473*^9}, 3.602893695289977*^9, {3.6028937267587786`*^9, 
   3.6028937297119074`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"m1", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{
       RowBox[{"-", "1.`"}], " ", "L", " ", "\[Alpha]"}], "0.`", "0.`", "0.`", 
      RowBox[{"0.08333333333333333`", " ", 
       SuperscriptBox["L", "2"], " ", "m1", " ", 
       SuperscriptBox["\[Alpha]", "2"]}]},
     {
      RowBox[{"0.5`", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2.`", " ", "m"}], "+", 
         RowBox[{"3.`", " ", "M"}]}], ")"}]}], "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"0.5`", " ", "m", " ", 
       SuperscriptBox["r", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6025064827723713`*^9, 3.6025065193454494`*^9, 3.602506652056051*^9, 
   3.602512352133477*^9, 3.602543007389*^9, 3.602617604027412*^9, 
   3.6026196387705345`*^9, 3.6026279535040894`*^9, 3.6026315489643836`*^9, {
   3.6026397758085938`*^9, 3.6026397974180136`*^9}, 3.6026914312243547`*^9, 
   3.6027021667296753`*^9, 3.6028738082795267`*^9, {3.6028889394369164`*^9, 
   3.6028889462494297`*^9}, {3.602890899597*^9, 3.602890911253269*^9}, {
   3.602891017956606*^9, 3.6028910305972548`*^9}, {3.602891192628821*^9, 
   3.6028912132226076`*^9}, 3.6028919381615295`*^9, 3.602893257210984*^9, 
   3.6028935631178474`*^9, {3.6028937007274756`*^9, 3.602893736680669*^9}, 
   3.6029074037174234`*^9, 3.6029378850807276`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"add", " ", "to", " ", "joint", " ", "library"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`joint", "[", "\"\<hook\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`joint", "[", "\"\<rz\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`XJ", "[", "\"\<hook\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`XJ", "[", "\"\<rz\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`dXJ", "[", "\"\<hook\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`dXJ", "[", "\"\<rz\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`joint", "[", "\"\<string\>\"", "]"}], " ", "=", 
     " ", 
     RowBox[{"NLink`Private`joint", "[", "\"\<py\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`XJ", "[", "\"\<string\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`transY", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"L", "+", "R"}], ")"}]}], "+", "#1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`dXJ", "[", "\"\<string\>\"", "]"}], " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"NLink`Private`XJ", "[", "\"\<string\>\"", "]"}], ",", " ", 
       "#1"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`joint", "[", "\"\<wheel\>\"", "]"}], " ", "=", 
     " ", 
     RowBox[{"R", " ", 
      RowBox[{"NLink`Private`joint", "[", "\"\<px\>\"", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`XJ", "[", "\"\<wheel\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`transX", "[", 
      RowBox[{"R", " ", "#1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`dXJ", "[", "\"\<wheel\>\"", "]"}], " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"NLink`Private`XJ", "[", "\"\<wheel\>\"", "]"}], ",", " ", 
       "#1"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`joint", "[", "\"\<winch\>\"", "]"}], " ", "=", 
     " ", 
     RowBox[{"NLink`Private`joint", "[", "\"\<rz\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`XJ", "[", "\"\<winch\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`XJ", "[", "\"\<rz\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`dXJ", "[", "\"\<winch\>\"", "]"}], " ", "=", " ", 
     RowBox[{"NLink`Private`dXJ", "[", "\"\<rz\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLink`Private`joint", "[", "\"\<puppeteer\>\"", "]"}], " ", "=",
      " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<wheel\>\"", ",", " ", "\"\<winch\>\"", ",", "\"\<string\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"robot", " ", "description"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"g", " ", "=", " ", "9.81"}], ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"m", "/", 
      RowBox[{"s", "^", "2"}]}], " ", "*)"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parent", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"joints", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<rz\>\"", ",", " ", "\"\<puppeteer\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bcons", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"r", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
       ".", 
      RowBox[{"NLink`Private`Xba", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "L"}], ",", "0"}], "}"}], "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cons", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "L", ",", "1", ",", "0"}], 
          "}"}], ",", " ", 
         RowBox[{"-", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
           "}"}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", " ", 
         RowBox[{"-", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
           "}"}]}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nd", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Length", "@", 
        RowBox[{"NLink`Private`ExpandJoints", "[", "joints", "]"}]}]}], " ", 
      "+", " ", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nd", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"jump", " ", "map"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"4", ",", " ", "4"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ximp", " ", "=", " ", 
      RowBox[{"NLink`Private`Xba", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
         "kjc2ajc"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{
       RowBox[{"ArrayPad", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"3", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}], ".", 
       "Ximp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SetModel", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Rest", "@", "joints"}], ",", " ", "\"\<fc\>\""}], "]"}], 
       ",", " ", "parent", ",", " ", "b", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "g", ",", " ", "0"}], "}"}], ",", " ", 
       "inertia", ",", " ", "frames", ",", " ", "R", ",", " ", "nd"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      RowBox[{"GetAccelerationFunction", "[", "\"\<Imp\>\"", "]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "dynamics", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetModel", "[", 
     RowBox[{"joints", ",", " ", "parent", ",", " ", 
      RowBox[{"{", 
       RowBox[{"bcons", ",", " ", "cons"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "g", ",", " ", "0"}], "}"}], ",", " ", 
      "inertia", ",", " ", "frames", ",", " ", "nd"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"fix", " ", "up", " ", "the", " ", "constraints"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "NLink`Private`bodies", "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"NLink`Private`map", "\[LeftDoubleBracket]", 
        RowBox[{
        "parent", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}], " ", "+", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "3"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "NLink`Private`bodies", "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"NLink`Private`map", "\[LeftDoubleBracket]", 
        RowBox[{
        "parent", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}], " ", "+", " ", 
       RowBox[{"{", 
        RowBox[{"2", ",", " ", "5"}], "}"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"GetAccelerationFunction", "[", "\"\<All\>\"", "]"}]}], ";"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5939714866972804`*^9, 3.593971487376317*^9}, {
   3.593971524080418*^9, 3.59397152427943*^9}, 3.5939716018668756`*^9, {
   3.593971778643999*^9, 3.593971822458508*^9}, {3.593971855738424*^9, 
   3.59397188361001*^9}, {3.5939719236272974`*^9, 3.593971936606046*^9}, {
   3.593972427098134*^9, 3.5939725136320896`*^9}, 3.593972636393119*^9, 
   3.593972923297547*^9, {3.5939729571304874`*^9, 3.5939730216492004`*^9}, {
   3.5939730630595536`*^9, 3.5939730660977273`*^9}, {3.593973159045048*^9, 
   3.5939732317142105`*^9}, {3.59397330595446*^9, 3.593973316547067*^9}, {
   3.5939735435370684`*^9, 3.5939735832653427`*^9}, 3.593973807578189*^9, 
   3.5939739839452887`*^9, {3.593974036820315*^9, 3.5939740689611654`*^9}, {
   3.5939741121276293`*^9, 3.593974117895956*^9}, {3.5939741768503323`*^9, 
   3.593974177552376*^9}, {3.5939742976182528`*^9, 3.593974299141339*^9}, {
   3.5939842677327366`*^9, 3.5939842695248365`*^9}, {3.5939910083707685`*^9, 
   3.593991019849407*^9}, {3.59399394574796*^9, 3.5939939459559765`*^9}, {
   3.593993996296853*^9, 3.5939939964878693`*^9}, {3.5939940819077606`*^9, 
   3.5939941668946238`*^9}, {3.593994212096217*^9, 3.5939942941619167`*^9}, {
   3.5939943430117135`*^9, 3.593994375594598*^9}, {3.5939944171409583`*^9, 
   3.593994569692711*^9}, {3.5939946293561115`*^9, 3.5939947138349447`*^9}, {
   3.593994821560114*^9, 3.593994843696386*^9}, 3.5939948828726287`*^9, {
   3.593994933713541*^9, 3.5939949950320563`*^9}, {3.5939950422967587`*^9, 
   3.593995042999799*^9}, {3.5939950754326563`*^9, 3.593995176469446*^9}, {
   3.5939952594561944`*^9, 3.593995260078231*^9}, {3.5939954167752028`*^9, 
   3.5939954189263268`*^9}, 3.5939958737903757`*^9, {3.5940018452523413`*^9, 
   3.5940018634573836`*^9}, {3.5940364260407205`*^9, 3.59403643929348*^9}, {
   3.59404695976937*^9, 3.5940469730251317`*^9}, {3.594047572538464*^9, 
   3.5940475767457047`*^9}, {3.594047617058014*^9, 3.5940476173430295`*^9}, 
   3.5940494453787184`*^9, {3.5940499948311844`*^9, 3.5940500051277704`*^9}, {
   3.59639250261977*^9, 3.5963925910508366`*^9}, 3.5963926628989487`*^9, {
   3.5963927036002765`*^9, 3.596392705271375*^9}, {3.596392803443016*^9, 
   3.596392805794135*^9}, {3.5990940878003387`*^9, 3.5990941152589087`*^9}, {
   3.5990941752093415`*^9, 3.5990941779595013`*^9}, {3.599094208752265*^9, 
   3.599094217847787*^9}, {3.599094289491886*^9, 3.599094339983778*^9}, 
   3.5990944185712824`*^9, {3.599144869491782*^9, 3.5991448741167912`*^9}, {
   3.5992566576984034`*^9, 3.599256669919103*^9}, {3.5992604825284348`*^9, 
   3.5992605087139378`*^9}, {3.5992640613763866`*^9, 
   3.5992640700028815`*^9}, {3.5993127913501625`*^9, 3.599312816406597*^9}, {
   3.60209670506384*^9, 3.602096707399973*^9}, {3.602096841888675*^9, 
   3.6020969608325067`*^9}, {3.6020971429829183`*^9, 3.602097180502063*^9}, {
   3.602097372311064*^9, 3.602097388141958*^9}, {3.6020974331165323`*^9, 
   3.602097455301817*^9}, {3.6021001065526304`*^9, 3.6021001491510725`*^9}, 
   3.6021002259354687`*^9, {3.6021007104362135`*^9, 3.602100714579451*^9}, {
   3.602101031090576*^9, 3.60210105702608*^9}, {3.6021011261440196`*^9, 
   3.602101156304747*^9}, {3.6021026509113383`*^9, 3.6021026749367175`*^9}, {
   3.6021027230404725`*^9, 3.602102846078514*^9}, {3.602105118684658*^9, 
   3.602105145285184*^9}, {3.6021124509175515`*^9, 3.60211245213564*^9}, {
   3.602113903642743*^9, 3.602113905275838*^9}, 3.6021146266831503`*^9, {
   3.602114963485438*^9, 3.6021149635724397`*^9}, {3.6021149998355207`*^9, 
   3.602115000013525*^9}, 3.6021150821692343`*^9, {3.6021151441637816`*^9, 
   3.602115146456915*^9}, 3.602115240065276*^9, {3.602116747227586*^9, 
   3.602116788488945*^9}, {3.6021168743938875`*^9, 3.602116918921418*^9}, {
   3.60211705795338*^9, 3.602117058329402*^9}, {3.6021172082250023`*^9, 
   3.602117238050695*^9}, {3.6021174130767174`*^9, 3.6021174409793286`*^9}, 
   3.602118991155089*^9, 3.6021200515338125`*^9, {3.6021209652971597`*^9, 
   3.602120965423167*^9}, 3.602121178350339*^9, 3.602121216713539*^9, {
   3.6021212881986322`*^9, 3.602121297543488*^9}, {3.6021213383468246`*^9, 
   3.6021213933209724`*^9}, {3.602121665196542*^9, 3.602121665440556*^9}, 
   3.6021218488140574`*^9, {3.602121923819353*^9, 3.6021219278416014`*^9}, {
   3.602122118261487*^9, 3.6021221189805307`*^9}, {3.6021221599268737`*^9, 
   3.6021221789719644`*^9}, {3.602122808604021*^9, 3.6021228121562243`*^9}, {
   3.6021229080357103`*^9, 3.602122928665897*^9}, {3.602123134881706*^9, 
   3.602123140899048*^9}, {3.6021232344284067`*^9, 3.602123234771427*^9}, {
   3.602124758847705*^9, 3.6021247668741646`*^9}, {3.602125139931528*^9, 
   3.6021251600677004`*^9}, {3.602125192955579*^9, 3.602125236156049*^9}, {
   3.6021265790579424`*^9, 3.6021266365292344`*^9}, {3.602126673874372*^9, 
   3.602126714018671*^9}, {3.6021267662706633`*^9, 3.602126794718292*^9}, {
   3.6021268513435335`*^9, 3.6021268557667885`*^9}, {3.6021271166947308`*^9, 
   3.602127165831544*^9}, {3.602127585322581*^9, 3.602127633443323*^9}, {
   3.6021276861803436`*^9, 3.602127707491564*^9}, 3.6021277585355062`*^9, {
   3.6021278102944508`*^9, 3.602127812090554*^9}, {3.602128686289612*^9, 
   3.602128697020231*^9}, {3.6021289919411383`*^9, 3.6021290133103404`*^9}, {
   3.6021810277672796`*^9, 3.6021810493923187`*^9}, {3.6021815383776503`*^9, 
   3.602181551424554*^9}, 3.6021871448609715`*^9, {3.602245496130098*^9, 
   3.602245514411386*^9}, {3.6022455520208387`*^9, 3.6022455990834246`*^9}, {
   3.602245945896604*^9, 3.602245967287275*^9}, {3.6022460373342857`*^9, 
   3.602246096053151*^9}, 3.602246138193857*^9, {3.6022462100689993`*^9, 
   3.6022462105221252`*^9}, {3.602246371631815*^9, 3.602246371741205*^9}, {
   3.602246412710018*^9, 3.602246412772521*^9}, {3.602246478522649*^9, 
   3.6022464797101493`*^9}, 3.6022465472884083`*^9, {3.602246624772934*^9, 
   3.6022466253041883`*^9}, {3.602246686944931*^9, 3.6022466873824344`*^9}, {
   3.602246719273119*^9, 3.602246719366869*^9}, {3.6022469903830266`*^9, 
   3.6022470080705595`*^9}, {3.6022478665584784`*^9, 3.602247880628271*^9}, {
   3.602248540025034*^9, 3.602248540367052*^9}, {3.6022492103145027`*^9, 
   3.6022493015178337`*^9}, {3.602252611417851*^9, 3.602252617964737*^9}, {
   3.6022529482466364`*^9, 3.6022529503716373`*^9}, {3.6022533144661007`*^9, 
   3.6022533372317743`*^9}, {3.602253487778939*^9, 3.602253489435195*^9}, {
   3.602253520638381*^9, 3.602253521154005*^9}, {3.6022536092635508`*^9, 
   3.6022536176854424`*^9}, {3.6022539283266745`*^9, 
   3.6022539567486067`*^9}, {3.602254320093068*^9, 3.6022543236087008`*^9}, {
   3.602254363093151*^9, 3.6022543764056773`*^9}, {3.602254407530737*^9, 
   3.602254437827672*^9}, {3.6022545528435216`*^9, 3.602254557374777*^9}, {
   3.6022546029529953`*^9, 3.602254636312434*^9}, {3.602255006672535*^9, 
   3.602255009578789*^9}, {3.6022551988291607`*^9, 3.6022552010166636`*^9}, {
   3.602255240469866*^9, 3.6022552611730275`*^9}, {3.6022634132929535`*^9, 
   3.602263441199258*^9}, {3.6022636337308846`*^9, 3.602263642527775*^9}, {
   3.6022650560339346`*^9, 3.6022650595183163`*^9}, 3.602265119252808*^9, {
   3.602295048897744*^9, 3.602295071989068*^9}, {3.6022951155855637`*^9, 
   3.602295119441803*^9}, {3.6022953174231224`*^9, 3.6022954100414257`*^9}, {
   3.6022956633949347`*^9, 3.6022956931996417`*^9}, {3.602299289208573*^9, 
   3.602299296570998*^9}, {3.602299343224684*^9, 3.602299344910762*^9}, {
   3.6022996958438587`*^9, 3.602299696230894*^9}, {3.6023000676001453`*^9, 
   3.602300067684153*^9}, {3.602300332344309*^9, 3.602300379391003*^9}, {
   3.6024395715385513`*^9, 3.602439571616686*^9}, {3.6024398793672714`*^9, 
   3.602439892945426*^9}, {3.6024417414166555`*^9, 3.6024417437737885`*^9}, {
   3.6024436977844443`*^9, 3.6024437248589993`*^9}, {3.6024437661653633`*^9, 
   3.6024437683494945`*^9}, {3.602443834933312*^9, 3.6024438375634623`*^9}, {
   3.6024453396114793`*^9, 3.6024453549813643`*^9}, {3.602446634207612*^9, 
   3.602446715739272*^9}, {3.6024485107450824`*^9, 3.602448512911203*^9}, {
   3.602448972582514*^9, 3.6024489729615355`*^9}, {3.6024492268520765`*^9, 
   3.602449239238782*^9}, {3.602449317136245*^9, 3.602449318100308*^9}, {
   3.6024500879043846`*^9, 3.6024500947437763`*^9}, {3.602467923862791*^9, 
   3.6024679312682314`*^9}, {3.602468070360177*^9, 3.6024680962656612`*^9}, 
   3.6024682560148287`*^9, {3.60246859011594*^9, 3.602468592241064*^9}, {
   3.6024686901046867`*^9, 3.6024688938873563`*^9}, {3.602468990135847*^9, 
   3.6024689948951406`*^9}, {3.602469352772617*^9, 3.6024693695795794`*^9}, {
   3.602469423000636*^9, 3.6024694375844917`*^9}, {3.6024694678432064`*^9, 
   3.6024694939267187`*^9}, {3.60246995372405*^9, 3.6024699542470646`*^9}, {
   3.602512374231756*^9, 3.6025123792000237`*^9}, {3.6025125733151407`*^9, 
   3.6025125973935194`*^9}, {3.602617056237046*^9, 3.602617077495263*^9}, {
   3.6026176164551463`*^9, 3.6026176192312875`*^9}, {3.6026176746514606`*^9, 
   3.6026177103915076`*^9}, {3.6026196519111853`*^9, 3.602619677754985*^9}, 
   3.602620052630718*^9, {3.6026201142714634`*^9, 3.602620121755872*^9}, 
   3.602620154021541*^9, {3.602627962275591*^9, 3.6026279753323393`*^9}, {
   3.602631227260646*^9, 3.6026312308231325`*^9}, {3.602631555933143*^9, 
   3.6026315796675653`*^9}, {3.60270219456227*^9, 3.602702223227913*^9}, {
   3.602702502941929*^9, 3.602702504766035*^9}, {3.602873823701433*^9, 
   3.602873882389064*^9}, {3.602874058123765*^9, 3.602874058701894*^9}, {
   3.6028749495630093`*^9, 3.602875048891328*^9}, {3.602875093907041*^9, 
   3.6028750974226747`*^9}, {3.602875145657143*^9, 3.6028751486571474`*^9}, 
   3.6028752090322666`*^9, {3.6028752450635867`*^9, 3.6028753173606033`*^9}, 
   3.602875358266945*^9, 3.6028753892513685`*^9, {3.6028754938297157`*^9, 
   3.602875500110968*^9}, {3.602875537345408*^9, 3.602875544501678*^9}, {
   3.6028756061892977`*^9, 3.6028756312362165`*^9}, {3.60288308966741*^9, 
   3.6028830904799113`*^9}, {3.602883152776909*^9, 3.602883156792542*^9}, {
   3.6028890104839287`*^9, 3.602889096359095*^9}, {3.602889451812916*^9, 
   3.60288947418796*^9}, {3.602891233378913*^9, 3.6028912700195937`*^9}, {
   3.6028913422541122`*^9, 3.6028914369105444`*^9}, {3.6028914801137533`*^9, 
   3.602891632379679*^9}, {3.602891668489129*^9, 3.6028916755985193`*^9}, {
   3.6028917657705812`*^9, 3.602891795208123*^9}, {3.602891945099042*^9, 
   3.602891945349042*^9}, {3.602892001333526*^9, 3.6028920018960285`*^9}, {
   3.6028921738182397`*^9, 3.602892177099496*^9}, {3.6028922099276843`*^9, 
   3.602892236474612*^9}, {3.602892422787476*^9, 3.6028924576469193`*^9}, {
   3.6028930027886105`*^9, 3.6028930036948624`*^9}, {3.602893083726269*^9, 
   3.6028931056638107`*^9}, {3.602893319101729*^9, 3.602893324195489*^9}, {
   3.6028935211177497`*^9, 3.602893543914671*^9}, 3.602893588383505*^9, {
   3.602893746852566*^9, 3.602893762305726*^9}, 3.6028943085724134`*^9, 
   3.6028944002757187`*^9, {3.6028947173700886`*^9, 3.6028947284794855`*^9}, {
   3.6028948163546567`*^9, 3.602894816729659*^9}, {3.60289492526112*^9, 
   3.602894943823657*^9}, {3.602937714486645*^9, 3.602937731752304*^9}, {
   3.6029378550181694`*^9, 3.602937859908804*^9}, 3.602937935033952*^9, {
   3.602937972846526*^9, 3.602938069581091*^9}, {3.602938185393817*^9, 
   3.6029382123626184`*^9}, 3.6029382524564466`*^9, {3.6029382986753073`*^9, 
   3.602938299706541*^9}, {3.60293844801933*^9, 3.602938450550585*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Quiet", "@", 
     RowBox[{"NLink`Private`Jcoord", "[", 
      RowBox[{"q", ",", " ", "1", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "L"}], ",", "0"}], "}"}]}], "]"}]}], " ", "//", " ", 
    "Simplify"}], " ", "//", " ", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Quiet", "@", 
    RowBox[{"NLink`Private`Jcoord", "[", 
     RowBox[{"q", ",", " ", "1", ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"-", "L"}], ",", "0"}], "}"}]}], "]"}]}], " ", "//", " ", 
   "Simplify"}], " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6028739094672265`*^9, 3.602873919170371*^9}, {
   3.6028739692173443`*^9, 3.6028739746236205`*^9}, {3.602874063670652*^9, 
   3.602874090545704*^9}, {3.6028741712489862`*^9, 3.6028741801083965`*^9}, {
   3.602874216827218*^9, 3.6028742323897305`*^9}, {3.6028743023430104`*^9, 
   3.602874308155507*^9}, 3.602874361827487*^9, 3.6028747487344904`*^9, {
   3.602874836234663*^9, 3.6028748632034674`*^9}, {3.6028749293598433`*^9, 
   3.602874929859844*^9}, {3.602875451267117*^9, 3.6028754752827873`*^9}, {
   3.602875576298627*^9, 3.6028755774392385`*^9}, {3.6028756407049847`*^9, 
   3.6028756547362814`*^9}, {3.6028757514083295`*^9, 3.602875774314639*^9}, 
   3.6028830744173827`*^9, {3.602883107683071*^9, 3.6028831163705893`*^9}, 
   3.602892032130462*^9, {3.6028922413964987`*^9, 3.6028922433340025`*^9}, {
   3.602892906288435*^9, 3.602892936022854*^9}, {3.6028944944321556`*^9, 
   3.6028945049477997`*^9}, 3.6028955706998816`*^9, 3.6028963049825835`*^9, {
   3.6028967169682465`*^9, 3.6028967467808046`*^9}, {3.6028967920465183`*^9, 
   3.6028968066715465`*^9}, {3.6028975882043266`*^9, 3.6028975952512116`*^9}, 
   3.602907417201826*^9, {3.6029074537331443`*^9, 3.6029074949051027`*^9}, 
   3.6029075973115535`*^9, {3.6029377471585865`*^9, 3.602937805799325*^9}, {
   3.602937835908758*^9, 3.6029378370025125`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"1", "0", "1", "0"},
     {"L", 
      RowBox[{"R", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], 
      RowBox[{"L", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "-", 
       RowBox[{"R", " ", 
        RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
        "]"}]},
     {"0", 
      RowBox[{
       RowBox[{"-", "R"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"L", "+", "R", "+", 
         RowBox[{"R", " ", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
        ")"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
        "]"}]},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.602892901038416*^9, 3.6028929368666096`*^9}, 
   3.602893451445739*^9, {3.6028944950415287`*^9, 3.602894523275958*^9}, 
   3.6028950310269527`*^9, 3.6028955714186354`*^9, 3.602896306670074*^9, 
   3.602896713468236*^9, 3.602896747624555*^9, {3.602896795359024*^9, 
   3.602896806921548*^9}, {3.6028975890949497`*^9, 3.602897595626213*^9}, {
   3.6029074119205637`*^9, 3.60290741777995*^9}, {3.60290745693629*^9, 
   3.602907495920742*^9}, 3.6029075980459304`*^9, 3.6029377512836113`*^9, {
   3.602937789049299*^9, 3.6029378124868383`*^9}, 3.6029382875815163`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"1", "0", "1", "0"},
     {"L", 
      RowBox[{"R", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], 
      RowBox[{"L", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "-", 
       RowBox[{"R", " ", 
        RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
        "]"}]},
     {"0", 
      RowBox[{
       RowBox[{"-", "R"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"L", "+", "R", "+", 
         RowBox[{"R", " ", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
        ")"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
        "]"}]},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.602892901038416*^9, 3.6028929368666096`*^9}, 
   3.602893451445739*^9, {3.6028944950415287`*^9, 3.602894523275958*^9}, 
   3.6028950310269527`*^9, 3.6028955714186354`*^9, 3.602896306670074*^9, 
   3.602896713468236*^9, 3.602896747624555*^9, {3.602896795359024*^9, 
   3.602896806921548*^9}, {3.6028975890949497`*^9, 3.602897595626213*^9}, {
   3.6029074119205637`*^9, 3.60290741777995*^9}, {3.60290745693629*^9, 
   3.602907495920742*^9}, 3.6029075980459304`*^9, 3.6029377512836113`*^9, {
   3.602937789049299*^9, 3.6029378124868383`*^9}, 3.602938287612767*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
  "NLink`Private`bodies", "\[IndentingNewLine]", 
   "NLink`Private`r"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.602893110210696*^9, 3.602907408795577*^9, {3.6029382897846465`*^9, 
   3.6029383023940597`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "L", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.602893110210696*^9, 3.602907408795577*^9, {3.6029382897846465`*^9, 
   3.6029383023940597`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NLink`Private`joint", "[", "\"\<\[Phi]\>\"", "]"}], " ", "=", 
    " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "L"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`XJ", "[", "\"\<\[Phi]\>\"", "]"}], " ", "=", " ", 
    RowBox[{"NLink`Private`transX", "[", 
     RowBox[{"(", 
      RowBox[{"L", "+", "R", "+", 
       RowBox[{"L", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`dXJ", "[", "\"\<\[Phi]\>\"", "]"}], " ", "=", " ", 
    RowBox[{"NLink`Private`dXJ", "[", "\"\<px\>\"", "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`joint", "[", "\"\<\[Gamma]\>\"", "]"}], " ", "=", 
    " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`XJ", "[", "\"\<\[Gamma]\>\"", "]"}], " ", "=", " ", 
    RowBox[{"NLink`Private`transX", "[", 
     RowBox[{"(", 
      RowBox[{"L", "+", "R", "+", 
       RowBox[{"L", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`dXJ", "[", "\"\<\[Gamma]\>\"", "]"}], " ", "=", 
    " ", 
    RowBox[{"NLink`Private`dXJ", "[", "\"\<px\>\"", "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`joint", "[", "\"\<a\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Quiet", "@", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"-", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        ",", 
       RowBox[{"Sin", "[", 
        RowBox[{"-", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`XJ", "[", "\"\<a\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"NLink`Private`transY", "[", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"-", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "#"}], "]"}], ".", 
      RowBox[{"NLink`Private`transX", "[", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"-", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "#"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`dXJ", "[", "\"\<a\>\"", "]"}], " ", "=", " ", 
    RowBox[{"NLink`Private`dXJ", "[", "\"\<px\>\"", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NLink`Private`joint", "[", "\"\<b\>\"", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<rz\>\"", ",", " ", "\"\<py\>\"", ",", " ", "\"\<px\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q0", " ", "=", " ", 
   RowBox[{"Quiet", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "4"}], ",", " ", 
      RowBox[{"RandomReal", "[", "]"}], ",", " ", "0", ",", " ", "0"}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Quiet", "@", 
     RowBox[{"PP", "[", 
      RowBox[{"q0", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Jcoord", "[", 
          RowBox[{"q0", ",", " ", "2", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{
              "q0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "//", " ", 
        "Simplify"}]}], "]"}]}], " ", "//", " ", "Simplify"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Quiet", "@", 
     RowBox[{"PP", "[", 
      RowBox[{"q0", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Jcoord", "[", 
          RowBox[{"q0", ",", " ", "2", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "//", " ", 
        "Simplify"}]}], "]"}]}], " ", "//", " ", "Simplify"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"%", "-", "%%"}], "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"R", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"L1", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"L2", "\[Rule]", " ", "1"}]}], "}"}]}], " ", "//", " ", 
   "Simplify"}], " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6026957492124557`*^9, 3.6026957812482915`*^9}, {
  3.602695858252701*^9, 3.6026958786768694`*^9}, {3.602695997727687*^9, 
  3.602695998082712*^9}, {3.6026960911370373`*^9, 3.6026960931221495`*^9}, {
  3.6026961326524305`*^9, 3.6026961332984505`*^9}, {3.602696505446779*^9, 
  3.6026965099300346`*^9}, {3.6026966067075787`*^9, 3.602696636745283*^9}, {
  3.6026967780233717`*^9, 3.602696826544151*^9}, {3.6026968587439938`*^9, 
  3.6026968605100956`*^9}, {3.6026969011084204`*^9, 3.6026969242477465`*^9}, {
  3.6026970283877096`*^9, 3.6026970420434914`*^9}, {3.602697075592413*^9, 
  3.6026971408011475`*^9}, {3.6026972355965757`*^9, 3.6026972737907743`*^9}, {
  3.6026974615305157`*^9, 3.602697512740446*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.5907862692208494`"}], "0.2387137012559794`", 
      "0.12903885007788685`", "0.1687960769202427`"},
     {
      RowBox[{"-", "0.3991771966758802`"}], "0.5583947692269902`", 
      RowBox[{"-", "1.0237013032499709`"}], 
      RowBox[{"-", "0.31226205328704537`"}]},
     {"0.20855330376259873`", 
      RowBox[{"-", "1.0237013032499709`"}], 
      RowBox[{"-", "0.13060034933535847`"}], 
      RowBox[{"-", "0.16879607692024268`"}]},
     {"0.27280915385276694`", 
      RowBox[{"-", "0.31226205328704537`"}], 
      RowBox[{"-", "0.16879607692024268`"}], 
      RowBox[{"-", "0.2208026153865048`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6026957848314953`*^9, {3.602695849480198*^9, 3.602695878913884*^9}, {
   3.602695979221629*^9, 3.602695998912755*^9}, 3.60269603515783*^9, 
   3.6026960986324654`*^9, 3.6026961347885365`*^9, {3.6026964929950514`*^9, 
   3.602696510788069*^9}, {3.6026966217174206`*^9, 3.6026966378293457`*^9}, {
   3.602696817121612*^9, 3.6026968614641504`*^9}, {3.6026969179143834`*^9, 
   3.6026969245727654`*^9}, {3.602697054297194*^9, 3.602697057107355*^9}, {
   3.602697092043355*^9, 3.6026971436073074`*^9}, {3.602697232938424*^9, 
   3.602697242673981*^9}, {3.602697275350853*^9, 3.6026972856944447`*^9}, {
   3.6026973746175365`*^9, 3.6026973775657063`*^9}, 3.6026974269195337`*^9, {
   3.602697465189724*^9, 3.602697514492547*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"original", " ", "tree"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TreePlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "parent", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[Rule]", " ", "i"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ",", " ", "Automatic", 
      ",", " ", "0", ",", " ", 
      RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"extended", " ", "tree"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TreePlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "NLink`Private`parent", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], "\[Rule]", " ", "i"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "NLink`Private`nq"}], "}"}]}], "]"}], ",", 
      " ", "Automatic", ",", " ", "0", ",", " ", 
      RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"draw", " ", "figure"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q0", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", " ", "NLink`Private`nq"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"DrawPuppeteers", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "p", ",", " ", "wheel", ",", " ", "winch", ",", " ", "notch1", ",", 
           " ", "notch2", ",", " ", "i"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
            RowBox[{"NLink`Private`GetPoints", "[", "q", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"1", ";;", "np"}], ",", " ", 
             RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Range", "[", "np", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"wheel", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{
               "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
               ",", " ", "R"}], "]"}], "&"}], " ", "/@", " ", "i"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"winch", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{
               "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
               ",", " ", "r"}], "]"}], "&"}], " ", "/@", " ", "i"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"notch1", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
                ",", " ", 
                RowBox[{
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
                 "+", " ", 
                 RowBox[{"R", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"q", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"3", "#"}], "-", "2"}], "\[RightDoubleBracket]"}],
                     "]"}], ",", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"q", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"3", "#"}], "-", "2"}], "\[RightDoubleBracket]"}],
                     "]"}]}], "}"}]}]}]}], "}"}], "]"}], "&"}], " ", "/@", 
            " ", "i"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"notch2", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
                ",", " ", 
                RowBox[{
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
                 "+", " ", 
                 RowBox[{"r", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"q", "\[LeftDoubleBracket]", 
                    RowBox[{"3", "#"}], "\[RightDoubleBracket]"}], "]"}], ",",
                     " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"q", "\[LeftDoubleBracket]", 
                    RowBox[{"3", "#"}], "\[RightDoubleBracket]"}], "]"}]}], 
                   "}"}]}]}]}], "}"}], "]"}], "&"}], " ", "/@", " ", "i"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "Thick", "}"}], ",", " ", 
             RowBox[{"{", "Black", "}"}], ",", " ", "wheel", ",", 
             RowBox[{"{", "Yellow", "}"}], ",", " ", "notch1", ",", 
             RowBox[{"{", "Red", "}"}], ",", " ", "winch", ",", " ", 
             RowBox[{"{", "White", "}"}], ",", " ", "notch2"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"poi", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", 
              RowBox[{"-", "L"}], ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", 
              RowBox[{"-", "L"}], ",", " ", "0"}], "}"}]}], "}"}]}], 
         "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colors", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"Black", ",", " ", 
        RowBox[{"n", "+", 
         RowBox[{"Length", "@", "poi"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"colors", "\[LeftDoubleBracket]", 
       RowBox[{"n", "+", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
      "Red"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"colors", "\[LeftDoubleBracket]", 
       RowBox[{"n", "+", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
      "Green"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DrawPuppets", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"NLink`Private`DrawFigure2D", "[", 
         RowBox[{"q", ",", " ", "poi", ",", " ", 
          RowBox[{"VertexColors", "\[Rule]", " ", "colors"}]}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"DrawPuppeteers", "[", "q0", "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"DrawPuppets", "[", "q0", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.596392913000272*^9, 3.596392947509266*^9}, {
   3.596392977521966*^9, 3.596393040975608*^9}, {3.5963930801818404`*^9, 
   3.5963931003000154`*^9}, {3.5963932648354197`*^9, 3.59639326656052*^9}, 
   3.5963933002494516`*^9, {3.5963953038211856`*^9, 3.596395306130316*^9}, {
   3.596395614889999*^9, 3.596395617203129*^9}, {3.5963956537022395`*^9, 
   3.596395685028014*^9}, {3.5963957440353947`*^9, 3.5963957589992523`*^9}, {
   3.5963958143954244`*^9, 3.596395825407055*^9}, {3.5963960368971663`*^9, 
   3.5963960396233225`*^9}, {3.5964196951123285`*^9, 
   3.5964197992844076`*^9}, {3.5964201035506277`*^9, 
   3.5964201048318815`*^9}, {3.5990950906727715`*^9, 
   3.5990951367654114`*^9}, {3.599095235386054*^9, 3.599095408128948*^9}, {
   3.5990954454310846`*^9, 3.599095605352245*^9}, {3.5990956987686*^9, 
   3.5990958499582524`*^9}, {3.5991446361944485`*^9, 
   3.5991446488038635`*^9}, {3.599144687850799*^9, 3.5991446916633077`*^9}, {
   3.5991449206793795`*^9, 3.599144979413869*^9}, {3.599145864133669*^9, 
   3.599145902706876*^9}, {3.59914597539104*^9, 3.5991460193335543`*^9}, {
   3.599256690114256*^9, 3.5992567800174255`*^9}, 3.599256900304294*^9, {
   3.5992569466669493`*^9, 3.599256956369508*^9}, {3.5992571244791346`*^9, 
   3.599257154202833*^9}, 3.5992572159783792`*^9, {3.599260523815807*^9, 
   3.5992606324370203`*^9}, {3.5992641519915895`*^9, 3.59926421073394*^9}, {
   3.599312979682948*^9, 3.5993130584244576`*^9}, {3.5993131065832148`*^9, 
   3.5993131152387114`*^9}, {3.5993131727440224`*^9, 3.599313327683895*^9}, {
   3.599313395063754*^9, 3.5993133964068117`*^9}, 3.599313429586708*^9, {
   3.5993136035916777`*^9, 3.5993136242718563`*^9}, {3.599315494655967*^9, 
   3.5993155028944435`*^9}, {3.5993155332791834`*^9, 3.599315539568545*^9}, {
   3.6021002814066415`*^9, 3.6021004492492576`*^9}, {3.6021006356889334`*^9, 
   3.6021006609693785`*^9}, {3.6021007619371605`*^9, 3.602100888671421*^9}, {
   3.602100930104794*^9, 3.6021009693210583`*^9}, {3.602101190840725*^9, 
   3.6021012440877743`*^9}, {3.6021034311110177`*^9, 
   3.6021034648919506`*^9}, {3.602103535348991*^9, 3.6021035665487933`*^9}, {
   3.602103602686843*^9, 3.602103630147415*^9}, {3.6021042513709908`*^9, 
   3.6021043130525246`*^9}, {3.6021043435802717`*^9, 
   3.6021044647842126`*^9}, {3.6021045016723256`*^9, 
   3.6021048366665087`*^9}, {3.602105092970187*^9, 3.602105093584222*^9}, 
   3.6021134294185867`*^9, {3.6021231834014854`*^9, 3.602123223682789*^9}, {
   3.602123356471396*^9, 3.602123412406599*^9}, {3.6021234651106167`*^9, 
   3.60212347943845*^9}, {3.602123512246312*^9, 3.6021235961481247`*^9}, {
   3.602124189815119*^9, 3.6021242104873157`*^9}, {3.6021283395667605`*^9, 
   3.602128385753405*^9}, {3.602128417433236*^9, 3.6021284428256736`*^9}, {
   3.6021284731854086`*^9, 3.602128484265047*^9}, {3.6021285177149625`*^9, 
   3.602128592025215*^9}, 3.602128652420676*^9, 3.602128705811734*^9, 
   3.602181606393408*^9, {3.6021816643935213`*^9, 3.6021816915498276`*^9}, {
   3.6021817468468084`*^9, 3.602181804815674*^9}, {3.602187184087221*^9, 
   3.6021871872274003`*^9}, {3.602187237793296*^9, 3.6021872643128147`*^9}, {
   3.6021873325317216`*^9, 3.602187343483359*^9}, {3.602188341613508*^9, 
   3.6021883509530425`*^9}, {3.6021884476335793`*^9, 3.602188451097797*^9}, {
   3.6021884825045767`*^9, 3.602188483912654*^9}, {3.6021886057216325`*^9, 
   3.6021886340232534`*^9}, {3.6021887206532154`*^9, 3.602188721858283*^9}, {
   3.602188839144001*^9, 3.6021889089179964`*^9}, {3.6021889783099833`*^9, 
   3.6021889823812027`*^9}, 3.6022080047128115`*^9, {3.6022082883383684`*^9, 
   3.6022082905727477`*^9}, {3.6022083413072195`*^9, 
   3.6022084504011927`*^9}, {3.6022084910418873`*^9, 
   3.6022085933545876`*^9}, {3.602208628870289*^9, 3.602208629089032*^9}, {
   3.6022087512924*^9, 3.602208885183283*^9}, {3.6022093797623806`*^9, 
   3.6022093836061325`*^9}, {3.6022094233562107`*^9, 
   3.6022094269968476`*^9}, {3.602245653161663*^9, 3.60224566219293*^9}, {
   3.602247964299059*^9, 3.6022479645120716`*^9}, {3.602248294774987*^9, 
   3.6022483122509875`*^9}, {3.6024501170670547`*^9, 3.6024501572993584`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "NLink`Private`nx"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx0", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"NLink`Private`nx", ",", " ", "NLink`Private`n\[Lambda]"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u0", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "NLink`Private`nq"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du0", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"NLink`Private`nq", ",", " ", "NLink`Private`n\[Lambda]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x0", "[", 
    RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
   RowBox[{"-", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLink`Private`F", "[", 
    RowBox[{"x0", ",", " ", "u0"}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"u0", " ", "=", " ", "NLink`Private`c"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fcn", "[", 
     RowBox[{"s_Real", ",", " ", "q_", ",", " ", "dq_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"dq", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
      ",", " ", "u0", ",", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", 
          RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"dq", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", 
          RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", " ",
       "du0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FixAngles", ",", " ", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixAngles", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{" ", 
        RowBox[{
        "make", " ", "sure", " ", "angles", " ", "are", " ", "btw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "pi"}], " ", "pi"}]}]}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"q", ",", " ", 
          RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", ">", "\[Pi]"}], ",", " ", 
         RowBox[{"x", " ", "-", " ", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", "x"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixState", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", " ", "=", " ", "x"}], ",", " ", "n"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", 
          RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{";;", "n"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", 
             RowBox[{";;", "n"}]}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
         " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "y"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlmap", "[", 
    RowBox[{"x0_", ",", " ", "u_", ",", " ", "t_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q", ",", " ", "q0", ",", " ", "dq0", ",", " ", "qimp", ",", " ", 
       "x0imp", ",", " ", "dx0imp", ",", " ", "b", ",", " ", "s", ",", " ", 
       "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q0", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], 
           "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dq0", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], 
           "}"}], ",", " ", 
          RowBox[{
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], 
           "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", " ", "=", " ", 
         RowBox[{"q", "/.", " ", 
          RowBox[{"First", "@", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
                RowBox[{"fcn", "[", 
                 RowBox[{"s", ",", " ", 
                  RowBox[{"q", "[", "s", "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", "q0"}], 
               ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
                "dq0"}]}], "}"}], ",", " ", "q", ",", " ", 
             RowBox[{"{", 
              RowBox[{"s", ",", " ", "t", ",", " ", "t"}], "}"}]}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"b", " ", "=", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "'"}], "[", "t", "]"}], ",", " ", 
            RowBox[{
             RowBox[{"q", "''"}], "[", "t", "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"q", "[", "t", "]"}], ",", " ", 
           RowBox[{
            RowBox[{"q", "'"}], "[", "t", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         "b"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x0imp", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"PadLeft", "[", 
            RowBox[{
             RowBox[{"q", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{";;", "n"}], ",", "1"}], "\[RightDoubleBracket]"}], 
             ",", " ", 
             RowBox[{"n", "+", "2"}]}], "]"}], ",", " ", 
           RowBox[{"PadLeft", "[", 
            RowBox[{
             RowBox[{"q", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "+", "1"}], ";;"}], ",", "1"}], 
              "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"n", "+", "2"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dx0imp", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ArrayPad", "[", 
            RowBox[{
             RowBox[{"q", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{";;", "n"}], ",", " ", 
               RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"ArrayPad", "[", 
            RowBox[{
             RowBox[{"q", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "+", "1"}], ";;"}], ",", " ", 
               RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"qimp", " ", "=", 
         RowBox[{"A", ".", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"x0imp", ",", " ", "dx0imp"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q", " ", "=", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A", ".", 
              RowBox[{"q", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{";;", "n"}], ",", " ", "1"}], 
               "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", ".", 
               RowBox[{"q", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{";;", "n"}], ",", " ", 
                 RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], ")"}], 
             "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qimp", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"q", ",", " ", "qimp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"qimp", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"qimp", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", 
            RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"q", "/.", " ", 
       RowBox[{"First", "@", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"fcn", "[", 
              RowBox[{"s", ",", " ", 
               RowBox[{"q", "[", "s", "]"}], ",", " ", 
               RowBox[{
                RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", "q0"}], ",", 
            " ", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
             "dq0"}]}], "}"}], ",", " ", "q", ",", " ", 
          RowBox[{"{", 
           RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], 
         "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5934327045113277`*^9, 3.5934327084331985`*^9}, {
   3.5934327519176607`*^9, 3.593432753464552*^9}, {3.5935408083970065`*^9, 
   3.5935408140845175`*^9}, {3.5935408457877045`*^9, 
   3.5935409170690937`*^9}, {3.5935409973036256`*^9, 
   3.5935410666943865`*^9}, {3.593541212991548*^9, 3.593541213241548*^9}, {
   3.5935413226167593`*^9, 3.593541328554273*^9}, {3.5935413756793656`*^9, 
   3.593541380648125*^9}, {3.5935414338669806`*^9, 3.5935414531638927`*^9}, {
   3.593541502773365*^9, 3.593541502929615*^9}, {3.5935417309613085`*^9, 
   3.5935418191646137`*^9}, 3.59354188669599*^9, {3.593542026633766*^9, 
   3.593542042790058*^9}, {3.5935420897276373`*^9, 3.5935421035870404`*^9}, {
   3.5935421404152365`*^9, 3.5935421406496134`*^9}, {3.5935421811028166`*^9, 
   3.593542199055976*^9}, {3.593542272993637*^9, 3.5935422965249166`*^9}, {
   3.593547315228881*^9, 3.59354737821338*^9}, {3.593547445385391*^9, 
   3.5935474606197915`*^9}, {3.593547616901346*^9, 3.593547647698282*^9}, {
   3.5935476890161934`*^9, 3.5935477018755937`*^9}, 3.5935479795636415`*^9, 
   3.5935480249387393`*^9, {3.5935480660212097`*^9, 3.593548264287224*^9}, {
   3.5935486464285917`*^9, 3.5935486468035903`*^9}, {3.5935487161474805`*^9, 
   3.593548719803738*^9}, {3.593548763803824*^9, 3.593548832788334*^9}, {
   3.5935489513666897`*^9, 3.593548993835524*^9}, {3.5935490353668556`*^9, 
   3.5935490426324944`*^9}, {3.5936176020798597`*^9, 3.593617605979084*^9}, {
   3.5936179261994033`*^9, 3.593617928673545*^9}, 3.5936248538513837`*^9, {
   3.593726382832244*^9, 3.5937264084572945`*^9}, {3.594049711607961*^9, 
   3.59404989581651*^9}, {3.5940501759735537`*^9, 3.594050193207538*^9}, {
   3.5940502267264605`*^9, 3.5940502730591145`*^9}, {3.5940503783631425`*^9, 
   3.594050379272209*^9}, {3.5940504785658965`*^9, 3.5940505324579687`*^9}, {
   3.594050571111182*^9, 3.594050588141155*^9}, {3.5940758440236006`*^9, 
   3.5940759024839478`*^9}, {3.5940774721328373`*^9, 3.594077486589665*^9}, {
   3.59407900804679*^9, 3.594079014623188*^9}, {3.59407937052155*^9, 
   3.594079377502968*^9}, {3.594145582036493*^9, 3.594145585333376*^9}, 
   3.594386490927598*^9, {3.594392637182137*^9, 3.5943927444082785`*^9}, {
   3.5943930375450644`*^9, 3.5943930404882336`*^9}, {3.5943931265931644`*^9, 
   3.594393159575057*^9}, {3.5944713902816973`*^9, 3.59447139348188*^9}, {
   3.594477009898514*^9, 3.594477031024723*^9}, {3.594477156078885*^9, 
   3.5944771614702115`*^9}, {3.594477356497361*^9, 3.594477368394045*^9}, {
   3.5944774223181486`*^9, 3.5944774503367357`*^9}, 3.5944774978524566`*^9, {
   3.594480656743355*^9, 3.5944806736873255`*^9}, 3.59451450259223*^9, {
   3.5945154785301037`*^9, 3.5945155230636516`*^9}, {3.594515578593834*^9, 
   3.594515579657888*^9}, {3.594516252753438*^9, 3.594516291386649*^9}, {
   3.5953351207851534`*^9, 3.5953351225507803`*^9}, {3.595335347316845*^9, 
   3.595335347676221*^9}, {3.5953354480982933`*^9, 3.5953354671920795`*^9}, 
   3.595336378271999*^9, {3.595337776180505*^9, 3.59533779886806*^9}, {
   3.5953398317795987`*^9, 3.59533983318587*^9}, {3.595447707094181*^9, 
   3.595447716922309*^9}, {3.595541643929057*^9, 3.5955416464603157`*^9}, {
   3.595595188133336*^9, 3.595595198512932*^9}, {3.5955981241554728`*^9, 
   3.5955981372592225`*^9}, {3.5955982741950703`*^9, 3.595598280692438*^9}, 
   3.595598332283391*^9, {3.5956366220002303`*^9, 3.5956366310783753`*^9}, {
   3.5964550551488476`*^9, 3.596455056711353*^9}, {3.599095915286994*^9, 
   3.599095934022067*^9}, {3.5990959775595603`*^9, 3.599095978568618*^9}, {
   3.599096093449216*^9, 3.5990961002005835`*^9}, {3.5990968254771338`*^9, 
   3.599096833187563*^9}, {3.59909703088488*^9, 3.5990970589154825`*^9}, {
   3.5991765254594927`*^9, 3.599176531010812*^9}, {3.602101729407567*^9, 
   3.6021017354139104`*^9}, {3.60210176747275*^9, 3.6021019221226025`*^9}, {
   3.6021019633059607`*^9, 3.602102070290107*^9}, {3.6021049442586703`*^9, 
   3.6021050001588693`*^9}, 3.6021051666524067`*^9, {3.602105222297593*^9, 
   3.6021052599527674`*^9}, 3.6021053396483126`*^9, {3.6021053783605304`*^9, 
   3.602105378401532*^9}, {3.6021110757658014`*^9, 3.6021110951569304`*^9}, {
   3.6021111493990173`*^9, 3.6021111540882854`*^9}, 3.6021111875212193`*^9, {
   3.6021112250563517`*^9, 3.602111238520121*^9}, {3.6021134624854803`*^9, 
   3.6021134628925023`*^9}, {3.602123761570595*^9, 3.602123829377475*^9}, {
   3.6021238850116625`*^9, 3.602123885323681*^9}, {3.6021240355772834`*^9, 
   3.6021240714273353`*^9}, 3.602124156697241*^9, {3.6021287310311785`*^9, 
   3.602128762162961*^9}, {3.602128793115734*^9, 3.602128844447673*^9}, {
   3.6021290543166943`*^9, 3.602129097452162*^9}, {3.602129274520302*^9, 
   3.6021293043010263`*^9}, {3.6021805753288918`*^9, 
   3.6021805816726546`*^9}, {3.602180696907255*^9, 3.602180697063504*^9}, {
   3.602208927152117*^9, 3.6022089328552513`*^9}, {3.6022089674021945`*^9, 
   3.602208967449068*^9}, {3.6022090348866997`*^9, 3.602209039324209*^9}, 
   3.602209114074356*^9, {3.602209341324801*^9, 3.6022093428248043`*^9}, {
   3.602209399246793*^9, 3.6022094075905733`*^9}, {3.6022104974052043`*^9, 
   3.6022104976395793`*^9}, {3.6022479364514647`*^9, 
   3.6022479392056212`*^9}, {3.6022479834961615`*^9, 
   3.6022479849782457`*^9}, {3.6022483429587445`*^9, 
   3.6022484627476034`*^9}, {3.6022493625022993`*^9, 3.60224943698682*^9}, {
   3.602249487486919*^9, 3.6022495098775845`*^9}, {3.6022495487057896`*^9, 
   3.602249569893333*^9}, 3.602252029213586*^9, 3.602450170280099*^9, {
   3.602450203465021*^9, 3.602450210744417*^9}, {3.602452905433735*^9, 
   3.6024529059307814`*^9}, 3.602452954766559*^9, {3.6024530085726576`*^9, 
   3.6024530086746473`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MatrixForm", " ", "/@", " ", 
     RowBox[{"nlmap", "[", 
      RowBox[{"x0", ",", " ", "u0", ",", " ", "t"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"x0", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"-", "NLink`Private`nq"}], ";;"}], "\[RightDoubleBracket]"}], 
     " ", "=", " ", 
     RowBox[{"0", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", " ", "7"}], "}"}], ",", " ", "NLink`Private`nq"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x0", "[", 
      RowBox[{"[", 
       RowBox[{"-", "3"}], "]"}], "]"}], " ", "=", " ", "20"}], ";"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"flow", " ", "=", " ", 
     RowBox[{"nlmap", "[", 
      RowBox[{"x0", ",", " ", "u0", ",", " ", "t"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Animate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DrawPuppets", "[", 
         RowBox[{
          RowBox[{"flow", "[", "s", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], "]"}], 
        ",", " ", 
        RowBox[{"DrawPuppeteers", "[", 
         RowBox[{
          RowBox[{"flow", "[", "s", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
       "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"NLink`Private`DrawFigure2D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"flow", "[", "s", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"{", "}"}]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "5"}], ",", " ", "5"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "5"}], ",", " ", "5"}], "}"}]}], "}"}]}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5934327045113277`*^9, 3.5934327084331985`*^9}, {
   3.5934327519176607`*^9, 3.593432753464552*^9}, {3.5935408083970065`*^9, 
   3.5935408140845175`*^9}, {3.5935408457877045`*^9, 
   3.5935409170690937`*^9}, {3.5935409973036256`*^9, 
   3.5935410666943865`*^9}, {3.593541212991548*^9, 3.593541213241548*^9}, {
   3.5935413226167593`*^9, 3.593541328554273*^9}, {3.5935413756793656`*^9, 
   3.593541380648125*^9}, {3.5935414338669806`*^9, 3.5935414531638927`*^9}, {
   3.593541502773365*^9, 3.593541502929615*^9}, {3.5935417309613085`*^9, 
   3.5935418191646137`*^9}, 3.59354188669599*^9, {3.593542026633766*^9, 
   3.593542042790058*^9}, {3.5935420897276373`*^9, 3.5935421035870404`*^9}, {
   3.5935421404152365`*^9, 3.5935421406496134`*^9}, {3.5935421811028166`*^9, 
   3.593542199055976*^9}, {3.593542272993637*^9, 3.5935422965249166`*^9}, {
   3.593547315228881*^9, 3.59354737821338*^9}, {3.593547445385391*^9, 
   3.5935474606197915`*^9}, {3.593547616901346*^9, 3.593547647698282*^9}, {
   3.5935476890161934`*^9, 3.5935477018755937`*^9}, 3.5935479795636415`*^9, 
   3.5935480249387393`*^9, {3.5935480660212097`*^9, 3.593548264287224*^9}, {
   3.5935486464285917`*^9, 3.5935486468035903`*^9}, {3.5935487161474805`*^9, 
   3.593548719803738*^9}, {3.593548763803824*^9, 3.593548832788334*^9}, {
   3.5935489513666897`*^9, 3.593548993835524*^9}, {3.5935490353668556`*^9, 
   3.5935490426324944`*^9}, {3.5936176020798597`*^9, 3.593617605979084*^9}, {
   3.5936179261994033`*^9, 3.593617928673545*^9}, 3.5936248538513837`*^9, {
   3.593726382832244*^9, 3.5937264084572945`*^9}, {3.594049711607961*^9, 
   3.59404989581651*^9}, {3.5940501759735537`*^9, 3.594050193207538*^9}, {
   3.5940502267264605`*^9, 3.5940502730591145`*^9}, {3.5940503783631425`*^9, 
   3.594050379272209*^9}, {3.5940504785658965`*^9, 3.5940505324579687`*^9}, {
   3.594050571111182*^9, 3.594050588141155*^9}, {3.5940758440236006`*^9, 
   3.5940759024839478`*^9}, {3.5940774721328373`*^9, 3.594077486589665*^9}, {
   3.59407900804679*^9, 3.594079014623188*^9}, {3.59407937052155*^9, 
   3.594079377502968*^9}, {3.594145582036493*^9, 3.594145585333376*^9}, 
   3.594386490927598*^9, {3.594392637182137*^9, 3.5943927444082785`*^9}, {
   3.5943930375450644`*^9, 3.5943930404882336`*^9}, {3.5943931265931644`*^9, 
   3.594393159575057*^9}, {3.5944713902816973`*^9, 3.59447139348188*^9}, {
   3.594477009898514*^9, 3.594477031024723*^9}, {3.594477156078885*^9, 
   3.5944771614702115`*^9}, {3.594477356497361*^9, 3.594477368394045*^9}, {
   3.5944774223181486`*^9, 3.5944774503367357`*^9}, 3.5944774978524566`*^9, {
   3.594480656743355*^9, 3.5944806736873255`*^9}, 3.59451450259223*^9, {
   3.5945154785301037`*^9, 3.5945155230636516`*^9}, {3.594515578593834*^9, 
   3.594515579657888*^9}, {3.594516252753438*^9, 3.594516291386649*^9}, {
   3.5953351207851534`*^9, 3.5953351225507803`*^9}, {3.595335347316845*^9, 
   3.595335347676221*^9}, {3.5953354480982933`*^9, 3.5953354671920795`*^9}, 
   3.595336378271999*^9, {3.595337776180505*^9, 3.59533779886806*^9}, {
   3.5953398317795987`*^9, 3.59533983318587*^9}, {3.595447707094181*^9, 
   3.595447716922309*^9}, {3.595541643929057*^9, 3.5955416464603157`*^9}, {
   3.595595188133336*^9, 3.595595198512932*^9}, {3.5955981241554728`*^9, 
   3.5955981372592225`*^9}, {3.5955982741950703`*^9, 3.595598280692438*^9}, 
   3.595598332283391*^9, {3.5956366220002303`*^9, 3.5956366310783753`*^9}, {
   3.5964550551488476`*^9, 3.596455056711353*^9}, {3.599095915286994*^9, 
   3.599095934022067*^9}, {3.5990959775595603`*^9, 3.599095978568618*^9}, {
   3.599096093449216*^9, 3.5990961002005835`*^9}, {3.5990968254771338`*^9, 
   3.599096833187563*^9}, {3.59909703088488*^9, 3.5990970589154825`*^9}, {
   3.5991765254594927`*^9, 3.599176531010812*^9}, {3.602101729407567*^9, 
   3.6021017354139104`*^9}, {3.60210176747275*^9, 3.6021019221226025`*^9}, {
   3.6021019633059607`*^9, 3.602102070290107*^9}, {3.6021049442586703`*^9, 
   3.6021050001588693`*^9}, 3.6021051666524067`*^9, {3.602105222297593*^9, 
   3.6021052599527674`*^9}, 3.6021053396483126`*^9, {3.6021053783605304`*^9, 
   3.602105378401532*^9}, {3.6021110757658014`*^9, 3.6021110951569304`*^9}, {
   3.6021111493990173`*^9, 3.6021111540882854`*^9}, 3.6021111875212193`*^9, {
   3.6021112250563517`*^9, 3.602111238520121*^9}, {3.6021134624854803`*^9, 
   3.6021134628925023`*^9}, {3.602123761570595*^9, 3.602123829377475*^9}, {
   3.6021238850116625`*^9, 3.602123885323681*^9}, {3.6021240355772834`*^9, 
   3.6021240714273353`*^9}, 3.602124156697241*^9, {3.6021287310311785`*^9, 
   3.602128762162961*^9}, {3.602128793115734*^9, 3.602128844447673*^9}, {
   3.6021290543166943`*^9, 3.602129097452162*^9}, {3.602129274520302*^9, 
   3.6021293043010263`*^9}, {3.6021805753288918`*^9, 
   3.6021805816726546`*^9}, {3.602180696907255*^9, 3.602180697063504*^9}, {
   3.602208927152117*^9, 3.6022089328552513`*^9}, {3.6022089674021945`*^9, 
   3.602208967449068*^9}, {3.6022090348866997`*^9, 3.602209039324209*^9}, 
   3.602209114074356*^9, {3.602209341324801*^9, 3.6022093428248043`*^9}, {
   3.602209399246793*^9, 3.6022094075905733`*^9}, {3.6022104974052043`*^9, 
   3.6022104976395793`*^9}, {3.6022479364514647`*^9, 
   3.6022479392056212`*^9}, {3.6022479834961615`*^9, 
   3.6022479849782457`*^9}, {3.6022483429587445`*^9, 
   3.6022484627476034`*^9}, {3.6022493625022993`*^9, 3.60224943698682*^9}, {
   3.602249487486919*^9, 3.6022495098775845`*^9}, {3.6022495487057896`*^9, 
   3.602249569893333*^9}, 3.602252029213586*^9, 3.602450170280099*^9, {
   3.6024502208399944`*^9, 3.6024502566080523`*^9}, {3.602451917696171*^9, 
   3.6024519183832235`*^9}, {3.6024530247725687`*^9, 3.6024530248935757`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Energy", "[", 
    RowBox[{"q_", ",", " ", "dq_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MM", ",", " ", "p", ",", " ", "rot"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", " ", "rot"}], "}"}], " ", "=", " ", 
       RowBox[{"NLink`Private`GetPoints", "[", "q", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"np", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], " ", 
       "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "rot", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
             "\[Transpose]"}], ".", 
            RowBox[{"inertia", "\[LeftDoubleBracket]", 
             RowBox[{"#", ",", " ", 
              RowBox[{"5", ";;", "7"}]}], "\[RightDoubleBracket]"}]}], " ", 
           "+", " ", 
           RowBox[{
           "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}], 
          ")"}], "&"}], " ", "/@", " ", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"np", "+", "1"}], ",", " ", "n"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"p", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"NLink`Private`XL", " ", "=", " ", 
       RowBox[{"NLink`Private`Xip", "[", "q", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NLink`Private`M", " ", "=", " ", "NLink`Private`ZM"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "NLink`Private`IC", " ", "=", " ", 
       "NLink`Private`\[DoubleStruckCapitalI]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NLink`Private`JSIM", "[", "q", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MM", " ", "=", " ", 
       RowBox[{"NLink`Private`M", "+", 
        RowBox[{
         RowBox[{"LowerTriangularize", "[", 
          RowBox[{"NLink`Private`M", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "\[Transpose]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"dq", ".", "MM", ".", "dq"}]}], " ", "+", "  ", 
       RowBox[{"g", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"inertia", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], " ", 
          "p"}], "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Energy", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"flow", "[", "s", "]"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"flow", "'"}], "[", "s", "]"}], ")"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], "-", 
    RowBox[{"Energy", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"flow", "[", "0", "]"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"flow", "'"}], "[", "0", "]"}], ")"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
   " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"AxesOrigin", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.602107317243563*^9, 3.6021073248159966`*^9}, {
   3.6021073772970004`*^9, 3.6021074265368223`*^9}, {3.6021074572255764`*^9, 
   3.6021074637449503`*^9}, {3.6021076060101004`*^9, 
   3.6021076135605326`*^9}, {3.6021076615612907`*^9, 
   3.6021076896408887`*^9}, {3.602107734577462*^9, 3.6021078083856864`*^9}, {
   3.6021092624439583`*^9, 3.6021092686103115`*^9}, {3.602109459338253*^9, 
   3.602109572792731*^9}, {3.602109608340764*^9, 3.6021096815129566`*^9}, {
   3.602109731920839*^9, 3.6021098266592684`*^9}, {3.6021098748600283`*^9, 
   3.602109898154376*^9}, {3.602110069305164*^9, 3.6021103879094095`*^9}, {
   3.6021104922613983`*^9, 3.6021107598337064`*^9}, {3.602110798247904*^9, 
   3.602110804542266*^9}, {3.602110949176571*^9, 3.602111062822057*^9}, {
   3.6021111228084955`*^9, 3.602111129408873*^9}, 3.6021112086834264`*^9, 
   3.6021112469436045`*^9, 3.602113575544952*^9, {3.6021236787768664`*^9, 
   3.6021237366321645`*^9}, {3.602123905261823*^9, 3.60212396287712*^9}, {
   3.602129468740443*^9, 3.60212952645973*^9}, {3.602129564099886*^9, 
   3.602129570748266*^9}, {3.602209590700288*^9, 3.602209594731546*^9}, {
   3.6022096358722706`*^9, 3.6022096574035425`*^9}, {3.60220973488807*^9, 
   3.602209755184985*^9}, {3.602209800872573*^9, 3.6022098137944794`*^9}, {
   3.602209849794545*^9, 3.602209916794695*^9}, {3.602209996810458*^9, 
   3.6022100439199295`*^9}, {3.6022101002637825`*^9, 
   3.6022101680607924`*^9}, {3.602210203467112*^9, 3.6022102068108697`*^9}, {
   3.6022102595140967`*^9, 3.602210348779896*^9}, {3.602210380045582*^9, 
   3.602210387936222*^9}, {3.602210426389423*^9, 3.602210432280059*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"implicit", " ", "function", " ", "for", " ", "time"}], "-", 
    RowBox[{"based", " ", "passive", " ", "brachiation"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"\[Lambda]_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x0", ",", " ", "t", ",", " ", "M", ",", " ", "root", ",", " ", 
        "droot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x0", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"nlmap", "[", 
         RowBox[{"x0", ",", " ", "0", ",", " ", "t", ",", " ", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"root", " ", "=", " ", 
        RowBox[{"FixState", "[", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           " ", "-", " ", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"droot", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "-", " ", "dx0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "for", " ", "passive", " ", "we", " ", "only", " ", "want", " ", 
         "dxdx0", " ", "and", " ", "dxdt"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"also", " ", "return", " ", "eigenvalues"}], ",", " ", 
         RowBox[{"since", " ", 
          RowBox[{"it", "'"}], "ll", " ", "be", " ", "useful", " ", 
          "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"root", ",", " ", "droot", ",", " ", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"MatrixForm", " ", "/@", " ", 
     RowBox[{"root", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"x0", ",", " ", "t"}], "]"}], "]"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.5934312738149257`*^9, {3.5934313239727993`*^9, 3.5934314039413786`*^9}, {
   3.593431501535965*^9, 3.5934315847937355`*^9}, {3.5934316543377314`*^9, 
   3.5934316695945916`*^9}, {3.5934318135148335`*^9, 
   3.5934318196831827`*^9}, {3.5934326286674175`*^9, 3.593432634433052*^9}, {
   3.593549137398304*^9, 3.5935491461639643`*^9}, {3.59354921957034*^9, 
   3.593549235164121*^9}, 3.593549546569151*^9, {3.5935495822567225`*^9, 
   3.593549589819237*^9}, {3.5936179716430025`*^9, 3.593617974368159*^9}, {
   3.5936205097493544`*^9, 3.593620509857373*^9}, {3.593622967969387*^9, 
   3.593622968052394*^9}, 3.593624864144973*^9, {3.594050620289998*^9, 
   3.5940506480305896`*^9}, {3.59407564912844*^9, 3.59407566282322*^9}, {
   3.594079388578582*^9, 3.594079391150732*^9}, 3.5945158281561193`*^9, {
   3.5964550608207335`*^9, 3.5964550625707397`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dfdh", "[", 
    RowBox[{"x0_", ",", " ", "u_", ",", " ", "t_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q0", ",", " ", "dq0", ",", " ", "qimp", ",", " ", "x0imp", ",", " ", 
       "dx0imp", ",", " ", "b", ",", " ", "s", ",", " ", "df", ",", " ", "dh",
        ",", " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", "NLink`Private`nq"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q0", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], 
           "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dq0", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], 
           "}"}], ",", " ", 
          RowBox[{
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], 
           "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"df", " ", "=", " ", 
       RowBox[{"fcn", "[", 
        RowBox[{"0.", ",", " ", "q0", ",", " ", "dq0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"df", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"df", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"df", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"dq0", ",", " ", "df"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x0imp", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"PadLeft", "[", 
          RowBox[{
           RowBox[{"x0", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"n", "+", "2"}]}], "]"}], ",", " ", 
         RowBox[{"PadLeft", "[", 
          RowBox[{
           RowBox[{"x0", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{"n", "+", "2"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dx0imp", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"ArrayPad", "[", 
          RowBox[{
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"ArrayPad", "[", 
          RowBox[{
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"qimp", " ", "=", 
       RowBox[{"A", ".", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"x0imp", ",", " ", "dx0imp"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"3", ";;"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dh", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ".", 
            RowBox[{"x0", "\[LeftDoubleBracket]", 
             RowBox[{";;", "n"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"A", ".", 
             RowBox[{"dx0", "\[LeftDoubleBracket]", 
              RowBox[{";;", "n"}], "\[RightDoubleBracket]"}]}], ")"}], 
           "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dh", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"dh", ",", " ", "qimp"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"df", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"dh", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"df", ",", " ", "dh"}], "}"}], " ", "=", "  ", 
   RowBox[{"dfdh", "[", 
    RowBox[{"x0", ",", " ", "u0", ",", " ", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cost", "[", "s_Real", "]"}], " ", ":=", " ", 
    RowBox[{"Det", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dh", ".", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"df", " ", "s"}], "]"}]}], " ", "-", " ", 
       RowBox[{"dx0", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ")"}], "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"cost", "[", "s_Real", "]"}], " ", ":=", " ", 
     RowBox[{"Times", "@@", 
      RowBox[{"Abs", "@", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dh", ".", 
            RowBox[{"MatrixExp", "[", 
             RowBox[{"df", " ", "s"}], "]"}]}], " ", "-", " ", 
           RowBox[{"dx0", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ")"}], ",",
          " ", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "]"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"cost", "[", "s", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "1.2", ",", " ", "1.3"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.593720701905258*^9, 3.593720820952364*^9}, {
   3.5937208573586864`*^9, 3.593721007687105*^9}, {3.593721103124792*^9, 
   3.5937211136873093`*^9}, {3.593721164843659*^9, 3.5937211702030487`*^9}, {
   3.593721231468809*^9, 3.5937212562188544`*^9}, 3.593721290172046*^9, {
   3.593721323656475*^9, 3.593721450766097*^9}, {3.5937215103443336`*^9, 
   3.593721514984972*^9}, {3.593721547110035*^9, 3.593721564031944*^9}, {
   3.5937218375949774`*^9, 3.5937218376887293`*^9}, {3.5937219745952463`*^9, 
   3.5937219877202673`*^9}, {3.5937220378922453`*^9, 
   3.5937221581893535`*^9}, {3.5937221944550505`*^9, 3.593722229189494*^9}, {
   3.593722414689872*^9, 3.5937224149867353`*^9}, {3.5937224922056465`*^9, 
   3.5937225514401245`*^9}, {3.5937225816433077`*^9, 
   3.5937225848152027`*^9}, {3.5937226373934174`*^9, 
   3.5937226483778152`*^9}, {3.5937226977529106`*^9, 
   3.5937227178935747`*^9}, {3.593739325124157*^9, 3.5937393894055324`*^9}, {
   3.594050676032209*^9, 3.594050701359641*^9}, {3.594050745436165*^9, 
   3.594050903647225*^9}, {3.5940765653219037`*^9, 3.5940765859941053`*^9}, {
   3.5940792979193907`*^9, 3.5940793107591286`*^9}, {3.59408450357438*^9, 
   3.5940845489025917`*^9}, {3.5940846323715034`*^9, 3.594084658418431*^9}, {
   3.5941456428334846`*^9, 3.5941456448178625`*^9}, {3.5943865892402906`*^9, 
   3.5943866047715707`*^9}, {3.5943867067873955`*^9, 
   3.5943867178186674`*^9}, {3.594390102814003*^9, 3.594390243236044*^9}, {
   3.59439544554732*^9, 3.5943955582975397`*^9}, {3.594395794295252*^9, 
   3.594395814717167*^9}, {3.594395847748481*^9, 3.5943958839985523`*^9}, {
   3.594408898281626*^9, 3.594408986422424*^9}, {3.5944239488347893`*^9, 
   3.594423948944167*^9}, {3.594430141558792*^9, 3.5944301528556757`*^9}, {
   3.594430212715166*^9, 3.594430294215325*^9}, {3.5944371400575504`*^9, 
   3.5944372032920628`*^9}, {3.5944374625113077`*^9, 
   3.5944374775113497`*^9}, {3.5944375700584097`*^9, 3.594437589183429*^9}, {
   3.5944380304030457`*^9, 3.594438041106189*^9}, 3.594438704857486*^9, {
   3.5944707404014807`*^9, 3.5944707936485295`*^9}, {3.5944708743541512`*^9, 
   3.594470874497159*^9}, {3.5944712856297045`*^9, 3.5944712917000494`*^9}, {
   3.5945145732592583`*^9, 3.5945146423352156`*^9}, {3.594515710375377*^9, 
   3.594515735698827*^9}, {3.5953326757349586`*^9, 3.59533267595372*^9}, {
   3.5953365299754114`*^9, 3.595336531662924*^9}, {3.595337883149459*^9, 
   3.595337906493272*^9}, {3.59533897231487*^9, 3.5953389873930244`*^9}, {
   3.5953391237526655`*^9, 3.595339127221422*^9}, {3.5954477508442497`*^9, 
   3.595447799375594*^9}, {3.595448173973174*^9, 3.5954481801095257`*^9}, {
   3.5954492288060675`*^9, 3.5954492504779854`*^9}, {3.5955388622743626`*^9, 
   3.5955388643837414`*^9}, {3.595542749572239*^9, 3.595542756541005*^9}, {
   3.595547908890904*^9, 3.5955479107190337`*^9}, {3.595547977922291*^9, 
   3.5955480134223595`*^9}, {3.595549803604497*^9, 3.595549851401467*^9}, {
   3.5955498901671677`*^9, 3.595549950979786*^9}, {3.5955501244488745`*^9, 
   3.595550239058473*^9}, {3.5955503087617345`*^9, 3.595550346918078*^9}, {
   3.595551012122486*^9, 3.59555122638853*^9}, {3.5955512974824185`*^9, 
   3.5955514279045486`*^9}, {3.595551785139623*^9, 3.595551892483582*^9}, {
   3.5955522662811885`*^9, 3.5955522688593187`*^9}, {3.595552654781947*^9, 
   3.5955526791101246`*^9}, {3.5955527190008235`*^9, 3.595552850297955*^9}, {
   3.595552888157404*^9, 3.595552898969925*^9}, {3.5955531829704804`*^9, 
   3.595553214642418*^9}, {3.595553283111303*^9, 3.5955534016115336`*^9}, {
   3.5955917015527287`*^9, 3.595591736802808*^9}, {3.5955917937872753`*^9, 
   3.595591808506054*^9}, {3.5955918487873816`*^9, 3.595591854396767*^9}, {
   3.5955919660220065`*^9, 3.595592037428378*^9}, {3.5955928593329287`*^9, 
   3.595592973426898*^9}, {3.5955943385966825`*^9, 3.595594351839445*^9}, {
   3.5955944596506195`*^9, 3.5955944597646255`*^9}, {3.5955944916564703`*^9, 
   3.5955946065210295`*^9}, {3.5955949821775427`*^9, 
   3.5955949850187044`*^9}, {3.595595029999278*^9, 3.595595043362049*^9}, {
   3.5955952110046463`*^9, 3.59559521973415*^9}, {3.595595398666393*^9, 
   3.5955953994274364`*^9}, {3.5955954693864403`*^9, 3.595595474707766*^9}, 
   3.595595512066887*^9, {3.595595836974497*^9, 3.595595852734396*^9}, {
   3.595595993600466*^9, 3.595596001202916*^9}, {3.59559674390543*^9, 
   3.5955967810535755`*^9}, {3.5955984066616507`*^9, 
   3.5955984630448794`*^9}, {3.5955985195861173`*^9, 
   3.5955986245601377`*^9}, {3.595599018852706*^9, 3.5955990361106925`*^9}, {
   3.59559907649401*^9, 3.5955990826703644`*^9}, {3.5955991395606213`*^9, 
   3.5955993206389914`*^9}, 3.595599359952242*^9, {3.5955997682226195`*^9, 
   3.5955997685876427`*^9}, {3.5955998255759068`*^9, 
   3.5955998636840897`*^9}, {3.595605470873905*^9, 3.595605472737031*^9}, {
   3.595605844108759*^9, 3.5956058466087627`*^9}, {3.595631298876879*^9, 
   3.595631336517576*^9}, {3.5956366457034044`*^9, 3.5956366534534187`*^9}, {
   3.5956813235692234`*^9, 3.5956813473036456`*^9}, {3.5963124318407254`*^9, 
   3.5963124503117833`*^9}, {3.596422834836792*^9, 3.596422889208906*^9}, {
   3.5964229728386927`*^9, 3.5964229990121913`*^9}, {3.5990971072142515`*^9, 
   3.5990973496671333`*^9}, 3.5991764709453683`*^9, {3.5991765445905895`*^9, 
   3.5991765930313625`*^9}, {3.5991766560749702`*^9, 3.599176770417521*^9}, {
   3.599177375745186*^9, 3.5991773837686477`*^9}, {3.5993136659892483`*^9, 
   3.5993136843333006`*^9}, {3.5993156088225093`*^9, 
   3.5993156155068927`*^9}, {3.599315684857864*^9, 3.5993156867169704`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tol", " ", "=", " ", "Automatic"}], ";", 
  RowBox[{"10", "^", 
   RowBox[{"-", "8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"t", " ", "=", " ", 
  RowBox[{"Chop", "[", 
   RowBox[{"s", " ", "/.", " ", 
    RowBox[{"First", "[", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cost", "[", "s", "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"s", ",", " ", "1.2"}], "}"}], ",", " ", 
       RowBox[{"AccuracyGoal", "\[Rule]", "15"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "15"}], ",", " ", 
       RowBox[{"MaxIterations", "\[Rule]", "5000"}]}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullSpace", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"root", "[", 
        RowBox[{"Append", "[", 
         RowBox[{"x0", ",", " ", "t"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
       "2", "\[RightDoubleBracket]"}], ",", " ", 
      RowBox[{"Tolerance", "\[Rule]", "tol"}]}], "]"}], " ", "//", " ", 
    "Chop"}], " ", "//", " ", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"cost", "[", "t", "]"}]}], "Input",
 CellChangeTimes->{{3.593551215657552*^9, 3.5935513008344297`*^9}, {
   3.593551334527358*^9, 3.593551490641302*^9}, {3.5935515210690455`*^9, 
   3.5935515225991287`*^9}, {3.593551602901745*^9, 3.5935516036407747`*^9}, {
   3.593551679792136*^9, 3.5935516953780327`*^9}, {3.593612580912015*^9, 
   3.5936125990700336`*^9}, {3.5936170361974363`*^9, 
   3.5936170370054793`*^9}, {3.5936175285846314`*^9, 
   3.5936175287836447`*^9}, {3.5936206660443044`*^9, 
   3.5936206673993793`*^9}, {3.5936233250838356`*^9, 
   3.5936233254778576`*^9}, {3.5936235361309214`*^9, 
   3.5936235493946857`*^9}, {3.5936242980025516`*^9, 3.593624322975994*^9}, 
   3.593626646601051*^9, {3.59362672628262*^9, 3.593626727341673*^9}, 
   3.593709434563554*^9, {3.5937390869830637`*^9, 3.593739101233094*^9}, {
   3.5937392984366035`*^9, 3.5937393164678926`*^9}, {3.5937403285011206`*^9, 
   3.5937403546105604`*^9}, {3.593740552907818*^9, 3.5937406232204475`*^9}, {
   3.59405092608451*^9, 3.594050926950559*^9}, {3.594076038317727*^9, 
   3.5940760383487306`*^9}, {3.594076595132614*^9, 3.594076596167673*^9}, {
   3.5940793209017096`*^9, 3.594079321551746*^9}, {3.594084556246356*^9, 
   3.594084672605961*^9}, {3.5940847964812*^9, 3.5940848216218767`*^9}, {
   3.594145652286627*^9, 3.5941456523647876`*^9}, 3.5943902529455976`*^9, {
   3.594395828170331*^9, 3.5943958282953176`*^9}, {3.5943958629047604`*^9, 
   3.594395864576639*^9}, {3.5943959067017345`*^9, 3.594395921279877*^9}, {
   3.5944089957974415`*^9, 3.594409001109955*^9}, {3.5944241186944985`*^9, 
   3.594424168741475*^9}, {3.594424240397872*^9, 3.594424248007265*^9}, {
   3.594430170293208*^9, 3.594430203262025*^9}, {3.5944302756527863`*^9, 
   3.594430276605919*^9}, {3.594437226229597*^9, 3.594437228495224*^9}, {
   3.59443727851095*^9, 3.594437301714117*^9}, {3.594437365011116*^9, 
   3.594437366026746*^9}, {3.5944374858082294`*^9, 3.5944374926676154`*^9}, {
   3.59443752327705*^9, 3.5944375547927365`*^9}, {3.594437776277548*^9, 
   3.5944377852775645`*^9}, {3.5944380497155824`*^9, 3.5944380571687193`*^9}, 
   3.5953365414754314`*^9, {3.5953368836263185`*^9, 3.595336883704444*^9}, {
   3.595336927579531*^9, 3.5953369284701567`*^9}, {3.595338994189911*^9, 
   3.5953390192837133`*^9}, {3.595339070752561*^9, 3.5953391100807657`*^9}, {
   3.5953391442839575`*^9, 3.5953391982059507`*^9}, {3.5953392312372494`*^9, 
   3.5953392331278753`*^9}, {3.595340282834173*^9, 3.5953402994279556`*^9}, {
   3.59544777923493*^9, 3.595447833953805*^9}, {3.5954492593373575`*^9, 
   3.595449275446783*^9}, {3.595545919406066*^9, 3.595545920968568*^9}, {
   3.5955497751356907`*^9, 3.5955497854482117`*^9}, 3.5955511575758944`*^9, {
   3.5955528602354765`*^9, 3.59555286832924*^9}, 3.595553256204998*^9, {
   3.5955920572721663`*^9, 3.595592101194127*^9}, {3.595592136162945*^9, 
   3.5955921918661795`*^9}, {3.5955928292078667`*^9, 
   3.5955928438328915`*^9}, {3.595596261900828*^9, 3.5955962622188444`*^9}, 
   3.5955968122813497`*^9, {3.595596844102168*^9, 3.595596874146886*^9}, {
   3.59559705122303*^9, 3.595597052635129*^9}, {3.595597148519599*^9, 
   3.595597180905453*^9}, {3.5955972228678565`*^9, 3.595597224227936*^9}, {
   3.5955984760226192`*^9, 3.595598501420078*^9}, 3.5955985462686434`*^9, {
   3.595598642580179*^9, 3.5955986572860003`*^9}, {3.595598694626143*^9, 
   3.5955986947921505`*^9}, {3.5955989941302905`*^9, 
   3.5955990273871946`*^9}, {3.5955990654543953`*^9, 3.595599156159571*^9}, {
   3.595599218910166*^9, 3.5955992189861693`*^9}, {3.595599332197653*^9, 
   3.5955993384340096`*^9}, {3.595605520191727*^9, 3.595605520849764*^9}, {
   3.5956058578119226`*^9, 3.5956058703275566`*^9}, {3.5956313440175943`*^9, 
   3.5956313447675953`*^9}, {3.5956380767050524`*^9, 3.595638076767552*^9}, {
   3.596422897563384*^9, 3.596422897717393*^9}, {3.5964230114359055`*^9, 
   3.5964230115359087`*^9}, {3.596423049177064*^9, 3.596423059828676*^9}, {
   3.599097355953496*^9, 3.599097360289744*^9}, {3.5990974134977913`*^9, 
   3.5990974420484233`*^9}, {3.5991766015288625`*^9, 
   3.5991766286013985`*^9}, {3.599176675442079*^9, 3.5991766755700865`*^9}, {
   3.5991767427439337`*^9, 3.599176744277038*^9}, {3.5991767785819883`*^9, 
   3.599176786353435*^9}, {3.599177356870103*^9, 3.5991773704778876`*^9}, {
   3.5993137639458575`*^9, 3.5993137816568713`*^9}, {3.59931561969013*^9, 
   3.5993156771704197`*^9}, {3.6005698728507423`*^9, 3.6005699717864075`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", " ", "=", " ", "250"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "try", " ", "to", " ", "generate", " ", "m", " ", "points", " ", "on", 
     " ", "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"step", " ", "=", " ", 
     RowBox[{"1", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "root", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", " ", "=", " ", 
     RowBox[{"nlcurve", "[", 
      RowBox[{"\"\<nlsln\>\"", ",", " ", "nlc", ",", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "step", ",", " ", "m",
        ",", " ", 
       RowBox[{"Select", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Beep", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.5934312738149257`*^9, {3.5934313239727993`*^9, 3.5934314039413786`*^9}, {
   3.593431501535965*^9, 3.5934315847937355`*^9}, {3.5934316543377314`*^9, 
   3.5934316695945916`*^9}, {3.5934318135148335`*^9, 
   3.5934318196831827`*^9}, {3.5934326286674175`*^9, 3.5934326414643188`*^9}, 
   3.5937104030346975`*^9, {3.5937378262452602`*^9, 3.593737836354642*^9}, {
   3.593737943479853*^9, 3.5937379473392334`*^9}, {3.5937391694051003`*^9, 
   3.5937391715457335`*^9}, {3.593740669501786*^9, 3.5937406696736608`*^9}, {
   3.5937431966786156`*^9, 3.593743208288003*^9}, {3.5937468532289767`*^9, 
   3.5937468535883317`*^9}, 3.5937544448650475`*^9, {3.5940509685469418`*^9, 
   3.5940509687119513`*^9}, {3.5940749853282967`*^9, 3.594074991442649*^9}, 
   3.5940754266136923`*^9, 3.594075489214282*^9, 3.5940760634481664`*^9, {
   3.5940761753945956`*^9, 3.5940761755445867`*^9}, 3.59407648159113*^9, {
   3.594076647181591*^9, 3.5940766480116386`*^9}, {3.5940767999293413`*^9, 
   3.5940768075597973`*^9}, {3.594079344628063*^9, 3.5940793577558146`*^9}, {
   3.594079595908461*^9, 3.594079621475924*^9}, 3.5940848882157555`*^9, 
   3.5940856781214404`*^9, 3.5941456746304235`*^9, {3.5941457478493137`*^9, 
   3.5941457504899454`*^9}, 3.5941465800228148`*^9, {3.5941614532248907`*^9, 
   3.5941615144833803`*^9}, 3.5941822543180695`*^9, {3.5943906435609694`*^9, 
   3.5943906444730196`*^9}, {3.5943912110964704`*^9, 
   3.5943912197849655`*^9}, {3.594391280849465*^9, 3.5943912809214687`*^9}, {
   3.5943915679529037`*^9, 3.594391581944707*^9}, {3.5943922022342296`*^9, 
   3.5943922023372326`*^9}, 3.5943922543692155`*^9, {3.594395928592393*^9, 
   3.5943959949831467`*^9}, {3.594396148358459*^9, 3.594396148592822*^9}, {
   3.5943971498604045`*^9, 3.59439715009478*^9}, 3.5943975671330905`*^9, {
   3.5944243221636496`*^9, 3.594424412741949*^9}, {3.594430349309186*^9, 
   3.594430351637313*^9}, {3.5944304109030538`*^9, 3.5944304109968038`*^9}, {
   3.5944311669670315`*^9, 3.5944311941702137`*^9}, {3.5944312353421693`*^9, 
   3.594431236576543*^9}, {3.5944312952485356`*^9, 3.5944312978579164`*^9}, 
   3.594431343201754*^9, {3.594431392873727*^9, 3.594431398201873*^9}, 
   3.5944373809642773`*^9, {3.594437517605177*^9, 3.5944375184332933`*^9}, {
   3.5944376002459636`*^9, 3.594437605433461*^9}, {3.594437714011798*^9, 
   3.594437745699361*^9}, {3.59443817818458*^9, 3.5944381789345818`*^9}, {
   3.594438732795059*^9, 3.594438745076318*^9}, {3.594439185342802*^9, 
   3.5944392019365826`*^9}, 3.59443924178043*^9, {3.594439316046178*^9, 
   3.594439317280572*^9}, 3.594441337374674*^9, 3.595336938829552*^9, {
   3.595339732451311*^9, 3.5953397325294037`*^9}, {3.595339849279646*^9, 
   3.5953398499202614`*^9}, {3.595448146007573*^9, 3.595448146118575*^9}, {
   3.595449405498838*^9, 3.5954494061238422`*^9}, {3.5955459474529943`*^9, 
   3.595545980355884*^9}, {3.5955486721580243`*^9, 3.5955486729549017`*^9}, {
   3.5955923490539923`*^9, 3.5955923491633797`*^9}, {3.5955987223397255`*^9, 
   3.595598778590947*^9}, {3.595599887373446*^9, 3.595599912935907*^9}, 
   3.595605886796341*^9, {3.5956360956242065`*^9, 3.5956360956554546`*^9}, {
   3.595638447846403*^9, 3.595638449752658*^9}, {3.5956388605109777`*^9, 
   3.595638860675991*^9}, {3.5956810971156545`*^9, 3.5956811002563047`*^9}, {
   3.596290863118795*^9, 3.596290865040676*^9}, {3.5963127606315517`*^9, 
   3.5963127739513144`*^9}, {3.596313042378706*^9, 3.5963130433897657`*^9}, {
   3.596422741141423*^9, 3.5964227426875153`*^9}, {3.5964229508764505`*^9, 
   3.596422952483526*^9}, {3.596423094835685*^9, 3.5964230977028427`*^9}, {
   3.5964234826908937`*^9, 3.5964234877221785`*^9}, {3.596455154399045*^9, 
   3.596455166805317*^9}, {3.5990974842248383`*^9, 3.599097484608864*^9}, {
   3.599097905640993*^9, 3.599097909633203*^9}, 3.5991453628789625`*^9, 
   3.5991454675109735`*^9, {3.599176805290516*^9, 3.5991768056165333`*^9}, {
   3.5991768596286297`*^9, 3.5991768626647987`*^9}, {3.599178957477436*^9, 
   3.599178958930561*^9}, {3.599260729603588*^9, 3.599260730445636*^9}, {
   3.599261604209673*^9, 3.599261605300737*^9}, {3.599261987067598*^9, 
   3.5992619878536396`*^9}, {3.599266740866027*^9, 3.599266741980072*^9}, 
   3.599273492091628*^9, 3.5993156984896398`*^9, 3.5993159207463703`*^9, 
   3.600568977153548*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"DumpSave", "[", 
    RowBox[{"\"\<HumanWalker3D - 2.mx\>\"", ",", " ", "Z"}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.59644442436006*^9, 3.596444454188244*^9}, {
  3.5964777612567873`*^9, 3.5964777634959154`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"<<", "\"\<HumanWalker3D - 2.mx\>\""}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5964551373052588`*^9, 3.596455139727152*^9}, {
  3.599145766860094*^9, 3.599145768356184*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"scale", " ", "=", " ", 
    RowBox[{"2", " ", "torso"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idx", " ", "=", " ", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Z", "\[LeftDoubleBracket]", 
        RowBox[{"idx", ",", " ", "1", ",", 
         RowBox[{";;", "NLink`Private`nq"}]}], "\[RightDoubleBracket]"}], 
       "}"}], ",", " ", 
      RowBox[{
       RowBox[{"dx0", "\[LeftDoubleBracket]", 
        RowBox[{";;", "NLink`Private`nq"}], "\[RightDoubleBracket]"}], 
       "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dq0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Z", "\[LeftDoubleBracket]", 
        RowBox[{"idx", ",", " ", "1", ",", 
         RowBox[{
          RowBox[{"NLink`Private`nq", "+", "1"}], ";;", 
          RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"dx0", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"NLink`Private`nq", "+", "1"}], ";;"}], 
        "\[RightDoubleBracket]"}], "\[Transpose]"}]}], "]"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", " ", "=", " ", 
    RowBox[{"Z", "\[LeftDoubleBracket]", 
     RowBox[{"idx", ",", " ", "1", ",", 
      RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hw", " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "s"}], "}"}], ",", 
      RowBox[{"q", "/.", " ", 
       RowBox[{"First", "@", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
             RowBox[{"fcn", "[", 
              RowBox[{"s", ",", " ", 
               RowBox[{"q", "[", "s", "]"}], ",", " ", 
               RowBox[{
                RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", "q0"}], ",", 
            " ", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
             "dq0"}]}], "}"}], ",", " ", "q", ",", " ", 
          RowBox[{"{", 
           RowBox[{"s", ",", " ", "0", ",", " ", "t0"}], "}"}]}], "]"}]}]}]}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NLink`Private`DrawFigure2D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"hw", "[", "s", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
      "poi", ",", " ", 
      RowBox[{"VertexColors", "\[Rule]", " ", "colors"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"scale", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t0"}], "}"}], ",", " ", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5936502597032385`*^9, 3.593650354734676*^9}, {
   3.59365040942227*^9, 3.5936504231879187`*^9}, {3.5936504983911934`*^9, 
   3.593650607016403*^9}, 3.593650648813361*^9, {3.5937101704561152`*^9, 
   3.5937102031124287`*^9}, 3.593710304690752*^9, {3.5937103648158674`*^9, 
   3.593710366003374*^9}, 3.5937104180347238`*^9, 3.593711864646927*^9, {
   3.5937191201454916`*^9, 3.593719213036293*^9}, {3.5937193510834427`*^9, 
   3.5937194818649445`*^9}, {3.593719527005662*^9, 3.593719560552606*^9}, {
   3.593719606365192*^9, 3.593719662849677*^9}, {3.593738897217071*^9, 
   3.5937389031702085`*^9}, {3.5937412840186253`*^9, 3.593741310346793*^9}, {
   3.5937417821602116`*^9, 3.59374178398834*^9}, {3.5937420200356755`*^9, 
   3.593742022270053*^9}, {3.59374615994635*^9, 3.593746160399488*^9}, {
   3.5937462717434444`*^9, 3.5937463073685102`*^9}, {3.594081143804101*^9, 
   3.5940811469562807`*^9}, {3.59408119628611*^9, 3.5940812025594697`*^9}, {
   3.594081247477041*^9, 3.5940813011371107`*^9}, {3.5940825829768724`*^9, 
   3.5940826380238523`*^9}, {3.5940827154615197`*^9, 3.594082716024009*^9}, {
   3.594085167651691*^9, 3.5940851676829405`*^9}, {3.5940852178080378`*^9, 
   3.594085227245557*^9}, 3.594085305792586*^9, 3.5940854419803534`*^9, {
   3.594085509636735*^9, 3.5940855931212735`*^9}, {3.594146306756657*^9, 
   3.5941463171004314`*^9}, {3.594172814071966*^9, 3.594172814431339*^9}, 
   3.594173106431914*^9, 3.5944245930704284`*^9, {3.594440609873255*^9, 
   3.594440652123347*^9}, {3.5944410452022314`*^9, 3.594441102046089*^9}, {
   3.595337058804098*^9, 3.595337114382332*^9}, {3.5953372458825893`*^9, 
   3.5953372461013427`*^9}, {3.59533729047643*^9, 3.5953372991326942`*^9}, {
   3.595546125793668*^9, 3.5955461346686845`*^9}, {3.595546851591962*^9, 
   3.595546862170109*^9}, {3.5955468928732934`*^9, 3.595546914560837*^9}, {
   3.5955964339736814`*^9, 3.5955964398120155`*^9}, {3.59563186201683*^9, 
   3.5956318632043333`*^9}, {3.5956360558741283`*^9, 3.595636060436634*^9}, {
   3.595636121093004*^9, 3.5956361617805815`*^9}, {3.595638184799013*^9, 
   3.595638185517769*^9}, {3.5956382787992105`*^9, 3.595638280658577*^9}, {
   3.595681158256401*^9, 3.5956811782876887`*^9}, {3.5963014097097607`*^9, 
   3.5963014598660994`*^9}, {3.5963015139130697`*^9, 
   3.5963015588194113`*^9}, {3.596301812491787*^9, 3.596301815726165*^9}, {
   3.5964233005554624`*^9, 3.5964233187265177`*^9}, {3.5964233772418537`*^9, 
   3.596423377499869*^9}, {3.596444654141754*^9, 3.5964446541730056`*^9}, {
   3.596444718032507*^9, 3.596444718626259*^9}, {3.5990975983113728`*^9, 
   3.599097615375353*^9}, {3.599148742177657*^9, 3.5991487422401705`*^9}, {
   3.599149597907488*^9, 3.5991495993935566`*^9}, {3.599160932789585*^9, 
   3.599160946827389*^9}, {3.599315868952405*^9, 3.5993158695074387`*^9}, {
   3.6005698175845766`*^9, 3.6005698287362156`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<q[0]\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q0", " ", "=", " ", 
   RowBox[{
    RowBox[{"hw", "[", "0", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", " ", "=", " ", 
   RowBox[{
    RowBox[{"NLink`Private`DrawFigure2D", "[", 
     RowBox[{"q0", ",", " ", "poi", ",", " ", 
      RowBox[{"VertexColors", "\[Rule]", " ", "colors"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"scale", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<q[t0]\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"q0", " ", "=", " ", 
   RowBox[{
    RowBox[{"hw", "[", "t0", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g6", " ", "=", " ", 
   RowBox[{
    RowBox[{"NLink`Private`DrawFigure2D", "[", 
     RowBox[{"q0", ",", " ", "poi", ",", " ", 
      RowBox[{"VertexColors", "\[Rule]", " ", "colors"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"scale", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<q[0] & q[t0]\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"g2", ",", "g6", ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.595638353611842*^9, 3.5956383586743526`*^9}, {
   3.5956799332445717`*^9, 3.59567994143209*^9}, 3.595680031104138*^9, {
   3.595680522151986*^9, 3.5956805986989965`*^9}, {3.595680727418003*^9, 
   3.5956807384180193`*^9}, {3.595680920496501*^9, 3.5956810023404117`*^9}, {
   3.596301923679496*^9, 3.596302023335943*^9}, {3.5963020582891345`*^9, 
   3.596302068414152*^9}, {3.596423354112529*^9, 3.5964233608069124`*^9}, {
   3.5964233943028307`*^9, 3.5964233982460527`*^9}, {3.5990976929947977`*^9, 
   3.5990977721973333`*^9}, {3.599178895789816*^9, 3.599178896789834*^9}, {
   3.599261277025936*^9, 3.5992612794430723`*^9}}],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NLink`Private`DrawFigure2D", "[", 
     RowBox[{
      RowBox[{"Z", "\[LeftDoubleBracket]", 
       RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", "poi", 
      ",", " ", 
      RowBox[{"VertexColors", "\[Rule]", " ", "colors"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"scale", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "Z"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593629141293112*^9, 3.59362915368375*^9}, {
   3.593629236574534*^9, 3.5936292694964714`*^9}, {3.5936293309965944`*^9, 
   3.593629369387295*^9}, {3.5936295205594635`*^9, 3.5936297229661107`*^9}, {
   3.593629768044335*^9, 3.5936297814037256`*^9}, {3.5936315800166283`*^9, 
   3.5936315822353725`*^9}, {3.5936316296261024`*^9, 
   3.5936316327042313`*^9}, {3.5936475918698835`*^9, 
   3.5936476782606907`*^9}, {3.5936477657608614`*^9, 3.593647780260877*^9}, {
   3.593647823479714*^9, 3.5936478306203527`*^9}, {3.5936478685422993`*^9, 
   3.59364795591747*^9}, {3.5936480667770615`*^9, 3.593648069370819*^9}, {
   3.5936481948398113`*^9, 3.5936482243242636`*^9}, {3.593648388730816*^9, 
   3.593648469871599*^9}, {3.5936485151060762`*^9, 3.5936485176373177`*^9}, {
   3.5936486107937536`*^9, 3.5936486877939167`*^9}, {3.593648956950679*^9, 
   3.5936489940132513`*^9}, 3.593649145919797*^9, {3.5936492491387486`*^9, 
   3.593649253795024*^9}, {3.593649293904461*^9, 3.5936492941075864`*^9}, {
   3.5936493481389427`*^9, 3.593649351560824*^9}, {3.5936494112796917`*^9, 
   3.5936494262953444`*^9}, {3.593649462076665*^9, 3.593649471342308*^9}, {
   3.5936495775925183`*^9, 3.593649583061277*^9}, {3.5936496361082573`*^9, 
   3.5936496474207907`*^9}, {3.5936497471397247`*^9, 
   3.5936497843585496`*^9}, {3.59364981974924*^9, 3.593649851249304*^9}, {
   3.593649926890087*^9, 3.593649999515216*^9}, {3.593650133593603*^9, 
   3.5936501858749547`*^9}, {3.5936502284688206`*^9, 3.593650236015681*^9}, {
   3.593710217237457*^9, 3.5937102726125636`*^9}, 3.593725119424674*^9, {
   3.594053869114047*^9, 3.59405387095415*^9}, {3.5940539641384897`*^9, 
   3.594054029480228*^9}, {3.5940794610867558`*^9, 3.5940795085884714`*^9}, {
   3.594085911632182*^9, 3.5940859210384517`*^9}, {3.59414571258362*^9, 
   3.5941457163180094`*^9}, {3.5944245676641283`*^9, 
   3.5944245808516545`*^9}, {3.594428710790354*^9, 3.594428729868518*^9}, {
   3.5953400362956247`*^9, 3.5953400561081643`*^9}, {3.59534009624006*^9, 
   3.5953401045994525`*^9}, {3.59554675073239*^9, 3.5955467568261538`*^9}, {
   3.595546885701413*^9, 3.595546887935783*^9}, {3.595546924185853*^9, 
   3.5955469304671173`*^9}, {3.595605952733533*^9, 3.595605957639789*^9}, {
   3.5956360810773005`*^9, 3.595636084608556*^9}, {3.5956811352094817`*^9, 
   3.595681136850108*^9}, {3.5963021250548935`*^9, 3.5963021688206043`*^9}, {
   3.5964234219264097`*^9, 3.5964234257446313`*^9}, {3.5991619049232254`*^9, 
   3.5991619294646306`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x", "=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "/", 
           RowBox[{
            RowBox[{"hw", "[", "\"\<Domain\>\"", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"hw", "[", "s", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", 
         RowBox[{
          RowBox[{"hw", "[", "\"\<Coordinates\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lengths", "=", 
    RowBox[{"{", 
     RowBox[{"leg", ",", 
      RowBox[{"-", "leg"}], ",", "torso", ",", 
      RowBox[{"-", "arm"}], ",", 
      RowBox[{"-", "arm"}]}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"q2p", "[", "q_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "p", "}"}], ",", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{
         RowBox[{"NLink`Private`GetPoints", "[", "q", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"A0", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ".", "q"}], ",", 
             RowBox[{"lengths", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "NLink`Private`nq"}], "}"}]}], "]"}]}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{
    RowBox[{"NLink`Private`GetPointsAndLines", "[", 
     RowBox[{
      RowBox[{"x", "[", "0", "]"}], ",", "poi"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"n", "+", "1"}], ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/", 
      RowBox[{"z", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"MotionBlur", "[", 
    RowBox[{"x", ",", "q2p", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"z", "&"}], ",", 
     RowBox[{"\"\<stepsize\>\"", "\[Rule]", 
      RowBox[{"1", "/", "3"}]}], ",", 
     RowBox[{"\"\<radius\>\"", "\[Rule]", 
      RowBox[{"1", "/", "28"}]}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", "0.6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1.3"}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.600569604315363*^9, 3.6005696343670845`*^9}, 
   3.6005696749444094`*^9, 3.6005697402491436`*^9, {3.600569775094158*^9, 
   3.600569785412734*^9}}],

Cell[CellGroupData[{

Cell[BoxData["NLink`Private`bodies"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2", ",", "5"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6026018101511087`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"conchild", " ", "=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Drop", "@", 
      RowBox[{"Rest", "[", 
       RowBox[{"NLink`Private`GetPath", "[", 
        RowBox[{
         RowBox[{"NLink`Private`nca", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}],
        "]"}]}], "&"}], ",", " ", "NLink`Private`bodies"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6025479240976315`*^9, {3.602547973347345*^9, 3.6025479834759254`*^9}, {
   3.602548019482987*^9, 3.602548021445117*^9}, {3.602548059375272*^9, 
   3.602548094352276*^9}, {3.6025481312023845`*^9, 3.6025481362436733`*^9}, {
   3.60254862526259*^9, 3.60254866259173*^9}, {3.60254869838978*^9, 
   3.602548783286639*^9}, {3.602548830427342*^9, 3.60254885468775*^9}, {
   3.602548961142827*^9, 3.602548962484905*^9}, 3.6025490247144675`*^9, {
   3.6025490626736608`*^9, 3.602549075147353*^9}, {3.6025491234681225`*^9, 
   3.602549344272765*^9}, {3.6025493881222787`*^9, 3.6025493918264914`*^9}, {
   3.602549603112591*^9, 3.602549610573018*^9}, {3.6025936763227654`*^9, 
   3.6025936931665497`*^9}, {3.6025951491693945`*^9, 
   3.6025951495912714`*^9}, {3.602599225833617*^9, 3.602599228442998*^9}, {
   3.6026010635715213`*^9, 3.6026010730871644`*^9}, {3.6026016569008265`*^9, 
   3.6026019815108185`*^9}, 3.6026020199952655`*^9, {3.6026047401568384`*^9, 
   3.6026047485787296`*^9}, {3.602606213550357*^9, 3.602606219409727*^9}, {
   3.602610102601781*^9, 3.6026101035861454`*^9}, {3.602610202367588*^9, 
   3.6026102188832417`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6026047490943527`*^9, 3.6026062217066126`*^9, 
  3.602610104179897*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Josim1", "[", 
     RowBox[{"i_", ",", " ", "a_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", " ", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", 
        RowBox[{"bodies", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"current", " ", "body"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"Xba", "[", 
         RowBox[{"pcons", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "position", " ", "of", " ", "constraint", " ", "in", " ", "body", " ",
          "i"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "bring", " ", "all", " ", "bodies", " ", "on", " ", "the", " ", 
         "path", " ", "from", " ", "a", " ", "to", " ", "body", " ", "i"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"into", " ", "body", " ", 
         RowBox[{"i", "'"}], "s", " ", 
         RowBox[{"coord", ".", " ", "sys", ".", " ", "and"}], " ", "compute", 
         " ", 
         RowBox[{"J", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", " ", "All"}], "\[RightDoubleBracket]"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"j", " ", "\[NotEqual]", " ", "a"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"J", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}], " ", "=",
            " ", 
           RowBox[{
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], ".", 
            "X", ".", 
            RowBox[{
            "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"X", " ", "=", " ", 
           RowBox[{"X", ".", 
            RowBox[{
            "XL", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{
           "parent", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "X"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Josim2", "[", 
    RowBox[{"i_", ",", " ", "Xa_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", " ", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", 
       RowBox[{"bodies", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", " ", "2"}], "\[RightDoubleBracket]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"current", " ", "body"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"X", " ", "=", " ", 
       RowBox[{"InvXab", "[", "Xa", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"transform", " ", "from", " ", 
        RowBox[{"bodies", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], " ", "to", 
        " ", "a"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "bring", " ", "all", " ", "bodies", " ", "on", " ", "the", " ", "path",
         " ", "from", " ", "a", " ", "to", " ", "body", " ", "j"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"into", " ", 
        RowBox[{
         RowBox[{"bodies", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], "'"}], "s",
         " ", 
        RowBox[{"coord", ".", " ", "sys", ".", " ", "and"}], " ", "compute", 
        " ", 
        RowBox[{"J", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", " ", "All"}], "\[RightDoubleBracket]"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", " ", "=", " ", 
          RowBox[{"X", ".", 
           RowBox[{"InvXba", "[", 
            RowBox[{
            "XL", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"J", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], " ", "=", 
          " ", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], ".", 
            "X", ".", 
            RowBox[{
            "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}],
          ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", 
          RowBox[{
          "conchild", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"X", " ", "=", " ", 
       RowBox[{"X", ".", 
        RowBox[{"InvXba", "[", 
         RowBox[{
          RowBox[{"Xba", "[", 
           RowBox[{"pcons", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", "2"}], "\[RightDoubleBracket]"}], "]"}], 
          ".", 
          RowBox[{
          "XL", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"J", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}], " ", "=", 
       " ", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"r", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}], ".", "X", 
         ".", 
         RowBox[{
         "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6025479240976315`*^9, {3.602547973347345*^9, 3.6025479834759254`*^9}, {
   3.602548019482987*^9, 3.602548021445117*^9}, {3.602548059375272*^9, 
   3.602548094352276*^9}, {3.6025481312023845`*^9, 3.6025481362436733`*^9}, {
   3.60254862526259*^9, 3.60254866259173*^9}, {3.60254869838978*^9, 
   3.602548783286639*^9}, {3.602548830427342*^9, 3.60254885468775*^9}, {
   3.602548961142827*^9, 3.602548962484905*^9}, 3.6025490247144675`*^9, {
   3.6025490626736608`*^9, 3.602549075147353*^9}, {3.6025491234681225`*^9, 
   3.602549344272765*^9}, {3.6025493881222787`*^9, 3.6025493918264914`*^9}, {
   3.602549603112591*^9, 3.602549610573018*^9}, {3.6025936763227654`*^9, 
   3.6025936931665497`*^9}, {3.6025951491693945`*^9, 
   3.6025951495912714`*^9}, {3.602599225833617*^9, 3.602599228442998*^9}, {
   3.6026010635715213`*^9, 3.6026010730871644`*^9}, {3.6026016569008265`*^9, 
   3.6026019497920027`*^9}, {3.602602028635908*^9, 3.602602029417159*^9}, 
   3.602602059620345*^9, {3.602602105854808*^9, 3.602602115495468*^9}, {
   3.602602157714285*^9, 3.6026022076050076`*^9}, {3.602602270745762*^9, 
   3.6026024095741525`*^9}, {3.6026025120587273`*^9, 
   3.6026027195278826`*^9}, {3.602602765887352*^9, 3.6026027689811087`*^9}, {
   3.602602805496804*^9, 3.6026028798719516`*^9}, {3.6026029418251896`*^9, 
   3.602602989356537*^9}, {3.602603073559827*^9, 3.602603154341237*^9}, 
   3.602603304732156*^9, {3.602603395513595*^9, 3.602603496966905*^9}, {
   3.6026035513264008`*^9, 3.60260358718583*^9}, {3.602603634420314*^9, 
   3.602603646498466*^9}, {3.602603758998663*^9, 3.6026039668428216`*^9}, {
   3.6026040154210434`*^9, 3.6026041702807207`*^9}, 3.602604200608905*^9, {
   3.602604242468362*^9, 3.602604388734274*^9}, {3.6026044334531116`*^9, 
   3.602604565984619*^9}, {3.602604769610032*^9, 3.6026047958756943`*^9}, {
   3.6026048520164275`*^9, 3.6026048576883183`*^9}, {3.602604905329034*^9, 
   3.602604929422844*^9}, {3.6026049912667017`*^9, 3.6026049930948353`*^9}, 
   3.602605338423628*^9, {3.602605428564431*^9, 3.6026054296269364`*^9}, {
   3.6026058971122227`*^9, 3.602605971956122*^9}, {3.6026060025343046`*^9, 
   3.602606002799929*^9}, {3.6026077814253535`*^9, 3.6026077886128674`*^9}, {
   3.6026078798474216`*^9, 3.6026079122693596`*^9}, 3.6026079448475485`*^9, {
   3.6026080585977697`*^9, 3.6026080821290655`*^9}, {3.602608221457464*^9, 
   3.6026082266293488`*^9}, {3.602608309598262*^9, 3.6026083680671263`*^9}, {
   3.6026084069890757`*^9, 3.6026084264422417`*^9}, {3.6026084831767464`*^9, 
   3.6026084832548513`*^9}, {3.6026085800675397`*^9, 
   3.6026085867394295`*^9}, {3.6026086702239666`*^9, 
   3.6026086725989704`*^9}, {3.6026087191459374`*^9, 3.602608792833581*^9}, {
   3.6026088296305285`*^9, 3.6026088910993977`*^9}, {3.6026089349588594`*^9, 
   3.6026089353338623`*^9}, {3.602609087521658*^9, 3.6026090890529137`*^9}, {
   3.602609217084412*^9, 3.6026092487407207`*^9}, {3.602609379319106*^9, 
   3.602609507522478*^9}, {3.602609549413187*^9, 3.602609615694566*^9}, {
   3.6026096553352685`*^9, 3.6026097556792145`*^9}, {3.602609790616784*^9, 
   3.6026098328356304`*^9}, {3.602609887163847*^9, 3.602609889085725*^9}, {
   3.602610012523466*^9, 3.6026100624298143`*^9}, {3.6026122303342133`*^9, 
   3.60261230731874*^9}, {3.602612430709607*^9, 3.602612432615862*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.602601725229065*^9, 3.6026017325259576`*^9}, {
  3.602601784635436*^9, 3.6026018459324303`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "4", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{{3.602601725229065*^9, 3.6026017325259576`*^9}, {
  3.602601784635436*^9, 3.6026018459324303`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bodies", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<rz\>\"", ",", " ", "\"\<rz\>\"", ",", " ", "\"\<rz\>\"", ",", " ", 
     "\"\<rz\>\"", ",", " ", "\"\<rz\>\"", ",", " ", "\"\<rz\>\"", ",", " ", 
     "\"\<rz\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parent", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", " ", "1", ",", " ", "0", ",", " ", "1", ",", " ", "4", ",", " ",
      "5", ",", " ", "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NLink`Private`ExpandTree", "[", 
  RowBox[{"bodies", ",", " ", "parent", ",", " ", 
   RowBox[{"{", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NLink`Private`nca", " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"TreePlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "NLink`Private`parent", "\[LeftDoubleBracket]", "i", 
       "\[RightDoubleBracket]"}], "\[Rule]", " ", "i"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "NLink`Private`nq"}], "}"}]}], "]"}], ",", " ", 
   "Automatic", ",", " ", "0", ",", " ", 
   RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.602552539963544*^9, 3.602552613613763*^9}, {
  3.6025527051920013`*^9, 3.6025527136264877`*^9}, {3.6025528963069477`*^9, 
  3.6025529115388203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Josim", "[", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "X", ",", " ", "j", ",", " ", "a", ",", " ", "bi", ",", " ", "bj"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bi", ",", " ", "bj"}], "}"}], " ", "=", " ", 
          RowBox[{
          "bodies", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bi", " ", "\[Equal]", " ", "0"}], " ", "||", " ", 
             RowBox[{"bj", " ", "\[Equal]", " ", "0"}]}], ",", " ", "0", ",", 
            " ", 
            RowBox[{"nca", "\[LeftDoubleBracket]", 
             RowBox[{"bi", ",", " ", "bj"}], "\[RightDoubleBracket]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"j", " ", "=", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"k", " ", "\[Equal]", " ", "1"}], ",", " ", "bi", ",", 
               " ", "bj"}], "]"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"current", " ", "body"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"X", " ", "=", " ", "I6"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "transform", " ", "from", " ", "parent", " ", "to", " ", 
              "child"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "now", " ", "bring", " ", "all", " ", "bodies", " ", "on", " ", 
              "the", " ", "path", " ", "from", " ", "a", " ", "to", " ", 
              "body", " ", "j"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"into", " ", "body", " ", 
              RowBox[{"j", "'"}], "s", " ", 
              RowBox[{"coord", ".", " ", "sys", ".", " ", "and"}], " ", 
              "compute", " ", 
              RowBox[{"J", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", " ", "All"}], "\[RightDoubleBracket]"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"j", " ", "\[NotEqual]", " ", "a"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"J", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}], " ",
                 "=", " ", 
                RowBox[{
                 RowBox[{"r", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], 
                 ".", "X", ".", 
                 RowBox[{
                 "s", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}]}], ";", "  ", 
               RowBox[{"(*", " ", 
                RowBox[{"compute", " ", 
                 RowBox[{"body", "'"}], "s", " ", "Jacobian"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"X", " ", "=", " ", 
                RowBox[{"X", ".", 
                 RowBox[{
                 "XL", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}]}], ";", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "transform", " ", "from", " ", "parent", " ", "to", " ", 
                 "child"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"j", " ", "=", " ", 
                RowBox[{
                "parent", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], ";"}]}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{"parent", " ", "node"}], " ", "*)"}], 
             "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"k", ",", " ", "2"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "mb"}], "}"}]}], "\[IndentingNewLine]", "]"}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6026125147097826`*^9, 3.602612578959895*^9}, {
   3.6026126686788206`*^9, 3.602612678928854*^9}, {3.6026127623941536`*^9, 
   3.6026128081127663`*^9}, {3.6026128640399733`*^9, 3.602612899531006*^9}, {
   3.602612989556162*^9, 3.602613089813903*^9}, 3.6026132031933956`*^9, 
   3.602613275324545*^9, {3.6026135307481537`*^9, 3.6026135989230576`*^9}, {
   3.60261366392178*^9, 3.602613694103509*^9}, {3.602613763020455*^9, 
   3.602613763394477*^9}, {3.6026138162225018`*^9, 3.6026138303703256`*^9}, 
   3.602613871479662*^9, {3.6026139158692074`*^9, 3.6026139353533244`*^9}, {
   3.6026140116937017`*^9, 3.6026140234193673`*^9}, {3.602614197608342*^9, 
   3.6026141979223585`*^9}, {3.602614242321904*^9, 3.6026142509323936`*^9}, {
   3.6026143067036037`*^9, 3.6026143320800433`*^9}}]
},
WindowSize->{729, 546},
WindowMargins->{{40, Automatic}, {38, Automatic}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 985, 24, 132, "Input"],
Cell[1545, 46, 10639, 168, 332, "Input"],
Cell[CellGroupData[{
Cell[12209, 218, 10009, 149, 192, "Input"],
Cell[22221, 369, 1532, 31, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23790, 405, 7426, 168, 272, "Input"],
Cell[31219, 575, 1865, 41, 62, "Output"]
}, Open  ]],
Cell[33099, 619, 20528, 390, 992, "Input"],
Cell[CellGroupData[{
Cell[53652, 1013, 2106, 38, 112, "Input"],
Cell[55761, 1053, 2906, 74, 116, "Output"],
Cell[58670, 1129, 2904, 74, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61611, 1208, 143, 4, 72, "Input"],
Cell[61757, 1214, 292, 9, 31, "Output"],
Cell[62052, 1225, 722, 21, 52, "Output"]
}, Open  ]],
Cell[62789, 1249, 3271, 84, 312, "Input"],
Cell[CellGroupData[{
Cell[66085, 1337, 2708, 65, 172, "Input"],
Cell[68796, 1404, 1930, 41, 72, "Output"]
}, Open  ]],
Cell[70741, 1448, 11762, 244, 612, "Input"],
Cell[82506, 1694, 18727, 412, 1132, "Input"],
Cell[101236, 2108, 8078, 146, 192, "Input"],
Cell[109317, 2256, 5682, 129, 352, "Input"],
Cell[115002, 2387, 3645, 79, 272, "Input"],
Cell[118650, 2468, 12802, 266, 552, "Input"],
Cell[131455, 2736, 5650, 94, 172, "Input"],
Cell[137108, 2832, 5328, 85, 152, "Input"],
Cell[142439, 2919, 283, 7, 31, "Input"],
Cell[142725, 2928, 233, 5, 31, "Input"],
Cell[142961, 2935, 6621, 141, 372, "Input"],
Cell[149585, 3078, 2778, 69, 252, "Input"],
Cell[152366, 3149, 3380, 59, 72, "Input"],
Cell[155749, 3210, 3633, 110, 292, "Input"],
Cell[CellGroupData[{
Cell[159407, 3324, 46, 0, 31, "Input"],
Cell[159456, 3326, 141, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159634, 3335, 1882, 36, 92, "Input"],
Cell[161519, 3373, 190, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161746, 3383, 9636, 197, 552, "Input"],
Cell[171385, 3582, 147, 2, 31, "Output"],
Cell[171535, 3586, 202, 4, 31, "Output"]
}, Open  ]],
Cell[171752, 3593, 1383, 33, 132, "Input"],
Cell[173138, 3628, 5214, 111, 372, "Input"]
}
]
*)

(* End of internal cache information *)
