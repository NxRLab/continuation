(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     95539,       2437]
NotebookOptionsPosition[     92904,       2345]
NotebookOutlinePosition[     93301,       2362]
CellTagsIndexPosition[     93258,       2359]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"ContinuationMethods", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
     "An", " ", "implementation", " ", "of", " ", "various", " ", 
      "continuation", " ", 
      RowBox[{"methods", ".", "\n", "Copyright"}], " ", 
      RowBox[{"(", "C", ")"}], " ", "2014", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103715538125486`*^9, 3.6103716079966354`*^9}, {
  3.6103717337958384`*^9, 3.6103717435163946`*^9}, {3.610375905814865*^9, 
  3.6103759286701736`*^9}}],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<ContinuationMethods`\>\"", "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlmap", "::", "usage"}], " ", "=", " ", 
   "\"\<nlmap[x0, u, t] integrates from x0 to x(t) with constant torque \
u.\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlroot", "::", "usage"}], " ", "=", " ", 
   "\"\<nlroot[f] sets the implicit function for nlc0 and nlc when generating \
points on the curve defined by f[\[Lambda]] = 0.  If it is a custom function, \
then it must be of the form f[\[Lambda]] and must return a list containing \
values for f,  its derivative df/d\[Lambda], and the eigenvalues of \
dH(x(t))/dx0.  There are string values of f that will return a predefined \
implicit function.  The string values for type are: \npt --passive time-based \
roots\nat --actuated time-based roots\npe --passive event-based roots\nae \
--actuated event-based roots\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlc0", "::", "usage"}], " ", "=", " ", 
   "\"\<nlc0[\[Lambda], h] returns the initial list that should be passed to \
the function nlc when generating the solution curve of f (set by \
nlroot).\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlc", "::", "usage"}], " ", "=", " ", 
   "\"\<nlc[c0] returns the next point, c1, on the curve of roots belonging \
to f (set by nlroot).\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlac", "::", "usage"}], " ", "=", " ", 
   "\"\<nlac[c0] returns the next point, c1, on the curve of roots belonging \
to f (set by nlroot) using an adaptive step length.\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nle", "::", "usage"}], " ", "=", " ", 
   "\"\<nle[c0] calculates the next point, c1, on the 1-D curve of points \
that are roots of f (set by nlroot) using an embedding algorithm.\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlcurve", "::", "usage"}], " ", "=", " ", 
   "\"\<nlcurve[name, c, \[Lambda], h, m] using method c calculates a 1D \
curve of m points that are roots of f (set by nlroot) starting with the root \
at (x0, T) with a step size of h.  name is an arbitrary tag associated with \
the function call.  Any of the curve functions, nlc, nlac, or nle are valid \
for c.\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlparcurve", "::", "usage"}], " ", "=", " ", 
   "\"\<nlparcurve[name, c, \[Lambda], h, m] using method c calculates a 1D \
curve of m points that are roots of f (set by nlroot) starting with the root \
at (x0, t) in parallel by taking step sizes that are multiples of 2 (in the \
future this should be the number of cores in the system).  name is an \
arbitrary tag associated with the function call.  Any of the curve functions, \
nlc, nlac, or nle are valid for c.  The parallel environment has to be setup \
appropriately, e.g., ParallelNeeds[\\\"TwoLinks`\\\"], for this function to \
work.\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.593429691613509*^9, 3.5934296991603985`*^9}, {
   3.5934304492147074`*^9, 3.593430460293337*^9}, {3.593430598468252*^9, 
   3.5934306015764303`*^9}, {3.5934307799096446`*^9, 3.593430808052258*^9}, {
   3.604003954825133*^9, 3.6040039601376452`*^9}, 3.604015318567862*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["private data", "Section",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "global", " ", "variables", " ", "in", " ", "this", " ", "package"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", " ", "=", " ", "root1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stopping", " ", "criterions", " ", "for", " ", 
     RowBox[{"Newton", "'"}], "s", " ", "method"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rtol", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "8"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "stop", " ", "if", " ", "step", " ", "size", " ", "is", " ", "really", 
      " ", "small"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"atol", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "8"}]}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "stop", " ", "if", " ", "root", " ", "is", " ", "really", " ", "good"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ftol", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "5"}]}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "reject", " ", "if", " ", "root", " ", "is", " ", "really", " ", "bad"}],
      " ", "*)"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5934299275670958`*^9, 3.593429929129596*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example nlmap", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.593429863957615*^9, 3.5934298658013515`*^9}, 
   3.593430810778412*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "nlmap", "]"}], " ", "=", " ", 
     RowBox[{"Options", "[", "\[CurlyPhi]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"nlmap", "[", 
    RowBox[{"x0_", ",", " ", "u_", ",", " ", "t_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x\[Xi]", ",", " ", "\[Tau]f"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initial", " ", "condition", " ", "for", " ", "x", 
       RowBox[{"(", "0", ")"}], " ", "and", " ", "\[Xi]", 
       RowBox[{"(", "0", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"x\[Xi]0", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
       "x0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solve", " ", "for", " ", "x", 
         RowBox[{"(", "t", ")"}]}], ",", " ", 
        RowBox[{"dx", 
         RowBox[{
          RowBox[{"(", "t", ")"}], "/", "dx0"}]}], ",", " ", 
        RowBox[{"dx", 
         RowBox[{
          RowBox[{"(", "t", ")"}], "/", "dt"}]}], ",", " ", 
        RowBox[{"and", " ", "dx", 
         RowBox[{
          RowBox[{"(", "t", ")"}], "/", "du"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Tau]f", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "EventHandler", "]"}], ",", " ", 
         "dtd\[Lambda]", ",", " ", "\[Tau]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\[CurlyPhi]", " ", "has", " ", "same", " ", "options", " ", "as", " ",
         "NDSolve"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"x\[Xi]", " ", "=", " ", 
       RowBox[{"\[CurlyPhi]", "[", 
        RowBox[{"x\[Xi]0", ",", " ", 
         RowBox[{
          RowBox[{"(", "u", ")"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "t"}], "}"}], ",", " ", "\[Mu]", ",", 
         "\[Tau]f", ",", " ", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"now", " ", "impact"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"x\[Xi]", " ", "=", " ", 
       RowBox[{"H", "[", "x\[Xi]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "extract", " ", "final", " ", "state", " ", "and", " ", 
        "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x\[Xi]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"x\[Xi]", "\[LeftDoubleBracket]", 
           RowBox[{"5", ";;", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", " ", "n"}], 
         "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.593430811623461*^9, 3.593430812253495*^9}, {
  3.596298565631711*^9, 3.596298568069216*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.6587267938894797", ",", "1.9749754705416689", ",", 
       RowBox[{"-", "0.10807888048962308"}], ",", "0.4115170127117205"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "1.9551228022238778"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mt", " ", "=", " ", 
     RowBox[{"nlmap", "[", 
      RowBox[{"x0", ",", " ", "u", ",", " ", "t"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"x", " ", "=", " ", 
    RowBox[{
     RowBox[{"Mt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]", " ", "=", " ", 
     RowBox[{"Mt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"dxdx0", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Xi]", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", " ", 
       RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], " ", "//", " ", 
     "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{"dxd\[Lambda]", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Xi]", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", " ", 
       RowBox[{"5", ";;", 
        RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], " ", "//", " ", 
     "MatrixForm"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Me", " ", "=", " ", 
     RowBox[{"nlmap", "[", 
      RowBox[{"x0", ",", " ", "u", ",", " ", 
       RowBox[{"2", "t"}], ",", 
       RowBox[{"EventHandler", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"x", " ", "=", " ", 
    RowBox[{
     RowBox[{"Me", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]", " ", "=", " ", 
     RowBox[{"Me", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"dxdx0", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Xi]", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", " ", 
       RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], " ", "//", " ", 
     "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{"dxd\[Lambda]", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Xi]", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", " ", 
       RowBox[{"5", ";;", 
        RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], " ", "//", " ", 
     "MatrixForm"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "compare", " ", "dxdx0", " ", "with", " ", "finite", " ", 
     "differencing"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"time", "-", "based"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", "1*^-5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "h"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"H", "[", 
            RowBox[{"\[CurlyPhi]", "[", 
             RowBox[{
              RowBox[{"x0", " ", "+", " ", "d"}], ",", " ", 
              RowBox[{"0", "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "t"}], "}"}]}], "]"}], "]"}], " ", "-", 
           " ", 
           RowBox[{"H", "[", 
            RowBox[{"\[CurlyPhi]", "[", 
             RowBox[{
              RowBox[{"x0", " ", "-", " ", "d"}], ",", " ", 
              RowBox[{"0", "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "t"}], "}"}]}], "]"}], "]"}]}], ")"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"d", ",", " ", 
         RowBox[{"h", " ", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}]}], "]"}], 
     "\[Transpose]"}], " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"event", "-", "based"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", "1*^-5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "h"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"H", "[", 
            RowBox[{"\[CurlyPhi]", "[", 
             RowBox[{
              RowBox[{"x0", " ", "+", " ", "d"}], ",", " ", 
              RowBox[{"0", "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", 
                RowBox[{"2", "t"}]}], "}"}], ",", " ", 
              RowBox[{"EventHandler", "\[Rule]", " ", "True"}]}], "]"}], 
            "]"}], " ", "-", " ", 
           RowBox[{"H", "[", 
            RowBox[{"\[CurlyPhi]", "[", 
             RowBox[{
              RowBox[{"x0", " ", "-", " ", "d"}], ",", " ", 
              RowBox[{"0", "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", 
                RowBox[{"2", "t"}]}], "}"}], ",", " ", 
              RowBox[{"EventHandler", "\[Rule]", " ", "True"}]}], "]"}], 
            "]"}]}], ")"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"d", ",", " ", 
         RowBox[{"h", " ", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}]}], "]"}], 
     "\[Transpose]"}], " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "two", " ", "derivatives", " ", "are", " ", "actually", " ", 
     "related"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]0", " ", "=", " ", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"4", ",", " ", "n"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x\[Xi]0", " ", "=", " ", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"x0", ",", " ", "\[Xi]0"}], "]"}], " ", "//", " ", 
      "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}],
       "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x\[Xi]", " ", "=", " ", 
     RowBox[{"\[CurlyPhi]", "[", 
      RowBox[{"x\[Xi]0", ",", " ", 
       RowBox[{
        RowBox[{"(", "u", ")"}], "&"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "t"}], "}"}], ",", " ", "\[Mu]", ",", 
       "dtd\[Lambda]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Me2", " ", "=", " ", 
     RowBox[{"H", "[", 
      RowBox[{"x\[Xi]", "+", 
       RowBox[{"Ft", "[", 
        RowBox[{"x\[Xi]", ",", " ", "0", ",", " ", 
         RowBox[{"dtd\[Lambda]", "[", 
          RowBox[{"t", ",", " ", "x\[Xi]", ",", " ", "x\[Xi]0"}], "]"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Me2", "\[LeftDoubleBracket]", 
       RowBox[{"5", ";;"}], "\[RightDoubleBracket]"}], ",", " ", "n"}], "]"}],
     " ", "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.593430813076542*^9, 3.5934308137215786`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example nlroot functions", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.593429842035679*^9, 3.5934298517700715`*^9}, 
   3.593430814686634*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"implicit", " ", "function", " ", "setter"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nlroot", "[", "fcn_", "]"}], ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringQ", "[", "fcn", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fcn", " ", "\[Equal]", " ", "\"\<pt\>\""}], ",", " ", 
        RowBox[{"f", " ", "=", " ", "root1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"fcn", " ", "\[Equal]", " ", "\"\<pe\>\""}], ",", " ", 
        RowBox[{"f", " ", "=", " ", "root2"}], ",", "\[IndentingNewLine]", 
        RowBox[{"fcn", " ", "\[Equal]", " ", "\"\<at\>\""}], ",", " ", 
        RowBox[{"f", " ", "=", " ", "root3"}], ",", "\[IndentingNewLine]", 
        RowBox[{"fcn", " ", "\[Equal]", " ", "\"\<ae\>\""}], ",", " ", 
        RowBox[{"f", " ", "=", " ", "root4"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", "fcn"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.5934306779388027`*^9, 3.593430815474677*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"implicit", " ", "function", " ", "for", " ", "time"}], "-", 
    RowBox[{"based", " ", "passive", " ", "brachiation"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"root1", "[", 
     RowBox[{"\[Lambda]_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x0", ",", " ", "t", ",", " ", "M", ",", " ", "root", ",", " ", 
        "droot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x0", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{
        "\[Lambda]", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"nlmap", "[", 
         RowBox[{"x0", ",", " ", "0", ",", " ", "t", ",", " ", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"root", " ", "=", " ", 
        RowBox[{"FixState", "[", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           " ", "-", " ", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"droot", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "-", " ", "\[Xi]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "for", " ", "passive", " ", "we", " ", "only", " ", "want", " ", 
         "dxdx0", " ", "and", " ", "dxdt"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"also", " ", "return", " ", "eigenvalues"}], ",", " ", 
         RowBox[{"since", " ", 
          RowBox[{"it", "'"}], "ll", " ", "be", " ", "useful", " ", 
          "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"root", ",", " ", 
         RowBox[{"droot", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", 
           RowBox[{"1", ";;", "5"}]}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"implicit", " ", "function", " ", "for", " ", "event"}], "-", 
     RowBox[{"based", " ", "passive", " ", "brachiation"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "root2", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", "\[Rule]", " ", "15"}], "}"}], " ", "~", "Join", 
      "~", " ", 
      RowBox[{"Options", "[", "\[CurlyPhi]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"root2", "[", 
     RowBox[{"\[Lambda]_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0", ",", " ", "M", ",", " ", "root", ",", " ", "droot"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x0", " ", "=", " ", "\[Lambda]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"nlmap", "[", 
         RowBox[{"x0", ",", " ", "0", ",", " ", 
          RowBox[{"OptionValue", "[", "\"\<t\>\"", "]"}], ",", " ", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"EventHandler", "\[Rule]", " ", "True"}], ",", " ", 
              "opts"}], "}"}], ",", " ", 
            RowBox[{"Options", "[", "\[CurlyPhi]", "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"root", " ", "=", " ", 
        RowBox[{"FixState", "[", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           " ", "-", " ", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"droot", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "-", " ", "\[Xi]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "for", " ", "passive", " ", "we", " ", "only", " ", "want", " ", 
         "dxdx0", " ", "and", " ", "dxdt"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"also", " ", "return", " ", "eigenvalues"}], ",", " ", 
         RowBox[{"since", " ", 
          RowBox[{"it", "'"}], "ll", " ", "be", " ", "useful", " ", 
          "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"root", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", "4"}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"droot", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"2", ";;", "4"}], ",", " ", 
           RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"implicit", " ", "function", " ", "for", " ", "time"}], "-", 
     RowBox[{"based", " ", "powered", " ", "brachiation"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"root3", "[", 
     RowBox[{"\[Lambda]_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x0", ",", " ", "t", ",", " ", "u", ",", " ", "M", ",", " ", "root", 
        ",", " ", "droot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x0", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{
        "\[Lambda]", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"u", " ", "=", " ", 
        RowBox[{
        "\[Lambda]", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"nlmap", "[", 
         RowBox[{"x0", ",", " ", "u", ",", " ", "t", ",", " ", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"root", " ", "=", " ", 
        RowBox[{"FixState", "[", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           " ", "-", " ", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"droot", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "-", " ", "\[Xi]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "for", " ", "passive", " ", "we", " ", "only", " ", "want", " ", 
         "dxdx0", " ", "and", " ", "dxdt"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"also", " ", "return", " ", "eigenvalues"}], ",", " ", 
         RowBox[{"since", " ", 
          RowBox[{"it", "'"}], "ll", " ", "be", " ", "useful", " ", 
          "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"root", ",", " ", "droot", ",", " ", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"implicit", " ", "function", " ", "for", " ", "event"}], "-", 
     RowBox[{"based", " ", "powered", " ", "brachiation"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "root4", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", "\[Rule]", " ", "15"}], "}"}], " ", "~", "Join", 
      "~", " ", 
      RowBox[{"Options", "[", "\[CurlyPhi]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"root4", "[", 
     RowBox[{"\[Lambda]_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x0", ",", " ", "u", ",", " ", "M", ",", " ", "root", ",", " ", 
        "droot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x0", " ", "=", " ", 
        RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u", " ", "=", "  ", 
        RowBox[{
        "\[Lambda]", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"nlmap", "[", 
         RowBox[{"x0", ",", " ", "u", ",", " ", 
          RowBox[{"OptionValue", "[", "\"\<t\>\"", "]"}], ",", " ", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"EventHandler", "\[Rule]", " ", "True"}], ",", " ", 
              "opts"}], "}"}], ",", " ", 
            RowBox[{"Options", "[", "\[CurlyPhi]", "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"root", " ", "=", " ", 
        RowBox[{"FixState", "[", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           " ", "-", " ", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"droot", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "-", " ", "\[Xi]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "for", " ", "passive", " ", "we", " ", "only", " ", "want", " ", 
         "dxdx0", " ", "and", " ", "dxdt"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"also", " ", "return", " ", "eigenvalues"}], ",", " ", 
         RowBox[{"since", " ", 
          RowBox[{"it", "'"}], "ll", " ", "be", " ", "useful", " ", 
          "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"root", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", "4"}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"droot", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"2", ";;", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], "}"}]}], 
          "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.5934306779388027`*^9, {3.593430816319728*^9, 3.59343081869786*^9}, {
   3.593431038017424*^9, 3.5934310383574476`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.6587267938894797", ",", "1.9749754705416689", ",", 
       RowBox[{"-", "0.10807888048962308"}], ",", "0.4115170127117205"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "1.9551228022238778"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"root", " ", "=", " ", 
     RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"err", ",", " ", "derr", ",", " ", "eig"}], "}"}], " ", "=", 
     " ", 
     RowBox[{"root", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"x0", ",", " ", "t"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"err", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"derr", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"eig", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"root", " ", "=", " ", 
     RowBox[{"nlroot", "[", "\"\<ae\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"err", ",", " ", "derr", ",", " ", "eig"}], "}"}], " ", "=", 
     " ", 
     RowBox[{"root", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"x0", ",", " ", "0"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"err", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"derr", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"eig", " ", "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.5934308194039044`*^9, 3.59343082006594*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nlc0", "Section",
 InitializationCell->True,
 CellChangeTimes->{3.5934308210550027`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nlc0", "::", "root"}], " ", "=", " ", 
    "\"\<\[Lambda] must yield a known root of f.  Norm[f(\[Lambda])] is too \
large `1` (> 10^-5).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nlc0", "::", "bifurcation"}], " ", "=", " ", 
    "\"\<Bifurcation at `1`.  Selecting tangent `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "in", " ", "the", " ", "future", " ", "add", " ", "options", " ", "for", 
    " ", "which", " ", "tangent", " ", "is", " ", "chosen", " ", "at", " ", 
    "bifuractions"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "nlc0", "]"}], " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Select", "\[Rule]", " ", "1"}], ",", " ", 
    RowBox[{"Tolerance", "\[Rule]", " ", "Automatic"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlc0", "[", 
   RowBox[{"\[Lambda]0_", ",", " ", "h_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"root", ",", " ", "droot", ",", " ", "NS", ",", " ", "eig"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "set", " ", "up", " ", "initial", " ", "point", " ", "on", " ", "our", 
      " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], " ", "=", 
      " ", 
      RowBox[{"f", "[", 
       RowBox[{"\[Lambda]0", ",", " ", "opts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "root", "]"}], " ", ">", "  ", "ftol"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlc0", "::", "root"}], ",", 
          RowBox[{"Norm", "[", "root", "]"}]}], "]"}], ";", 
        RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NS", " ", "=", " ", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"droot", ",", " ", 
        RowBox[{"Tolerance", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Tolerance", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "NS", "]"}], " ", ">", " ", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"NS", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"NS", "\[LeftDoubleBracket]", 
           RowBox[{"OptionValue", "[", "Select", "]"}], 
           "\[RightDoubleBracket]"}], "}"}]}], ";", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlc0", "::", "bifurcation"}], ",", "\[Lambda]0", ",", " ", 
          RowBox[{"OptionValue", "[", "Select", "]"}]}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "NS", "]"}], " ", ">", " ", "0"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]0", ",", " ", 
         RowBox[{"Norm", "[", "root", "]"}], ",", " ", "eig", ",", 
         RowBox[{"NS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", " ", "h"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]0", ",", " ", 
         RowBox[{"Norm", "[", "root", "]"}], ",", " ", "eig", ",", "h"}], 
        "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5934308217020364`*^9, 3.5934308247662153`*^9}, {
  3.593624101867319*^9, 3.5936241212484303`*^9}, {3.593624170683261*^9, 
  3.593624181818898*^9}, {3.5936242270714893`*^9, 3.593624274485205*^9}, {
  3.5936243414680414`*^9, 3.5936243556308513`*^9}, {3.5940849174970617`*^9, 
  3.5940849180595636`*^9}, {3.594390771589301*^9, 3.5943908183209734`*^9}, {
  3.5943908673227835`*^9, 3.594390966409458*^9}, {3.5943967894065733`*^9, 
  3.594396815516001*^9}, {3.5955922949445066`*^9, 3.5955922963507576`*^9}, {
  3.595597207131957*^9, 3.5955972128052826`*^9}, {3.5982058835964093`*^9, 
  3.598205886144574*^9}, {3.6039985326983376`*^9, 3.603998538963975*^9}, {
  3.60506461432456*^9, 3.605064619613864*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "these", " ", "variables", " ", "must", " ", "correspond", " ", "to", " ", 
    "a", " ", "root", " ", "of", " ", "f"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.6587267938894797", ",", "1.9749754705416689", ",", 
       RowBox[{"-", "0.10807888048962308"}], ",", "0.4115170127117205"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "1.9551228022238778"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"1", "/", "100"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"step", " ", "size", " ", "along", " ", "curve"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Y", " ", "=", " ", 
    RowBox[{"nlc0", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"x0", ",", " ", "t"}], "]"}], ",", "  ", "h"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<ae\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Y", " ", "=", " ", 
    RowBox[{"nlc0", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"x0", ",", " ", "u"}], "]"}], ",", "  ", "h"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"||", 
        RowBox[{
         RowBox[{"x", 
          RowBox[{"(", "t", ")"}]}], " ", "-", " ", 
         RowBox[{"x", 
          RowBox[{"(", "0", ")"}]}]}], "||"}], ")"}], " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eig", 
       RowBox[{"(", 
        RowBox[{"dH", "/", "dx0"}], ")"}]}], " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NullSpace", 
       RowBox[{"(", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"dx", "/", "dx0"}], " ", 
          RowBox[{"dx", "/", "dt"}]}], "]"}], ")"}]}], " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", 
       RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.593430825432249*^9, 3.593430827768381*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nlc", "Section",
 InitializationCell->True,
 CellChangeTimes->{3.5934308286404333`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nlc", "::", "cvmit"}], " ", "=", " ", 
    "\"\<Failed to converge within 100 iterations; starting from `1` the \
final error was `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlc", "[", 
   RowBox[{"Y_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Z", ",", " ", "root", ",", " ", "droot", ",", " ", "eig", ",", " ", 
      "NS", ",", " ", "h", ",", " ", "step"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"h", " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NS", " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", 
       RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Z", " ", "=", " ", 
      RowBox[{
       RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       " ", "+", 
       RowBox[{"h", " ", "NS"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], " ", 
         "=", "  ", 
         RowBox[{"f", "[", 
          RowBox[{"Z", ",", " ", "opts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"root", ",", " ", 
          RowBox[{
           RowBox[{"NS", ".", 
            RowBox[{"(", 
             RowBox[{"Z", "-", 
              RowBox[{
              "Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}]}], " ", "-", "  ", "h"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"droot", ",", " ", "NS"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"step", " ", "=", "  ", 
           RowBox[{
            RowBox[{"PseudoInverse", "[", "droot", "]"}], ".", "root"}]}], 
          ",", " ", 
          RowBox[{"Throw", "[", 
           RowBox[{"Inverse", "::", "\"\<luc\>\""}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", "step", "]"}], " ", "<", " ", "rtol"}], " ", 
           "||", " ", 
           RowBox[{
            RowBox[{"Norm", "[", "root", "]"}], " ", "<", " ", "atol"}]}], 
          ",", " ", 
          RowBox[{
           RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "step", "]"}], " ", ">", " ", "10"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Throw", "[", "$Failed", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Z", " ", "=", " ", 
         RowBox[{"Z", " ", "-", " ", "step"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "100", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "root", "]"}], " ", ">", " ", "ftol"}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlc", "::", "cvmit"}], ",", " ", 
          RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{"Norm", "@", "root"}]}], "]"}], ";", " ", 
        RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NS", " ", "=", " ", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"droot", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], ",", " ", "All"}], "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"NS", " ", "=", " ", 
        RowBox[{"NullSpace", "[", 
         RowBox[{
          RowBox[{"droot", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}], ",", " ", "All"}], 
           "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"Tolerance", "\[Rule]", "Automatic"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "NS", "]"}], " ", "==", " ", "2"}], ",", 
         RowBox[{"NS", " ", "=", " ", 
          RowBox[{"Sort", "[", 
           RowBox[{"NS", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "<", " ", 
              RowBox[{"#2", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
           "]"}]}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "NS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
          RowBox[{"Y", "\[LeftDoubleBracket]", 
           RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], " ", "<", " ", 
         "0"}], ",", " ", 
        RowBox[{"-", "h"}], ",", " ", "h"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Z", ",", " ", 
       RowBox[{"Norm", "[", "root", "]"}], ",", " ", "eig", ",", 
       RowBox[{"NS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", " ", "h"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.593430829406477*^9, 3.5934308309865694`*^9}, {
  3.594392388004868*^9, 3.5943923892769403`*^9}, {3.5943960992958455`*^9, 
  3.5943961000146*^9}, {3.5943963653588676`*^9, 3.594396371280755*^9}, {
  3.5943968887661424`*^9, 3.5943968892817674`*^9}, {3.594437850121456*^9, 
  3.594437901465287*^9}, {3.5944379458716264`*^9, 3.5944379511997633`*^9}, {
  3.594438785857647*^9, 3.5944387960920415`*^9}, {3.594438869607812*^9, 
  3.5944388856391087`*^9}, {3.5944390092174597`*^9, 3.5944391180926847`*^9}, {
  3.5955923065851555`*^9, 3.5955923075695314`*^9}, {3.6041698454999495`*^9, 
  3.6041698473437014`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "these", " ", "variables", " ", "must", " ", "correspond", " ", "to", " ", 
    "a", " ", "root", " ", "of", " ", "f"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.6587267938894797", ",", "1.9749754705416689", ",", 
       RowBox[{"-", "0.10807888048962308"}], ",", "0.4115170127117205"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "1.9551228022238778"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"1", "/", "100"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"step", " ", "size", " ", "along", " ", "curve"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "now", " ", "find", " ", "the", " ", "next", " ", "point", " ", "on", " ",
      "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", " ", "=", " ", 
     RowBox[{"nlc0", "[", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "h"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"nlc", "[", "Y", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.59343083172661*^9, 3.59343083312269*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nlac", "Section",
 InitializationCell->True,
 CellChangeTimes->{3.5934308339577417`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "teststep", "]"}], " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"\"\<ders\>\"", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"0.6", ",", " ", "0.05", ",", " ", "0.01"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"teststep", "[", 
   RowBox[{"h_", ",", " ", "Y_", ",", " ", "NS_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "g", ",", " ", "dg", ",", " ", "Z", ",", " ", "step", ",", " ", "ns", 
      ",", " ", "H", ",", " ", "k", ",", " ", "d", ",", " ", "a", ",", " ", 
      "eig", ",", " ", "kder", ",", " ", "dder", ",", " ", "ader"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Based", " ", "on", " ", "Numerical", " ", "Continuation", " ", 
       "Methods"}], ",", " ", 
      RowBox[{"Allgower", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kder", ",", " ", "dder", ",", " ", "ader"}], "}"}], " ", "=", 
      " ", 
      RowBox[{"OptionValue", "[", "\"\<ders\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"dg", " ", "=", " ", 
       RowBox[{"step", " ", "=", " ", 
        RowBox[{"ns", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Z", " ", "=", " ", 
      RowBox[{"Y", " ", "+", 
       RowBox[{"h", " ", "NS"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "g", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
           "dg", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
           " ", "eig"}], "}"}], " ", "=", "  ", 
         RowBox[{"f", "[", 
          RowBox[{"Z", ",", " ", "opts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ns", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          " ", "=", " ", 
         RowBox[{"NullSpace", "[", 
          RowBox[{
          "dg", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"g", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{
           RowBox[{"NS", ".", 
            RowBox[{"(", 
             RowBox[{"Z", "-", "Y"}], ")"}]}], " ", "-", " ", "h"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{
          "dg", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
          " ", "NS"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "step", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           " ", "=", "  ", 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{
             "dg", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}], ".", 
            RowBox[{
            "g", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
          ",", " ", 
          RowBox[{"Throw", "[", 
           RowBox[{"Inverse", "::", "\"\<luc\>\""}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Z", " ", "=", " ", 
         RowBox[{"Z", " ", "-", " ", 
          RowBox[{
          "step", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "2"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"H", " ", "=", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{"dg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"H", ".", 
         RowBox[{
         "g", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}],
        " ", "/", " ", 
       RowBox[{"Norm", "[", 
        RowBox[{"H", ".", 
         RowBox[{
         "g", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"Norm", "[", 
       RowBox[{"step", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"ns", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ".", 
         RowBox[{
          RowBox[{
          "ns", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "\[Transpose]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"k", "/", "kder"}], "]"}], ",", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"d", "/", "dder"}], "]"}], ",", " ", 
        RowBox[{"a", "/", "ader"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"g", ",", " ", "2"}], "]"}], ",", " ", 
        RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", " ", 
        RowBox[{
        "\"\< k \>\"", ",", "k", ",", "  ", "\"\< d \>\"", ",", "d", ",", 
         "  ", "\"\< a \>\"", ",", 
         RowBox[{
          RowBox[{"(", "a", ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "\"\< g \>\"", 
         ",", " ", "g"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"g", ",", " ", "Z"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nlac", "::", "cvmit"}], " ", "=", " ", 
    "\"\<Failed to converge within 100 iterations; starting from `1` the \
final error was `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nlac", "::", "lstol"}], " ", "=", " ", 
    "\"\<The step size is really small, `1`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlac", "[", 
   RowBox[{"Y_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Z", ",", " ", "root", ",", " ", "droot", ",", " ", "eig", ",", " ", 
      "NS", ",", " ", "h", ",", " ", "hscale", ",", " ", "step"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"h", " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NS", " ", "=", " ", 
      RowBox[{"Y", "\[LeftDoubleBracket]", 
       RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Z", " ", "=", " ", 
        RowBox[{
         RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         " ", "+", 
         RowBox[{"h", " ", "NS"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hscale", ",", " ", "Z"}], "}"}], " ", "=", " ", 
      RowBox[{"teststep", "[", 
       RowBox[{"h", ",", " ", 
        RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", " ", "NS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hscale", " ", "<", "  ", "2"}], ",", " ", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", " ", 
         RowBox[{"h", " ", "/", " ", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hscale", ",", " ", "Z"}], "}"}], " ", "=", " ", 
         RowBox[{"teststep", "[", 
          RowBox[{"h", ",", " ", 
           RowBox[{
           "Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", "NS"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "100", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "h", "]"}], " ", "<", " ", 
        RowBox[{"10", "^", 
         RowBox[{"-", "10"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlac", "::", "lstol"}], ",", " ", "h"}], "]"}], ";", " ", 
        RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], " ", 
         "=", "  ", 
         RowBox[{"f", "[", 
          RowBox[{"Z", ",", " ", "opts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"root", ",", " ", 
          RowBox[{
           RowBox[{"NS", ".", 
            RowBox[{"(", 
             RowBox[{"Z", "-", 
              RowBox[{
              "Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}]}], " ", "-", "  ", "h"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"droot", ",", " ", "NS"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"step", " ", "=", "  ", 
           RowBox[{
            RowBox[{"Inverse", "[", "droot", "]"}], ".", "root"}]}], ",", " ", 
          RowBox[{"Throw", "[", 
           RowBox[{"Inverse", "::", "\"\<luc\>\""}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", "step", "]"}], " ", "<", " ", "rtol"}], " ", 
           "||", " ", 
           RowBox[{
            RowBox[{"Norm", "[", "root", "]"}], " ", "<", " ", "atol"}]}], 
          ",", " ", 
          RowBox[{
           RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "step", "]"}], " ", ">", " ", "10"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Throw", "[", "$Failed", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Z", " ", "=", " ", 
         RowBox[{"Z", " ", "-", " ", "step"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "100", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "root", "]"}], " ", ">", " ", "ftol"}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlac", "::", "cvmit"}], ",", " ", 
          RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{"Norm", "@", "root"}]}], "]"}], ";", " ", 
        RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NS", " ", "=", " ", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"droot", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], ",", " ", "All"}], "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "NS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
          RowBox[{"Y", "\[LeftDoubleBracket]", 
           RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], " ", "<", " ", 
         "0"}], ",", " ", 
        RowBox[{"-", "h"}], ",", " ", "h"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Z", ",", " ", 
       RowBox[{"Norm", "[", "root", "]"}], ",", " ", "eig", ",", 
       RowBox[{"NS", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", " ", 
       RowBox[{"h", "/", "hscale"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5934308347167816`*^9, 3.593430837790958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "these", " ", "variables", " ", "must", " ", "correspond", " ", "to", " ", 
    "a", " ", "root", " ", "of", " ", "f"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1.077398914708292", ",", " ", "0.986794824173209", ",", " ", "0", ",", 
       "  ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "2.508001197970272"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"1", "/", "100"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"step", " ", "size", " ", "along", " ", "curve"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "now", " ", "find", " ", "the", " ", "next", " ", "point", " ", "on", " ",
      "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", " ", "=", " ", 
     RowBox[{"nlc0", "[", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "h"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"nlac", "[", "Y", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.593430838630006*^9, 3.593430840092089*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nle", "Section",
 InitializationCell->True,
 CellChangeTimes->{3.593430840900137*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nle", "::", "cvmit"}], " ", "=", " ", 
    "\"\<Failed to converge within 100 iterations; starting from `1` the \
final error was `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nle", "[", 
   RowBox[{"Y_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Z", ",", " ", "root", ",", " ", "droot", ",", " ", "eig", ",", " ", 
      "step"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Z", " ", "=", " ", "Y"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      " ", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Y", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{
         RowBox[{"Y", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", " ", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], " ", "+", " ", 
         RowBox[{"Y", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], " ", 
         "=", "  ", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{
           "Z", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"step", " ", "=", "  ", 
           RowBox[{
            RowBox[{"Inverse", "[", "droot", "]"}], ".", "root"}]}], ",", " ", 
          RowBox[{"Throw", "[", 
           RowBox[{"Inverse", "::", "\"\<luc\>\""}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", "step", "]"}], " ", "<", " ", "rtol"}], " ", 
           "||", " ", 
           RowBox[{
            RowBox[{"Norm", "[", "root", "]"}], " ", "<", " ", "atol"}]}], 
          ",", " ", 
          RowBox[{
           RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "step", "]"}], " ", ">", " ", "10"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Throw", "[", "$Failed", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Z", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", " ", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"Z", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", " ", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], " ", "-", " ",
           "step"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "100", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "root", "]"}], " ", ">", " ", "ftol"}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nle", "::", "cvmit"}], ",", " ", 
          RowBox[{"Y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{"Norm", "@", "root"}]}], "]"}], ";", " ", 
        RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      " ", "=", " ", 
      RowBox[{"Norm", "[", "root", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      " ", "=", " ", "eig"}], ";", "\[IndentingNewLine]", "Z"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5934308415851784`*^9, 3.5934308430832605`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", " ", "=", " ", "50"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "try", " ", "to", " ", "generate", " ", "m", " ", "points", " ", "on", 
     " ", "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1.077398914708292", ",", " ", "0.986794824173209", ",", " ", "0", ",", 
       "  ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "2.508001197970272"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"1", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "\[Lambda]_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], " ", 
         "=", " ", 
         RowBox[{"TwoLink`Gaits`root1", "[", "\[Lambda]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"root", ",", " ", 
          RowBox[{"droot", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", 
            RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], ",", " ", 
          "eig"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Z", " ", "=", " ", 
    RowBox[{"nle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "0", ",", " ", "0", 
       ",", " ", "h"}], "}"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5934308437072964`*^9, 3.593430844247325*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nlcurve", "Section",
 InitializationCell->True,
 CellChangeTimes->{3.5934308450033894`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nlcurve", "::", "info"}], " ", "=", " ", 
   "\"\<`1` took `2` s to run and has `3` points.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nlcurve", "::", "abort"}], " ", "=", " ", 
   "\"\<Aborting `1`; `2` points computed.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlcurve", "[", 
   RowBox[{
   "name_", ",", " ", "c_", ",", " ", "\[Lambda]_", ",", " ", "h_", ",", " ", 
    "m_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Z0", ",", "Z", ",", " ", "time", ",", " ", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Z0", " ", "=", " ", 
      RowBox[{"nlc0", "[", 
       RowBox[{"\[Lambda]", ",", " ", "h", ",", " ", "opts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Z", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"m", "+", "1"}], ",", " ", 
          RowBox[{"Length", "[", "Z0", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      " ", "=", " ", "Z0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"time", " ", "=", " ", 
         RowBox[{"AbsoluteTiming", "[", 
          RowBox[{"Catch", "[", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Z", "\[LeftDoubleBracket]", 
                RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], " ", "=", 
               " ", 
               RowBox[{"c", "[", 
                RowBox[{
                 RowBox[{
                 "Z", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 ",", " ", "opts"}], "]"}]}], ";", " ", 
              RowBox[{"n", " ", "=", " ", 
               RowBox[{"i", "+", "1"}]}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "m"}], "}"}]}], "]"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlcurve", "::", "info"}], ",", " ", "name", ",", " ", 
          RowBox[{
          "time", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
           " ", "n"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Z", " ", "=", 
         RowBox[{"Z", "\[LeftDoubleBracket]", 
          RowBox[{";;", "n"}], "\[RightDoubleBracket]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "truncate", " ", "list", " ", "to", " ", "actual", " ", "number", 
          " ", "of", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"h", "<", " ", "0"}], ",", " ", 
          RowBox[{"Reverse", "[", "Z", "]"}], ",", " ", "Z"}], "]"}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"flip", ",", " ", 
         RowBox[{"if", " ", "negative", " ", "direction"}]}], " ", "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"nlcurve", "::", "abort"}], ",", " ", "name", ",", " ", 
          "n"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Z", " ", "=", 
         RowBox[{"Z", "\[LeftDoubleBracket]", 
          RowBox[{";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"h", "<", " ", "0"}], ",", " ", 
          RowBox[{"Reverse", "[", "Z", "]"}], ",", " ", "Z"}], "]"}]}]}], " ",
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559232071300585*^9, 3.559232098039925*^9}, {
   3.5592321652279663`*^9, 3.559232169182928*^9}, {3.559233180826264*^9, 
   3.5592332474473677`*^9}, {3.55923327917524*^9, 3.559233286214837*^9}, {
   3.55923332143124*^9, 3.559233361981864*^9}, {3.559233693070354*^9, 
   3.5592336972986717`*^9}, {3.5592337837165537`*^9, 
   3.5592337870618267`*^9}, {3.559233969909802*^9, 3.559233972482233*^9}, {
   3.559234624375668*^9, 3.559234626611794*^9}, {3.559234799353948*^9, 
   3.559234803401348*^9}, {3.593430845501399*^9, 3.59343084743351*^9}, {
   3.593623832840914*^9, 3.5936238391512747`*^9}, {3.5936244786258955`*^9, 
   3.5936245370142384`*^9}, 3.5940748326205544`*^9, {3.5940755760262537`*^9, 
   3.5940755764402742`*^9}, {3.594182044473926*^9, 3.59418218009919*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", " ", "=", " ", "50"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "try", " ", "to", " ", "generate", " ", "m", " ", "points", " ", "on", 
     " ", "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1.077398914708292", ",", " ", "0.986794824173209", ",", " ", "0", ",", 
       "  ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "2.508001197970272"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"1", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"plot", " ", "initial", " ", "condition", " ", "space"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"with", " ", "fixed", " ", "step"}], "-", "size"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", " ", "=", " ", 
     RowBox[{"nlcurve", "[", 
      RowBox[{"\"\<long sln\>\"", ",", " ", "nlc", ",", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "h", ",", " ", "m"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{"Z", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", " ", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
       "\[RightDoubleBracket]"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "all", " ", "points"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Z", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", "1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
         "\[RightDoubleBracket]"}], "}"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"plot", " ", "x0"}], " ", "*)"}], " ", 
       RowBox[{"PlotStyle", "\[Rule]", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", " ", 
           RowBox[{"PointSize", "[", "0.03", "]"}]}], "}"}], "]"}]}]}], "]"}],
      ",", "\[IndentingNewLine]", " ", 
     RowBox[{"AxesLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(1\)]\)\>\"", 
        ",", " ", 
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(2\)]\)\>\"", 
        ",", " ", "\"\<\!\(\*SubscriptBox[\(q\), \(1\)]\)\>\""}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"with", " ", "adaptive", " ", "step"}], "-", "size"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", " ", "=", " ", 
     RowBox[{"nlcurve", "[", 
      RowBox[{"\"\<long sln\>\"", ",", " ", "nlac", ",", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "h", ",", " ", "m"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{"Z", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", " ", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
       "\[RightDoubleBracket]"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "all", " ", "points"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Z", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", "1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
         "\[RightDoubleBracket]"}], "}"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"plot", " ", "x0"}], " ", "*)"}], " ", 
       RowBox[{"PlotStyle", "\[Rule]", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", " ", 
           RowBox[{"PointSize", "[", "0.03", "]"}]}], "}"}], "]"}]}]}], "]"}],
      ",", "\[IndentingNewLine]", " ", 
     RowBox[{"AxesLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(1\)]\)\>\"", 
        ",", " ", 
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(2\)]\)\>\"", 
        ",", " ", "\"\<\!\(\*SubscriptBox[\(q\), \(1\)]\)\>\""}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"with", " ", "embedding", " ", "algorithm"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "\[Lambda]_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"root", ",", " ", "droot", ",", " ", "eig"}], "}"}], " ", 
         "=", " ", 
         RowBox[{"TwoLink`Gaits`root1", "[", "\[Lambda]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"root", ",", " ", 
          RowBox[{"droot", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", 
            RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], ",", " ", 
          "eig"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", " ", "=", " ", 
     RowBox[{"nlcurve", "[", 
      RowBox[{"\"\<long sln\>\"", ",", " ", "nle", ",", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "h", ",", " ", "m"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{"Z", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", " ", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
       "\[RightDoubleBracket]"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "all", " ", "points"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Z", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", "1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
         "\[RightDoubleBracket]"}], "}"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"plot", " ", "x0"}], " ", "*)"}], " ", 
       RowBox[{"PlotStyle", "\[Rule]", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", " ", 
           RowBox[{"PointSize", "[", "0.03", "]"}]}], "}"}], "]"}]}]}], "]"}],
      ",", "\[IndentingNewLine]", " ", 
     RowBox[{"AxesLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(1\)]\)\>\"", 
        ",", " ", 
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(2\)]\)\>\"", 
        ",", " ", "\"\<\!\(\*SubscriptBox[\(q\), \(1\)]\)\>\""}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5934308481095457`*^9, 3.593430853842875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["nlparcurve", "Section",
 InitializationCell->True,
 CellChangeTimes->{3.5934308549439583`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nlparcurve", "[", 
   RowBox[{
   "name_", ",", " ", "c_", ",", " ", "\[Lambda]_", ",", " ", "h_", ",", " ", 
    "m_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", " ", "a", ",", " ", "b", ",", " ", "c0", ",", " ", "c1", ",", 
      " ", "cs", ",", " ", "o"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c0", " ", "=", " ", 
      RowBox[{"nlc0", "[", 
       RowBox[{"\[Lambda]", ",", " ", "h", ",", " ", "opts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c1", " ", "=", 
      RowBox[{"nlc", "[", 
       RowBox[{"c0", ",", " ", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"2", "h"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "c0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"m", "/", "2"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "c1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{"m", "/", "2"}], "]"}], "-", "1"}]}], "}"}]}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"o", " ", "=", " ", 
      RowBox[{"{", "opts", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistributeDefinitions", "[", 
      RowBox[{
      "name", ",", " ", "c", ",", " ", "a", ",", " ", "b", ",", " ", "o"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cs", " ", "=", " ", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"nlcurve", "[", 
         RowBox[{"name", ",", " ", "c", ",", " ", 
          RowBox[{"b", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
          "a", ",", " ", 
          RowBox[{"b", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          "o"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{
         "cs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        " ", 
        RowBox[{"Length", "@", 
         RowBox[{
         "cs", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"cs", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", 
         RowBox[{";;", "l"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"cs", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", " ", 
         RowBox[{";;", "l"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559231730987041*^9, 3.5592317395693073`*^9}, {
  3.559231979714163*^9, 3.559231998825406*^9}, {3.559232266082345*^9, 
  3.5592322705569277`*^9}, {3.559232347070519*^9, 3.559232351230736*^9}, {
  3.5592326085326023`*^9, 3.559232616662613*^9}, {3.55923279567732*^9, 
  3.5592328329320507`*^9}, {3.559232936242539*^9, 3.5592329458813047`*^9}, {
  3.5592338012290287`*^9, 3.55923380692094*^9}, {3.559233851313352*^9, 
  3.559233865957556*^9}, {3.5934308556579995`*^9, 3.5934308579251103`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "usage"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParallelNeeds", "[", "\"\<TwoLink`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParallelEvaluate", "[", 
     RowBox[{
      RowBox[{"DefaultPhysicalParameters", "[", "]"}], ";"}], "]"}], ";", 
    RowBox[{"ParallelEvaluate", "[", 
     RowBox[{
      RowBox[{"CompileFunctions", "[", "]"}], ";"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", " ", "=", " ", "50"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "try", " ", "to", " ", "generate", " ", "m", " ", "points", " ", "on", 
     " ", "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1.077398914708292", ",", " ", "0.986794824173209", ",", " ", "0", ",", 
       "  ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", "2.508001197970272"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"1", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nlroot", "[", "\"\<pt\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", " ", "=", " ", 
     RowBox[{"nlparcurve", "[", 
      RowBox[{"\"\<long sln\>\"", ",", " ", "nlc", ",", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"x0", ",", " ", "t"}], "]"}], ",", " ", "h", ",", " ", "m"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"plot", " ", "initial", " ", "condition", " ", "space"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{"Z", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", " ", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
       "\[RightDoubleBracket]"}], "]"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"plot", " ", "all", " ", "points"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Z", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", " ", "1", ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], 
         "\[RightDoubleBracket]"}], "}"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"plot", " ", "x0"}], " ", "*)"}], " ", 
       RowBox[{"PlotStyle", "\[Rule]", " ", 
        RowBox[{"Directive", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", " ", 
           RowBox[{"PointSize", "[", "0.03", "]"}]}], "}"}], "]"}]}]}], "]"}],
      ",", "\[IndentingNewLine]", " ", 
     RowBox[{"AxesLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(1\)]\)\>\"", 
        ",", " ", 
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(2\)]\)\>\"", 
        ",", " ", "\"\<\!\(\*SubscriptBox[\(q\), \(1\)]\)\>\""}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5934308586431513`*^9, 3.5934308605132565`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5934306295330305`*^9, 3.593430630223071*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{570, 628},
WindowMargins->{{Automatic, 54}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 2881, 57, 313, "Code",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3451, 81, 59, 1, 86, "Section",
 InitializationCell->True],
Cell[3513, 84, 3611, 68, 1292, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[7161, 157, 58, 1, 86, "Section",
 InitializationCell->True],
Cell[7222, 160, 1333, 36, 132, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[8592, 201, 153, 3, 86, "Section",
 InitializationCell->True],
Cell[8748, 206, 3243, 79, 332, "Input"],
Cell[11994, 287, 7898, 202, 872, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19929, 494, 164, 3, 86, "Section",
 InitializationCell->True],
Cell[20096, 499, 1222, 25, 212, "Input",
 InitializationCell->True],
Cell[21321, 526, 12010, 279, 1372, "Input"],
Cell[33334, 807, 1864, 47, 332, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35235, 859, 94, 2, 86, "Section",
 InitializationCell->True],
Cell[35332, 863, 4401, 105, 512, "Input",
 InitializationCell->True],
Cell[39736, 970, 3026, 79, 412, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42799, 1054, 93, 2, 86, "Section",
 InitializationCell->True],
Cell[42895, 1058, 6574, 162, 672, "Input",
 InitializationCell->True],
Cell[49472, 1222, 1516, 39, 212, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51025, 1266, 94, 2, 86, "Section",
 InitializationCell->True],
Cell[51122, 1270, 6503, 168, 732, "Input",
 InitializationCell->True],
Cell[57628, 1440, 6874, 175, 872, "Input",
 InitializationCell->True],
Cell[64505, 1617, 1482, 39, 192, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66024, 1661, 91, 2, 86, "Section",
 InitializationCell->True],
Cell[66118, 1665, 4402, 112, 512, "Input",
 InitializationCell->True],
Cell[70523, 1779, 1991, 52, 212, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72551, 1836, 97, 2, 86, "Section",
 InitializationCell->True],
Cell[72651, 1840, 4874, 112, 532, "Input",
 InitializationCell->True],
Cell[77528, 1954, 7828, 192, 895, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85393, 2151, 100, 2, 86, "Section",
 InitializationCell->True],
Cell[85496, 2155, 3724, 90, 312, "Input",
 InitializationCell->True],
Cell[89223, 2247, 3378, 83, 439, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92638, 2335, 57, 1, 86, "Section",
 InitializationCell->True],
Cell[92698, 2338, 190, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
