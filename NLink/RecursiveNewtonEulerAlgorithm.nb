(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     55676,       1056]
NotebookOptionsPosition[     54873,       1023]
NotebookOutlinePosition[     55251,       1039]
CellTagsIndexPosition[     55208,       1036]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", "\"\<NLink`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367625062662*^9, 3.5933676251720285`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Modified Recursive Newton-Euler Algorithm \
\>", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.591667897763588*^9, 3.591667900579752*^9}, {3.6031381638093967`*^9, 
  3.603138168957694*^9}, {3.6031393637641134`*^9, 3.603139393129795*^9}}],

Cell[CellGroupData[{

Cell["\<\
only calculates forces due to velocity product terms (Coriolis & centrifugal) \
and gravity for use in forward dynamics algorithm.\
\>", "Subsection",
 CellChangeTimes->{{3.603139394350869*^9, 3.603139411963874*^9}, {
  3.603139460070629*^9, 3.603139470118206*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"user", " ", 
      RowBox[{"inputs", ":", " ", "x"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"model", " ", 
      RowBox[{"data", ":", " ", "s"}]}]}], ",", " ", "ag", ",", " ", "XL", 
    ",", " ", "\[DoubleStruckCapitalI]", ",", " ", "parent", ",", " ", 
    RowBox[{"nq", ";", "\[IndentingNewLine]", 
     RowBox[{"modifies", ":", " ", "uJ"}]}], ",", " ", "v", ",", " ", "a", 
    ",", " ", 
    RowBox[{"f", ";", "\[IndentingNewLine]", 
     RowBox[{"output", ":", " ", 
      RowBox[{"uJ", " ", 
       RowBox[{"(", 
        RowBox[{"non", "-", 
         RowBox[{
         "input", " ", "forces", " ", "and", " ", "torques", " ", "acting", 
          " ", "on", " ", "body", " ", "i", " ", "in", " ", "joint", " ", 
          "space"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RNEA", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vJ", ",", " ", "p"}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"clear", "/", "set"}], " ", "spatial", " ", "variables"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", " ", "=", " ", "Zspat"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"spatial", " ", "velocity"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", "Zspat"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"spatial", " ", "acceleration"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", "Zspat"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"spatial", " ", "force"}], " ", "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"clear", " ", "RNEA", " ", "variables"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"uJ", " ", "=", " ", "znq"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"C", "-", 
         RowBox[{"space", " ", "forces"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "calc", " ", "forces", " ", "due", " ", "to", " ", "velocity", " ", 
         "product", " ", "terms", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coriolis", " ", "&"}], " ", "centrifugal"}], ")"}], " ", 
         "and", " ", "gravity"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
           "parent", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"vJ", " ", "=", " ", 
           RowBox[{
            RowBox[{
            "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", " ", "\[Equal]", " ", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "only", " ", "use", " ", "relative", " ", "link", " ", 
              "velocity"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", "vJ"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{
               "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               ".", "ag"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
            RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"add", " ", 
              RowBox[{"parent", "'"}], "s", " ", "value"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                ".", 
                RowBox[{
                "v", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}]}],
                " ", "+", " ", "vJ"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                ".", 
                RowBox[{
                "a", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}]}],
                " ", "+", " ", 
               RowBox[{
                RowBox[{"mx", "[", 
                 RowBox[{
                 "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "]"}], ".", "vJ"}]}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
            "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "  ",
             "+", " ", 
            RowBox[{
             RowBox[{
             "sJdot", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "+=", " ", 
              RowBox[{
               RowBox[{
               "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{
               "qdd", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], ";"}], " ", "<", 
            RowBox[{
             RowBox[{"-", " ", "complete"}], " ", "RNEA"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "f", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ".", 
             RowBox[{
             "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            " ", "+", " ", 
            RowBox[{
             RowBox[{"mxstar", "[", 
              RowBox[{
              "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ".", 
               RowBox[{
               "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "nq"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "uJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
            "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ".", 
            RowBox[{
            "f", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
           "parent", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", " ", "\[NotEqual]", " ", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "f", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{
               "f", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], 
               " ", "+", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  "\[Transpose]"}], ".", 
                RowBox[{
                "f", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "nq", ",", " ", "1", ",", " ", 
           RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5885995383332195`*^9, 3.5885996092213144`*^9}, 
   3.5885999524873724`*^9, {3.588601675361512*^9, 3.588601758512061*^9}, {
   3.588601840767516*^9, 3.588601841180587*^9}, {3.5886018816447115`*^9, 
   3.5886019473060565`*^9}, {3.5886022797163334`*^9, 3.588602280951494*^9}, {
   3.5886043966224165`*^9, 3.588604462517539*^9}, {3.588605282680728*^9, 
   3.5886052979376717`*^9}, {3.5886054970894094`*^9, 
   3.5886056251355944`*^9}, {3.588605687973068*^9, 3.5886056896734715`*^9}, 
   3.5886061216264935`*^9, {3.5886061684269943`*^9, 3.58860619043883*^9}, {
   3.5886062292052464`*^9, 3.5886062324188795`*^9}, 3.588606265350832*^9, {
   3.588606495110093*^9, 3.5886065142670975`*^9}, {3.58860667863139*^9, 
   3.58860669264034*^9}, {3.5886068059287524`*^9, 3.5886068599677315`*^9}, {
   3.5886074128532553`*^9, 3.588607528746908*^9}, {3.5886075672022033`*^9, 
   3.588607567638996*^9}, {3.5886077049672604`*^9, 3.5886077291631193`*^9}, {
   3.5886077786312485`*^9, 3.588607794871023*^9}, 3.588607957143961*^9, {
   3.5886082791314096`*^9, 3.5886083400968623`*^9}, {3.588609697803914*^9, 
   3.588609877065426*^9}, {3.5886100237853527`*^9, 3.5886101230146103`*^9}, {
   3.5886103220273566`*^9, 3.5886103327867393`*^9}, {3.58861053071404*^9, 
   3.5886106312368336`*^9}, {3.588611251036131*^9, 3.5886112525913277`*^9}, {
   3.5886113815043917`*^9, 3.5886113855429196`*^9}, {3.5886114300018578`*^9, 
   3.5886114317250957`*^9}, {3.5886115677843876`*^9, 
   3.5886116506469193`*^9}, {3.5886118366497803`*^9, 3.588611873722494*^9}, {
   3.588611917572071*^9, 3.588612042779978*^9}, {3.5886120766523037`*^9, 
   3.5886121135239716`*^9}, {3.588612224218059*^9, 3.588612308878456*^9}, {
   3.5886123716844573`*^9, 3.5886123756339593`*^9}, {3.5886125306665444`*^9, 
   3.5886125474336567`*^9}, {3.5886126116958275`*^9, 
   3.5886127038385334`*^9}, {3.5886127356786003`*^9, 3.588612772500265*^9}, {
   3.588612909945178*^9, 3.58861291011018*^9}, {3.5886153126333413`*^9, 
   3.5886154025337667`*^9}, {3.588615929106757*^9, 3.5886159671636124`*^9}, {
   3.5886160203073483`*^9, 3.5886160339840865`*^9}, {3.588616109452679*^9, 
   3.5886161113169193`*^9}, {3.5886161517860765`*^9, 
   3.5886161522861414`*^9}, {3.58861619293729*^9, 3.588616197606882*^9}, {
   3.588616240615348*^9, 3.5886162719643326`*^9}, {3.588616304200449*^9, 
   3.588616314495736*^9}, {3.5886165379409494`*^9, 3.588616549046362*^9}, {
   3.588616603782317*^9, 3.5886166057395663`*^9}, {3.5886169247827473`*^9, 
   3.5886169429650617`*^9}, {3.588617150493795*^9, 3.588617152634066*^9}, {
   3.588617228532714*^9, 3.5886172384639945`*^9}, {3.5886176213780613`*^9, 
   3.5886176371840515`*^9}, {3.5886176695551662`*^9, 3.588617669918231*^9}, {
   3.58861854457662*^9, 3.588618584866741*^9}, {3.5886186473896847`*^9, 
   3.588618664141816*^9}, {3.5886188282496705`*^9, 3.5886188764547997`*^9}, {
   3.588618950000148*^9, 3.588618972980068*^9}, 3.5886191229861517`*^9, {
   3.588619165780572*^9, 3.5886191681148868`*^9}, {3.5886196718680286`*^9, 
   3.588619733660898*^9}, {3.588619915783515*^9, 3.5886200431317005`*^9}, {
   3.5886201388117743`*^9, 3.5886201509143114`*^9}, {3.5886204258203726`*^9, 
   3.588620434663494*^9}, {3.5886235299303675`*^9, 3.588623541694849*^9}, {
   3.588623602169527*^9, 3.5886236286488724`*^9}, {3.588623716481042*^9, 
   3.588623749941314*^9}, {3.5886238019509*^9, 3.5886238054053535`*^9}, {
   3.5886239889166603`*^9, 3.588624027284537*^9}, {3.5886240599556885`*^9, 
   3.58862416995759*^9}, {3.588624269166215*^9, 3.588624285773308*^9}, {
   3.5886243971322536`*^9, 3.588624419355056*^9}, {3.5886245190507307`*^9, 
   3.588624563248348*^9}, 3.5886247246296415`*^9, {3.588624782061962*^9, 
   3.5886248306673255`*^9}, {3.588624896437702*^9, 3.588624896658709*^9}, {
   3.588625226739682*^9, 3.5886252287389174`*^9}, {3.5886253585014095`*^9, 
   3.5886253606436996`*^9}, {3.5886265170141554`*^9, 3.588626530563859*^9}, {
   3.5886266141204786`*^9, 3.5886267144109917`*^9}, {3.588626812730488*^9, 
   3.588626823478854*^9}, {3.588626964889826*^9, 3.5886269700964003`*^9}, {
   3.588627002559368*^9, 3.5886270062518334`*^9}, {3.5886273377242713`*^9, 
   3.588627409087323*^9}, {3.58862746453437*^9, 3.588627499058758*^9}, {
   3.5886275634659433`*^9, 3.58862759425886*^9}, {3.588627670620802*^9, 
   3.588627677759704*^9}, 3.5886277087456408`*^9, {3.5886278223738656`*^9, 
   3.588627826167367*^9}, {3.5886279195237956`*^9, 3.588627948269431*^9}, {
   3.588628132704527*^9, 3.588628137911189*^9}, {3.5886283259640894`*^9, 
   3.5886283342561455`*^9}, {3.5886284143223205`*^9, 3.588628453987382*^9}, {
   3.5886285056474695`*^9, 3.588628511674235*^9}, {3.5886285613015614`*^9, 
   3.588628579886902*^9}, {3.588628732863347*^9, 3.588628766762655*^9}, {
   3.588628802056138*^9, 3.5886288079298882`*^9}, 3.5886288445395594`*^9, {
   3.5886295557800407`*^9, 3.588629630097466*^9}, {3.588629674465103*^9, 
   3.5886296752202024`*^9}, {3.5886297364069777`*^9, 
   3.5886297933012104`*^9}, {3.588629932176783*^9, 3.5886299652990103`*^9}, {
   3.588630752277425*^9, 3.5886307746942644`*^9}, {3.5886308200770288`*^9, 
   3.5886308261768036`*^9}, {3.5886308949505672`*^9, 
   3.5886309274076705`*^9}, {3.588630976035872*^9, 3.588631003140298*^9}, {
   3.5886310444775553`*^9, 3.5886310534407096`*^9}, {3.5886312411855497`*^9, 
   3.5886313193874874`*^9}, {3.5886318372563133`*^9, 3.588631843052047*^9}, {
   3.588631911483745*^9, 3.5886319217310467`*^9}, {3.5886319595578613`*^9, 
   3.588631976449933*^9}, {3.5886320709739623`*^9, 3.588632096182143*^9}, 
   3.5886321476907063`*^9, {3.58863231580906*^9, 3.588632570505434*^9}, {
   3.5886326068420525`*^9, 3.5886326588886595`*^9}, {3.588633003626479*^9, 
   3.5886330058487577`*^9}, {3.588633230610324*^9, 3.588633245642234*^9}, {
   3.5886332843238015`*^9, 3.588633326375142*^9}, {3.588633596710497*^9, 
   3.588633603488363*^9}, {3.588634643371643*^9, 3.5886346538529744`*^9}, {
   3.5886349622441673`*^9, 3.5886350174761896`*^9}, 3.5886353571386223`*^9, {
   3.5886354868220882`*^9, 3.5886354870221195`*^9}, 3.588635860708499*^9, {
   3.5886359177777576`*^9, 3.588635923274466*^9}, {3.5886360086713076`*^9, 
   3.588636011760697*^9}, {3.588636065799567*^9, 3.588636077126025*^9}, {
   3.588636203128744*^9, 3.5886362382612133`*^9}, {3.5886363846444693`*^9, 
   3.588636392622481*^9}, {3.5886376065527825`*^9, 3.5886376107083125`*^9}, {
   3.5886377561427903`*^9, 3.5886377562648087`*^9}, {3.5886378226242423`*^9, 
   3.5886378265247355`*^9}, 3.5886379228169765`*^9, {3.5886380346413517`*^9, 
   3.5886380690877347`*^9}, {3.588638347448928*^9, 3.5886384052880335`*^9}, 
   3.5886385372335253`*^9, {3.5886385737251606`*^9, 3.5886386122920647`*^9}, 
   3.5886387153719254`*^9, {3.588638870776678*^9, 3.588638871506768*^9}, {
   3.5886390081876907`*^9, 3.5886390090947876`*^9}, 3.5886397990102587`*^9, {
   3.588639880188559*^9, 3.588639880272571*^9}, {3.5886401007635994`*^9, 
   3.588640104195052*^9}, {3.5886402292572365`*^9, 3.5886402385544214`*^9}, {
   3.5886403253748446`*^9, 3.5886403254438534`*^9}, {3.588640450355853*^9, 
   3.588640450563878*^9}, {3.5886406207302113`*^9, 3.5886406230525217`*^9}, 
   3.5886406836812067`*^9, 3.5886407774781303`*^9, {3.588640816387094*^9, 
   3.588640816849134*^9}, {3.5886414612551994`*^9, 3.5886414634284716`*^9}, {
   3.5886423657336826`*^9, 3.5886423674569044`*^9}, {3.5886431662212453`*^9, 
   3.588643170897824*^9}, {3.5886447812942085`*^9, 3.5886448048261986`*^9}, {
   3.5886461137273407`*^9, 3.5886461154695644`*^9}, 3.588860365423103*^9, {
   3.588860523178139*^9, 3.5888605737835703`*^9}, {3.5888606868959446`*^9, 
   3.588860706714466*^9}, {3.5888607416199017`*^9, 3.5888608009794655`*^9}, {
   3.5888608990899343`*^9, 3.5888609207406683`*^9}, {3.588861046365653*^9, 
   3.5888610467876883`*^9}, {3.5888611244125547`*^9, 
   3.5888611414887238`*^9}, {3.588861186662464*^9, 3.5888612184074993`*^9}, {
   3.5888612562303257`*^9, 3.5888613170557103`*^9}, {3.588861387374645*^9, 
   3.5888614441652384`*^9}, {3.588861489515253*^9, 3.5888615203094387`*^9}, {
   3.5888615543827524`*^9, 3.5888615970441732`*^9}, {3.58886303644121*^9, 
   3.588863052154207*^9}, {3.5888633578157387`*^9, 3.588863368504097*^9}, {
   3.5888639710007553`*^9, 3.5888639844134665`*^9}, {3.588864216678744*^9, 
   3.58886432656571*^9}, {3.588864398426843*^9, 3.588864398934908*^9}, {
   3.588864431666064*^9, 3.588864464585252*^9}, {3.5888647081980033`*^9, 
   3.588864738822899*^9}, {3.5888649579676275`*^9, 3.5888649652895737`*^9}, {
   3.5888715722303877`*^9, 3.588871587098284*^9}, {3.5888842763539066`*^9, 
   3.588884281689585*^9}, {3.588884320862564*^9, 3.588884325769188*^9}, {
   3.588884393823688*^9, 3.588884443072934*^9}, {3.5888845773363857`*^9, 
   3.5888845997639403`*^9}, {3.588884633987277*^9, 3.588884683811613*^9}, {
   3.5888847305605645`*^9, 3.588884736303281*^9}, {3.5888848382092323`*^9, 
   3.5888849099573517`*^9}, {3.5888852579925537`*^9, 3.588885316738016*^9}, {
   3.5888854199578314`*^9, 3.5888854489185114`*^9}, {3.588885531433999*^9, 
   3.5888855648342633`*^9}, {3.588886744889716*^9, 3.588886761533242*^9}, {
   3.588887079132234*^9, 3.588887160021511*^9}, {3.588887209339779*^9, 
   3.5888872096138134`*^9}, {3.5888880673060417`*^9, 
   3.5888880674320593`*^9}, {3.5888889466661673`*^9, 
   3.5888889493175077`*^9}, {3.5888890314629407`*^9, 
   3.5888890334171963`*^9}, {3.5888890830748415`*^9, 3.588889090587798*^9}, {
   3.588889139392003*^9, 3.58888916825767*^9}, {3.5888892235366955`*^9, 
   3.588889241336958*^9}, {3.5888892868797464`*^9, 3.588889309752654*^9}, {
   3.5888893624743724`*^9, 3.588889422603712*^9}, {3.588889544145141*^9, 
   3.5888895507469807`*^9}, {3.588889735999525*^9, 3.588889792819766*^9}, {
   3.5888900339984007`*^9, 3.588890036787753*^9}, {3.5888900743615284`*^9, 
   3.5888900861440306`*^9}, {3.5888901511303053`*^9, 3.588890155969901*^9}, {
   3.588890217938774*^9, 3.5888902241925735`*^9}, {3.588890302418359*^9, 
   3.5888903473750725`*^9}, {3.588891569523077*^9, 3.5888915843739653`*^9}, 
   3.5888916185333104`*^9, {3.5888917313369884`*^9, 3.588891737158748*^9}, {
   3.5888918029607763`*^9, 3.5888918083304787`*^9}, {3.588891894473236*^9, 
   3.588891895814423*^9}, {3.5888919312259088`*^9, 3.588891955316965*^9}, {
   3.588892051472207*^9, 3.5888922112653832`*^9}, {3.5888923646761622`*^9, 
   3.588892399691609*^9}, {3.588894057143903*^9, 3.5888940582590404`*^9}, {
   3.588894978208287*^9, 3.588894982917886*^9}, {3.588901572374728*^9, 
   3.5889015784275007`*^9}, {3.588903157684205*^9, 3.58890316209077*^9}, {
   3.5889032189570127`*^9, 3.5889032236645947`*^9}, {3.588903310322605*^9, 
   3.5889033107276564`*^9}, {3.588903693981073*^9, 3.5889036992827663`*^9}, 
   3.5914597131385493`*^9, 3.591459750607374*^9, {3.5914871430813317`*^9, 
   3.5914871489886713`*^9}, 3.591489673670844*^9, 3.591490358491062*^9, {
   3.591492651353367*^9, 3.5914926858903437`*^9}, {3.591493060067789*^9, 
   3.591493101768162*^9}, {3.591493132851941*^9, 3.591493135690104*^9}, {
   3.5914932099403563`*^9, 3.591493391550759*^9}, {3.5914934639088984`*^9, 
   3.5914934975598264`*^9}, {3.591493559488373*^9, 3.591493561628495*^9}, {
   3.591493600859742*^9, 3.5914936022118196`*^9}, {3.591494157810636*^9, 
   3.5914941598797565`*^9}, 3.59149431694375*^9, {3.5914943699818087`*^9, 
   3.591494402876693*^9}, {3.591494471737631*^9, 3.591494498953173*^9}, {
   3.591494619701089*^9, 3.5914946328438435`*^9}, {3.591494900382183*^9, 
   3.591494904959424*^9}, {3.591498329696546*^9, 3.5914983377040043`*^9}, 
   3.591498374036085*^9, 3.591498411261217*^9, {3.591498730821518*^9, 
   3.5914988048787584`*^9}, {3.5914994185749025`*^9, 
   3.5914994749301295`*^9}, {3.591499534565544*^9, 3.5914995504894557`*^9}, {
   3.591499807458173*^9, 3.591499834948747*^9}, {3.5914998817464266`*^9, 
   3.5914998923640347`*^9}, {3.5915000189252844`*^9, 3.591500057475491*^9}, {
   3.5915001416173096`*^9, 3.5915001482306876`*^9}, {3.591500235372678*^9, 
   3.5915002390598893`*^9}, 3.5915002790831804`*^9, {3.591500381547048*^9, 
   3.59150039309871*^9}, {3.591500471552203*^9, 3.5915004782455864`*^9}, {
   3.5915024872706366`*^9, 3.5915024893407564`*^9}, {3.5915028615710707`*^9, 
   3.5915029338452096`*^9}, {3.5915030019701138`*^9, 3.591503004479273*^9}, {
   3.591503257337735*^9, 3.591503258571808*^9}, {3.5915038518401885`*^9, 
   3.591503853215187*^9}, {3.591503971090418*^9, 3.591504007246739*^9}, {
   3.591504134434489*^9, 3.5915041542157755`*^9}, {3.591532091892812*^9, 
   3.5915320923771877`*^9}, {3.591543051035842*^9, 3.591543051520217*^9}, {
   3.5915439817564125`*^9, 3.5915439840064173`*^9}, {3.591669941038602*^9, 
   3.5916699651949887`*^9}, {3.5916700337759137`*^9, 
   3.5916700547291126`*^9}, {3.591670091482214*^9, 3.5916701110773373`*^9}, {
   3.591670258859807*^9, 3.5916702747607293`*^9}, {3.591670371075229*^9, 
   3.591670416258835*^9}, {3.5916707655828204`*^9, 3.5916707663008614`*^9}, {
   3.5916709338324747`*^9, 3.591670946262168*^9}, {3.5916710605987115`*^9, 
   3.591671069618233*^9}, {3.5916711363850555`*^9, 3.591671142041398*^9}, {
   3.591720901677477*^9, 3.5917209395056705`*^9}, {3.5917211840217896`*^9, 
   3.591721190553047*^9}, {3.591721426850375*^9, 3.591721427319127*^9}, {
   3.591722973614787*^9, 3.5917229843648033`*^9}, 3.5917554736407785`*^9, {
   3.5918259898805466`*^9, 3.5918260364082108`*^9}, {3.591826081184752*^9, 
   3.5918261091033545`*^9}, {3.5918262227358627`*^9, 3.5918262530225945`*^9}, 
   3.5918264983536463`*^9, {3.591826552261733*^9, 3.591826603246653*^9}, {
   3.5918266602309165`*^9, 3.5918266664862742`*^9}, {3.591826698862131*^9, 
   3.591826713509966*^9}, {3.591826760829681*^9, 3.591826773998431*^9}, {
   3.591826814206753*^9, 3.591826817758938*^9}, {3.5918268560541277`*^9, 
   3.5918268787264285`*^9}, {3.5918301698558965`*^9, 3.591830269992635*^9}, {
   3.59183047856958*^9, 3.59183054078614*^9}, {3.5918307903954372`*^9, 
   3.5918307908664637`*^9}, {3.59183091459655*^9, 3.5918309290323753`*^9}, {
   3.59183103038118*^9, 3.5918310706334853`*^9}, 3.591831148137925*^9, {
   3.5919311335390444`*^9, 3.5919311865550804`*^9}, {3.5919312494996853`*^9, 
   3.59193132170582*^9}, {3.5919313630811896`*^9, 3.59193136448227*^9}, {
   3.5919313959080696`*^9, 3.591931398331208*^9}, {3.5919315777224813`*^9, 
   3.591931602694907*^9}, {3.5919316383109508`*^9, 3.5919316393160086`*^9}, {
   3.591931676226123*^9, 3.5919317867614527`*^9}, {3.591932539095533*^9, 
   3.5919325900304565`*^9}, {3.591932662167584*^9, 3.59193269842566*^9}, {
   3.5919336858032*^9, 3.591933715567909*^9}, {3.5919338864146934`*^9, 
   3.5919341526519575`*^9}, {3.5919344221842074`*^9, 3.591934431944763*^9}, {
   3.591935088694376*^9, 3.5919351058043523`*^9}, {3.5919635215600405`*^9, 
   3.591963577000235*^9}, 3.5919636207447205`*^9, {3.5919637695882616`*^9, 
   3.591963772761429*^9}, {3.591963862131549*^9, 3.591963945807338*^9}, {
   3.5919640436259403`*^9, 3.591964063822097*^9}, {3.5919642073443155`*^9, 
   3.5919642181209326`*^9}, {3.5919658796690893`*^9, 3.591965888813607*^9}, {
   3.5919659710243134`*^9, 3.5919660501698523`*^9}, 3.591966414726723*^9, {
   3.5919665832013693`*^9, 3.591966586108558*^9}, {3.5919666902164965`*^9, 
   3.591966763159698*^9}, {3.591966907214932*^9, 3.5919669258369946`*^9}, {
   3.5919669973460894`*^9, 3.5919670006722765`*^9}, {3.591967325434878*^9, 
   3.5919673503103027`*^9}, {3.59196739122465*^9, 3.5919674086216607`*^9}, {
   3.591967518165934*^9, 3.5919675236412277`*^9}, {3.5919676233479385`*^9, 
   3.591967685394489*^9}, {3.5919679490865927`*^9, 3.591967960879272*^9}, {
   3.591967992922103*^9, 3.591968018706579*^9}, {3.591968094305909*^9, 
   3.5919681044634905`*^9}, 3.59196814950207*^9, {3.5919682109965873`*^9, 
   3.5919682220952272`*^9}, {3.591968331188474*^9, 3.591968333007574*^9}, {
   3.591968916191976*^9, 3.591968947416768*^9}, {3.591968992284333*^9, 
   3.591969078972293*^9}, {3.5919691418809*^9, 3.5919691646592083`*^9}, {
   3.591969219010312*^9, 3.591969222032494*^9}, {3.591969272425376*^9, 
   3.5919693149058084`*^9}, {3.59196936102645*^9, 3.5919695112900543`*^9}, {
   3.591969742317304*^9, 3.591969778888378*^9}, {3.5919698349765916`*^9, 
   3.5919699005123405`*^9}, {3.5919700065034113`*^9, 
   3.5919700173780346`*^9}, {3.591970099600746*^9, 3.591970111023403*^9}, {
   3.5919701471124663`*^9, 3.5919702156553917`*^9}, {3.5919702555916834`*^9, 
   3.5919703064705963`*^9}, {3.5919704222892213`*^9, 3.591970426898488*^9}, {
   3.5919706361224704`*^9, 3.591970672050527*^9}, {3.5919707022892756`*^9, 
   3.5919707846559763`*^9}, {3.591970817640865*^9, 3.591970820468027*^9}, {
   3.591970882703591*^9, 3.5919709540366745`*^9}, {3.5919710737145295`*^9, 
   3.591971136037117*^9}, {3.591971199169716*^9, 3.5919712038809834`*^9}, {
   3.5919712349807835`*^9, 3.591971290144924*^9}, {3.591971321250701*^9, 
   3.591971322078752*^9}, {3.591971366807314*^9, 3.591971370453523*^9}, {
   3.59197144947705*^9, 3.591971452716234*^9}, {3.5919715862398806`*^9, 
   3.591971589876092*^9}, {3.591971696062169*^9, 3.591971745267987*^9}, {
   3.5919718031022987`*^9, 3.5919718083496*^9}, {3.591971867808004*^9, 
   3.5919718874791307`*^9}, {3.5919719700568604`*^9, 
   3.5919719932041855`*^9}, {3.591972081054221*^9, 3.591972104012548*^9}, {
   3.5919734454323483`*^9, 3.591973468920699*^9}, {3.591974011699778*^9, 
   3.591974013438878*^9}, {3.5919808609350104`*^9, 3.5919808612090263`*^9}, {
   3.5919810618485136`*^9, 3.5919811361027727`*^9}, 3.591981244015953*^9, {
   3.5919812930867586`*^9, 3.591981293308771*^9}, {3.5919814163888197`*^9, 
   3.5919814817125607`*^9}, {3.5919815160725284`*^9, 3.591981537998784*^9}, {
   3.5919815734578147`*^9, 3.591981576809024*^9}, {3.5919816509402514`*^9, 
   3.59198165791965*^9}, {3.5919818629693937`*^9, 3.5919818980884047`*^9}, {
   3.5919824239855223`*^9, 3.591982460789629*^9}, {3.591982492748459*^9, 
   3.591982594051259*^9}, {3.5919826250910397`*^9, 3.5919826280892096`*^9}, {
   3.5919843474556704`*^9, 3.5919844042699256`*^9}, {3.591985237686652*^9, 
   3.591985238045673*^9}, {3.59198550416591*^9, 3.5919855590930777`*^9}, {
   3.59198559649922*^9, 3.591985631085181*^9}, {3.59198574334461*^9, 
   3.591985936819685*^9}, {3.591985966826404*^9, 3.5919859850104465`*^9}, {
   3.591986016059227*^9, 3.5919860187603817`*^9}, {3.5919860573545923`*^9, 
   3.5919861335549555`*^9}, {3.59198616525079*^9, 3.5919863629700933`*^9}, 
   3.591986501619033*^9, {3.5919865545720663`*^9, 3.5919865562011595`*^9}, {
   3.591988154043663*^9, 3.5919882460329304`*^9}, {3.59198844788949*^9, 
   3.5919885376516294`*^9}, {3.59198886050712*^9, 3.5919888616751833`*^9}, {
   3.591989095229561*^9, 3.59198914323331*^9}, {3.591989447091711*^9, 
   3.591989455011165*^9}, {3.591989485289898*^9, 3.591989588515809*^9}, {
   3.591990221156039*^9, 3.5919902383710246`*^9}, {3.5919904023634167`*^9, 
   3.59199040753971*^9}, {3.5920191222541075`*^9, 3.5920191513447733`*^9}, {
   3.592019251794526*^9, 3.5920192541006575`*^9}, {3.5920193075877204`*^9, 
   3.5920193079677463`*^9}, {3.5920211144551935`*^9, 
   3.5920211906475573`*^9}, {3.5920212308898616`*^9, 
   3.5920212309528666`*^9}, {3.592021408762048*^9, 3.5920214125502663`*^9}, {
   3.5920215956877527`*^9, 3.5920216271285534`*^9}, {3.5920217520357065`*^9, 
   3.592021757851034*^9}, {3.592021854305563*^9, 3.5920218576557503`*^9}, {
   3.5920218951319013`*^9, 3.5920219376553364`*^9}, {3.5920220668367343`*^9, 
   3.592022084843765*^9}, {3.5920221221168995`*^9, 3.5920221291793056`*^9}, {
   3.5920221848515005`*^9, 3.5920222079158125`*^9}, {3.592022260668838*^9, 
   3.59202231044368*^9}, {3.5920233491791697`*^9, 3.5920234177130976`*^9}, {
   3.5920234781785564`*^9, 3.592023499753792*^9}, {3.592023649647376*^9, 
   3.5920236750338483`*^9}, {3.592023759600672*^9, 3.5920237706573057`*^9}, {
   3.592023858000308*^9, 3.592023871612087*^9}, {3.592023909226241*^9, 
   3.5920239136334934`*^9}, {3.5920239706827602`*^9, 3.59202397275988*^9}, {
   3.592024050467326*^9, 3.592024053852524*^9}, {3.5920242516398497`*^9, 
   3.5920242522718863`*^9}, {3.5920243099851866`*^9, 
   3.5920243314414225`*^9}, {3.592024367419481*^9, 3.5920243797131844`*^9}, {
   3.5920244113219953`*^9, 3.5920244355843844`*^9}, {3.5920244749216504`*^9, 
   3.592024540296382*^9}, {3.59202495781929*^9, 3.5920249646766834`*^9}, {
   3.5920261122994037`*^9, 3.592026163535356*^9}, {3.5920262250508623`*^9, 
   3.5920262258009043`*^9}, {3.592026353116192*^9, 3.5920263586745167`*^9}, {
   3.5920268552929497`*^9, 3.5920268893559*^9}, 3.5920270729594126`*^9, 
   3.592027111741639*^9, {3.592027213803483*^9, 3.5920273053397284`*^9}, {
   3.592027354686551*^9, 3.592027503192069*^9}, 3.592027739368584*^9, {
   3.592027807353473*^9, 3.5920278566703014`*^9}, {3.592027932934663*^9, 
   3.5920279469414716`*^9}, {3.592028086095437*^9, 3.5920280866294856`*^9}, {
   3.592028150280136*^9, 3.5920281679351225`*^9}, {3.5920282966624947`*^9, 
   3.5920283207438745`*^9}, {3.592028376097044*^9, 3.5920284159013233`*^9}, {
   3.5920286515518155`*^9, 3.592028669837861*^9}, 3.592028832530186*^9, 
   3.592028879106868*^9, {3.59202969739671*^9, 3.592029780606475*^9}, {
   3.5920299758696527`*^9, 3.5920300202762003`*^9}, {3.5920307968323555`*^9, 
   3.5920308540006275`*^9}, {3.5920309340882154`*^9, 3.592030942078673*^9}, {
   3.592031025742468*^9, 3.5920310689589386`*^9}, {3.5920536235012884`*^9, 
   3.5920536292766104`*^9}, 3.5920920366420693`*^9, {3.5920920748732586`*^9, 
   3.5920920839287777`*^9}, {3.5920921188567944`*^9, 
   3.5920921237280517`*^9}, {3.592092245785046*^9, 3.592092249064253*^9}, {
   3.5920923530341873`*^9, 3.5920923843299775`*^9}, {3.592092431574685*^9, 
   3.5920924322787294`*^9}, {3.5920926309180975`*^9, 
   3.5920926522483206`*^9}, {3.5920927206542397`*^9, 3.592092802566931*^9}, {
   3.592092850431676*^9, 3.5920928519997625`*^9}, {3.5920929386157227`*^9, 
   3.59209301847129*^9}, {3.592093067837122*^9, 3.5920931586533227`*^9}, {
   3.5920941412965956`*^9, 3.5920941464958935`*^9}, {3.5920944109370365`*^9, 
   3.5920944407417436`*^9}, {3.5920948905745087`*^9, 
   3.5920948964368396`*^9}, {3.592095505386712*^9, 3.5920955178874283`*^9}, {
   3.5920958320944223`*^9, 3.59209585731087*^9}, {3.592096107532195*^9, 
   3.59209615325781*^9}, {3.592096214596327*^9, 3.592096275755825*^9}, {
   3.5920967434426165`*^9, 3.592096756278346*^9}, {3.5920968301675787`*^9, 
   3.5920968477995853`*^9}, {3.59209703432327*^9, 3.5920971100366054`*^9}, 
   3.5920976792472024`*^9, {3.5920980579698906`*^9, 3.5920980771519885`*^9}, {
   3.592098110919923*^9, 3.592098155351471*^9}, {3.5921048667628045`*^9, 
   3.592104903685919*^9}, {3.5921049353997374`*^9, 3.5921049562259445`*^9}, {
   3.592104998602357*^9, 3.592105071698543*^9}, {3.5921051377633233`*^9, 
   3.5921051400214562`*^9}, {3.5921051763245344`*^9, 3.59210519195243*^9}, {
   3.5921052309746637`*^9, 3.5921052323227415`*^9}, {3.5921063442544184`*^9, 
   3.592106346948591*^9}, {3.592110015011635*^9, 3.5921100185498314`*^9}, {
   3.5921106985877805`*^9, 3.592110699631854*^9}, {3.592112351747447*^9, 
   3.5921124442277575`*^9}, {3.592112485249092*^9, 3.592112509319472*^9}, {
   3.5921125511578703`*^9, 3.592112578183414*^9}, {3.5921130314643717`*^9, 
   3.5921130354486*^9}, {3.5921175937996426`*^9, 3.5921175942786646`*^9}, {
   3.5921176390322313`*^9, 3.59211765781631*^9}, {3.5921177193428354`*^9, 
   3.5921177570999937`*^9}, {3.5921178177504663`*^9, 
   3.5921178260369377`*^9}, {3.5921178779349165`*^9, 
   3.5921179512931147`*^9}, {3.5921180221891737`*^9, 3.592118033492821*^9}, {
   3.592124147733387*^9, 3.5921242210195913`*^9}, {3.5921242560705957`*^9, 
   3.592124259242778*^9}, {3.592124378582611*^9, 3.5921243803017287`*^9}, {
   3.592124435895894*^9, 3.592124441207198*^9}, {3.59212447967741*^9, 
   3.5921245605310307`*^9}, {3.592152543221595*^9, 3.592152618142889*^9}, {
   3.5921526731930566`*^9, 3.5921526733290453`*^9}, {3.5921529158269324`*^9, 
   3.5921529389462566`*^9}, {3.592153054945899*^9, 3.592153056436984*^9}, 
   3.592153089027851*^9, {3.5921800169339256`*^9, 3.592180057502246*^9}, {
   3.592180146639349*^9, 3.5921803679880247`*^9}, {3.5921803981457663`*^9, 
   3.5921804310816383`*^9}, {3.592180483553643*^9, 3.592180515165453*^9}, {
   3.5921805973291583`*^9, 3.5921806070917177`*^9}, {3.5921807813326917`*^9, 
   3.5921808111544037`*^9}, 3.5921808461234064`*^9, {3.5921811366380424`*^9, 
   3.59218115295498*^9}, {3.592181188791048*^9, 3.5921811889170375`*^9}, {
   3.592181239835953*^9, 3.592181249089486*^9}, {3.5921812920669413`*^9, 
   3.5921812921369486`*^9}, {3.5921815868728266`*^9, 
   3.5921815891119547`*^9}, {3.592181870747078*^9, 3.5921818734962406`*^9}, 
   3.59218208888758*^9, {3.5921821893503265`*^9, 3.592182249659778*^9}, {
   3.5921825273226833`*^9, 3.592182528582755*^9}, {3.5921826427972937`*^9, 
   3.5921826503587384`*^9}, {3.5921879640072093`*^9, 
   3.5921879691885223`*^9}, {3.5921880522502604`*^9, 3.592188057812592*^9}, {
   3.592188329703144*^9, 3.592188343532941*^9}, {3.603128549150799*^9, 
   3.6031285732371964`*^9}, {3.6031286186287766`*^9, 3.603128628672353*^9}, {
   3.6031296168749437`*^9, 3.6031296276175585`*^9}, {3.6031297562419214`*^9, 
   3.603129756544942*^9}, {3.603129822718731*^9, 3.6031298337723613`*^9}, 
   3.6031298764738097`*^9, {3.603129910654764*^9, 3.60312992904282*^9}, {
   3.603129963672803*^9, 3.603130102657762*^9}, {3.603130149910468*^9, 
   3.603130161244117*^9}, {3.603130210976965*^9, 3.6031302127520666`*^9}, {
   3.603130295840825*^9, 3.603130302269193*^9}, {3.603130332667934*^9, 
   3.603130429375472*^9}, {3.603130467012627*^9, 3.6031305011695843`*^9}, {
   3.603130636716346*^9, 3.603130645301838*^9}, {3.6031307651647015`*^9, 
   3.6031308263112035`*^9}, {3.6031309343693914`*^9, 
   3.6031310113928022`*^9}, {3.603131043256627*^9, 3.6031310464768276`*^9}, {
   3.603131079066677*^9, 3.6031311636835356`*^9}, {3.603131204700872*^9, 
   3.603131210721217*^9}, {3.603131247927348*^9, 3.603131263760256*^9}, {
   3.6031313014224105`*^9, 3.603131507726226*^9}, {3.6031315525837946`*^9, 
   3.603131553747861*^9}, {3.6031315838785872`*^9, 3.6031316142253237`*^9}, {
   3.6031316623430805`*^9, 3.6031317326691074`*^9}, {3.6031318157788663`*^9, 
   3.6031318418963604`*^9}, {3.603131949302513*^9, 3.6031320419118176`*^9}, {
   3.603132081725096*^9, 3.603132096761954*^9}, {3.60313217517245*^9, 
   3.6031321753704596`*^9}, {3.603132215063732*^9, 3.6031322664656763`*^9}, {
   3.603132298679521*^9, 3.6031322990695405`*^9}, {3.603132381546263*^9, 
   3.6031323817362766`*^9}, {3.6031325974946337`*^9, 
   3.6031326485065727`*^9}, {3.6031326856216793`*^9, 
   3.6031326859156933`*^9}, {3.6031327857054105`*^9, 3.603132786702468*^9}, {
   3.603133104313657*^9, 3.6031331057507577`*^9}, {3.6031333757352*^9, 
   3.6031333771092787`*^9}, {3.60313358067295*^9, 3.603133643328524*^9}, {
   3.603133679139576*^9, 3.603133771447857*^9}, {3.603134607653747*^9, 
   3.6031346222775826`*^9}, {3.603134767903925*^9, 3.6031347688859806`*^9}, {
   3.603135023776578*^9, 3.603135031718032*^9}, {3.603135090955426*^9, 
   3.603135111515603*^9}, {3.603135626255077*^9, 3.603135627235133*^9}, {
   3.6031364923816795`*^9, 3.6031364944797993`*^9}, {3.603137387022912*^9, 
   3.603137387091916*^9}, {3.603137761669367*^9, 3.6031377855177326`*^9}, {
   3.6031378493993917`*^9, 3.6031378594169655`*^9}, {3.603137909154814*^9, 
   3.6031379095498333`*^9}, {3.6031380734492216`*^9, 3.603138090953224*^9}, {
   3.6031382421168833`*^9, 3.603138245417065*^9}, {3.6031383054745092`*^9, 
   3.6031383136709785`*^9}, {3.603138350221073*^9, 3.6031383795707493`*^9}, {
   3.6031386146642156`*^9, 3.6031386524383783`*^9}, {3.603138725372569*^9, 
   3.6031387697770987`*^9}, {3.6031390588856544`*^9, 
   3.6031390736855025`*^9}, {3.603143207190213*^9, 3.603143207897254*^9}, {
   3.6031434292139273`*^9, 3.6031434303709917`*^9}, {3.6031434929315767`*^9, 
   3.6031435102455683`*^9}, {3.603143565360726*^9, 3.6031435740712233`*^9}, {
   3.603143630740469*^9, 3.6031436812913637`*^9}, {3.6031438041123967`*^9, 
   3.6031438069925632`*^9}, {3.6031439657706547`*^9, 
   3.6031439671377335`*^9}, {3.603144066351414*^9, 3.603144066850441*^9}, {
   3.6031452281839495`*^9, 3.603145233868274*^9}, {3.603145919697549*^9, 
   3.60314592354877*^9}, {3.6031464899852076`*^9, 3.603146499373744*^9}, {
   3.6031466897646503`*^9, 3.603146708963748*^9}, {3.6031468402012634`*^9, 
   3.603146840503281*^9}, {3.603197507581769*^9, 3.6031975277049217`*^9}, 
   3.604794246491231*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"user", " ", 
     RowBox[{"inputs", ":", " ", "x"}]}], ",", " ", 
    RowBox[{"dx", ";", "\[IndentingNewLine]", 
     RowBox[{"zeroed", " ", 
      RowBox[{"inputs", ":", " ", "duJ"}]}]}], ",", " ", "dv", ",", " ", "da",
     ",", " ", 
    RowBox[{"df", ";", "\[IndentingNewLine]", 
     RowBox[{"computed", " ", 
      RowBox[{"inputs", ":", " ", "v"}]}]}], ",", " ", "a", ",", " ", "f", 
    ",", " ", "s", ",", " ", "ag", ",", " ", "XL", ",", " ", "dXL", ",", " ", 
    "\[DoubleStruckCapitalI]", ",", " ", "parent", ",", " ", 
    RowBox[{"nq", ";", "\[IndentingNewLine]", 
     RowBox[{"modifies", ":", " ", "duJ"}]}], ",", " ", "dv", ",", " ", "da", 
    ",", " ", 
    RowBox[{"df", ";", "\[IndentingNewLine]", 
     RowBox[{"output", ":", " ", "duJ"}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dRNEA", "[", 
     RowBox[{"x_", ",", " ", "dx_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vJ", ",", " ", "dvJ", ",", " ", "p"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"clear", "/", "set"}], " ", "spatial", " ", "variables"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dv", " ", "=", " ", "Zdspat"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"spatial", " ", "velocity"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"da", " ", "=", " ", "Zdspat"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"spatial", " ", "acceleration"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"df", " ", "=", " ", "Zdspat"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"spatial", " ", "force"}], " ", "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"clear", " ", "RNEA", " ", "variables"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"duJ", " ", "=", " ", "Znq"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"C", "-", 
         RowBox[{"space", " ", "forces"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"calc", " ", "duJ"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
           "parent", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"vJ", " ", "=", " ", 
           RowBox[{
            RowBox[{
            "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dvJ", " ", "=", " ", 
           RowBox[{
            RowBox[{"tensprod", "[", 
             RowBox[{
              RowBox[{
              "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{"dx", "\[LeftDoubleBracket]", 
               RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}], "]"}], 
            " ", "+", " ", 
            RowBox[{
             RowBox[{
             "dsJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{"outer", " ", "product"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", " ", "\[Equal]", " ", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "only", " ", "use", " ", "relative", " ", "link", " ", 
              "velocity"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", "dvJ"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "da", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{"dXb", "[", 
               RowBox[{
                RowBox[{
                "dXL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                 ",", " ", "ag"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
             " ", 
            RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"add", " ", 
              RowBox[{"parent", "'"}], "s", " ", "value"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{"dvdq", "[", 
                RowBox[{
                 RowBox[{
                 "dXL", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", " ", 
                 RowBox[{
                 "v", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], 
                 ",", " ", 
                 RowBox[{
                 "dx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  ",", " ", 
                 RowBox[{
                 "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  ",", " ", 
                 RowBox[{
                 "dv", "\[LeftDoubleBracket]", "p", 
                  "\[RightDoubleBracket]"}]}], "]"}], " ", "+", " ", 
               "dvJ"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "da", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{"dvdq", "[", 
                RowBox[{
                 RowBox[{
                 "dXL", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", " ", 
                 RowBox[{
                 "a", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], 
                 ",", " ", 
                 RowBox[{
                 "dx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  ",", " ", 
                 RowBox[{
                 "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  ",", " ", 
                 RowBox[{
                 "da", "\[LeftDoubleBracket]", "p", 
                  "\[RightDoubleBracket]"}]}], "]"}], "  ", "+", " ", 
               RowBox[{"dadv", "[", 
                RowBox[{"vJ", ",", " ", 
                 RowBox[{
                 "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 ",", " ", "dvJ", ",", " ", 
                 RowBox[{
                 "dv", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "da", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
            "da", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ",
             "+", " ", 
            RowBox[{
             RowBox[{
             "dsJdot", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}], " ", "+",
             " ", 
            RowBox[{"tensprod", "[", 
             RowBox[{
              RowBox[{
              "sJdot", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", " ", 
              RowBox[{"dx", "\[LeftDoubleBracket]", 
               RowBox[{"nq", "+", "i"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "da", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "+=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                "dsJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                 " ", 
                RowBox[{
                "qdd", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], " ", "+", " ", 
               RowBox[{
                RowBox[{
                "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                " ", 
                RowBox[{
                "dqdd", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}]}], ";"}], " ", "<", 
            RowBox[{
             RowBox[{"-", " ", "complete"}], " ", "dRNEA"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "df", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ".", 
             RowBox[{
             "da", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            " ", "+", " ", 
            RowBox[{"dfdv", "[", 
             RowBox[{
              RowBox[{
              "v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{
              "\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", " ", 
              RowBox[{
              "dv", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "nq"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "duJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ",
            "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "sJ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ".", 
             RowBox[{
             "df", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            " ", "+", " ", 
            RowBox[{
             RowBox[{
             "f", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ".", 
             RowBox[{
             "dsJ", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
           "parent", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", " ", "\[NotEqual]", " ", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "df", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{
               "df", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], 
               " ", "+", " ", 
               RowBox[{"dXb", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "dXL", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "\[Transpose]"}], ",", " ", 
                 RowBox[{
                 "f", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}], " ", "+", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  "\[Transpose]"}], ".", 
                RowBox[{
                "df", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "nq", ",", " ", "1", ",", " ", 
           RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603196752554532*^9, 3.6031967540466175`*^9}, {
   3.6031967962910366`*^9, 3.603196861862792*^9}, {3.603196900624012*^9, 
   3.603196941168331*^9}, {3.60319698791901*^9, 3.603196988426039*^9}, {
   3.6031970876047196`*^9, 3.603197111166065*^9}, {3.6031971448779993`*^9, 
   3.603197147021121*^9}, {3.6031972018422613`*^9, 3.603197203555359*^9}, {
   3.6031972919534216`*^9, 3.6031973124415913`*^9}, {3.603197407986066*^9, 
   3.6031974391188498`*^9}, 3.6031981278952928`*^9, {3.6034273866810045`*^9, 
   3.6034274175807734`*^9}, {3.6034277768313475`*^9, 3.603427783560728*^9}, {
   3.6034278864986267`*^9, 3.6034278924099665`*^9}, {3.6034302484128857`*^9, 
   3.603430255588297*^9}, {3.6034305143471146`*^9, 3.603430530141019*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 3.5914868026208353`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{633, 504},
WindowMargins->{{Automatic, -8}, {Automatic, 182}},
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 86, "Section"],
Cell[682, 25, 1339, 19, 52, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2058, 49, 285, 5, 86, "Section"],
Cell[CellGroupData[{
Cell[2368, 58, 275, 5, 79, "Subsection"],
Cell[2646, 65, 38271, 623, 972, "Input",
 InitializationCell->True],
Cell[40920, 690, 13648, 318, 1032, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54617, 1014, 30, 0, 86, "Section"],
Cell[54650, 1016, 207, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
