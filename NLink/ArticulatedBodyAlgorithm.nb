(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    111118,       2398]
NotebookOptionsPosition[    109850,       2351]
NotebookOutlinePosition[    110225,       2367]
CellTagsIndexPosition[    110182,       2364]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<ABA`\>\"", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"functions", " ", "defined", " ", "in", " ", "Dynamics"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetModel", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial Vector Library", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678523159876`*^9, 3.591667856467229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"useful", " ", "matrices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"I2", " ", "=", " ", 
     RowBox[{"IdentityMatrix", "@", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I3", " ", "=", " ", 
     RowBox[{"IdentityMatrix", "@", "3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I6", " ", "=", " ", 
     RowBox[{"IdentityMatrix", "@", "6"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5888576814573565`*^9, 3.5888576965042715`*^9}, {
  3.588882259980151*^9, 3.58888229287833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cross", " ", "products"}], ",", " ", 
    RowBox[{
    "useful", " ", "for", " ", "coordinate", " ", "transforms", " ", "of", 
     " ", "spatial", " ", "velocities", " ", "and", " ", "forces"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"skew", "[", "x_", "]"}], " ", ":=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", 
         RowBox[{"-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         RowBox[{"x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]},
        {
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "0", 
         RowBox[{"-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]},
        {
         RowBox[{"-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "0"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mx", "[", "m_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"I2", ",", " ", 
        RowBox[{"skew", "@", 
         RowBox[{"m", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}]}]}], "]"}], " ",
       "+", " ", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0"},
           {"1", "0"}
          }], "\[NoBreak]", ")"}], ",", " ", 
        RowBox[{"skew", "@", 
         RowBox[{"m", "\[LeftDoubleBracket]", 
          RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}]}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mxstar", "[", "m_", "]"}], " ", ":=", " ", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"mx", "[", "m", "]"}], "\[Transpose]"}]}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588847733607463*^9, 3.588847759828424*^9}, {
  3.5888477905747843`*^9, 3.588847828252576*^9}, {3.588847862884996*^9, 
  3.5888478941729517`*^9}, {3.58884798336229*^9, 3.5888480472794127`*^9}, {
  3.588848279822406*^9, 3.5888482893396187`*^9}, {3.5888484022789187`*^9, 
  3.5888484565628166`*^9}, {3.5888484919353137`*^9, 3.5888484962748775`*^9}, {
  3.5888485974837265`*^9, 3.5888486048706846`*^9}, {3.588848656820795*^9, 
  3.5888486569867973`*^9}, {3.5888488524644227`*^9, 3.5888489626124253`*^9}, {
  3.588856113551424*^9, 3.588856114062484*^9}, {3.5888569283999715`*^9, 
  3.588856962461301*^9}, {3.5888569952564683`*^9, 3.5888570036745567`*^9}, {
  3.5888570631720963`*^9, 3.5888570632381086`*^9}, {3.588857704035243*^9, 
  3.588857704446299*^9}, {3.588858189277627*^9, 3.588858192446048*^9}, {
  3.5888582809341908`*^9, 3.5888582946159487`*^9}, {3.5915731377032204`*^9, 
  3.591573140343835*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plucker", " ", "coordinate", " ", "transformation"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"trans", "[", "r_", "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0"},
           {"1", "0"}
          }], "\[NoBreak]", ")"}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"skew", "@", "r"}]}]}], "]"}], " ", "+", " ", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"I2", ",", " ", "I3"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotX", "[", "\[CurlyPhi]_", "]"}], " ", ":=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"RotationMatrix", "[", 
        RowBox[{
         RowBox[{"-", "\[CurlyPhi]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotY", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"RotationMatrix", "[", 
        RowBox[{
         RowBox[{"-", "\[Theta]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotZ", "[", "\[Psi]_", "]"}], " ", ":=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"RotationMatrix", "[", 
        RowBox[{
         RowBox[{"-", "\[Psi]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rot", "[", "q_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"rotZ", "[", 
       RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       "]"}], ".", 
      RowBox[{"rotY", "[", 
       RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "]"}], ".", 
      RowBox[{"rotX", "[", 
       RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Xba", "[", 
      RowBox[{"q_", ",", " ", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"rot", "[", "q", "]"}], ".", 
      RowBox[{"trans", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Xstarba", "[", 
      RowBox[{"q_", ",", " ", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Inverse", "@", 
       RowBox[{"Xba", "[", 
        RowBox[{"q", ",", " ", "r"}], "]"}]}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"inertia", " ", "coordinate", " ", "transformation"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Io", "[", 
      RowBox[{"m_", ",", " ", "c_", ",", " ", "Ic_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cx", ",", " ", "I"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cx", " ", "=", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"0", "1"},
               {"0", "0"}
              }], "\[NoBreak]", ")"}], ",", " ", 
            RowBox[{"skew", "[", "c", "]"}]}], "]"}], " ", "+", " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"I2", ",", " ", "I3"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"I", " ", "=", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"1", "0"},
               {"0", "0"}
              }], "\[NoBreak]", ")"}], ",", " ", "Ic"}], "]"}], " ", "+", " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"0", "0"},
               {"0", "1"}
              }], "\[NoBreak]", ")"}], ",", " ", 
            RowBox[{"m", " ", "I3"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cx", ".", "I", ".", 
         RowBox[{"cx", "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883680626736507`*^9, 3.5883681143362107`*^9}, {
   3.5883682419934025`*^9, 3.588368284735835*^9}, {3.588368380658026*^9, 
   3.588368423193433*^9}, {3.588368475327829*^9, 3.588368546857668*^9}, {
   3.588368595975931*^9, 3.588368596300953*^9}, {3.588369090868146*^9, 
   3.5883691136090345`*^9}, {3.588369205784746*^9, 3.5883692197225175`*^9}, {
   3.588369266813512*^9, 3.588369371765544*^9}, {3.588369407717795*^9, 
   3.5883694952092605`*^9}, {3.588369545997448*^9, 3.588369553163358*^9}, {
   3.5883696039293337`*^9, 3.588369606561659*^9}, {3.588369683777155*^9, 
   3.5883696908660717`*^9}, {3.588369774724355*^9, 3.5883698415087204`*^9}, {
   3.5883698953355613`*^9, 3.5883699325762568`*^9}, {3.5883699786548586`*^9, 
   3.5883699788058777`*^9}, {3.588370034738986*^9, 3.5883701184452534`*^9}, {
   3.5883701607107553`*^9, 3.588370163186053*^9}, {3.5883702770377665`*^9, 
   3.5883703695715156`*^9}, {3.588370402145919*^9, 3.58837040223193*^9}, {
   3.5883705166322165`*^9, 3.5883705423064837`*^9}, {3.5883705807383637`*^9, 
   3.5883706676898165`*^9}, {3.588370700046929*^9, 3.5883708000246363`*^9}, {
   3.5883708518594575`*^9, 3.5883708650221305`*^9}, {3.588370895914056*^9, 
   3.5883709294949284`*^9}, {3.5883710098921447`*^9, 3.588371015808897*^9}, {
   3.5883710855107574`*^9, 3.588371219120737*^9}, {3.5883712635052185`*^9, 
   3.5883713466527863`*^9}, {3.5883713938811073`*^9, 3.588371397482565*^9}, {
   3.588371430981823*^9, 3.5883714315389047`*^9}, {3.5883714709599037`*^9, 
   3.5883715566387973`*^9}, {3.588371625410557*^9, 3.5883716256115613`*^9}, {
   3.5883716564344997`*^9, 3.588371678999352*^9}, {3.5883718223285637`*^9, 
   3.5883718226596255`*^9}, {3.588371899312368*^9, 3.5883719346798444`*^9}, {
   3.5883721065496883`*^9, 3.5883721367865314`*^9}, {3.5883721699897523`*^9, 
   3.5883721951099434`*^9}, {3.588372236232172*^9, 3.5883722423299446`*^9}, {
   3.5883723496965914`*^9, 3.5883723707682877`*^9}, {3.5883724747953606`*^9, 
   3.5883725442066402`*^9}, {3.5883726026810713`*^9, 3.588372703934963*^9}, {
   3.588372734290309*^9, 3.588372734823393*^9}, {3.5883728288863316`*^9, 
   3.5883728292193923`*^9}, {3.5883731311981635`*^9, 
   3.5883731373089404`*^9}, {3.588373190706727*^9, 3.5883732155088954`*^9}, {
   3.5883733203762074`*^9, 3.5883734370666227`*^9}, {3.588374387376834*^9, 
   3.5883743997534094`*^9}, 3.588376127164132*^9, {3.58837619826116*^9, 
   3.588376300234121*^9}, 3.5883771643741174`*^9, {3.5885019440497904`*^9, 
   3.5885019451106215`*^9}, {3.5885022197203474`*^9, 3.588502221810779*^9}, {
   3.588847690393952*^9, 3.5888477180614815`*^9}, {3.588847917951976*^9, 
   3.588847947997794*^9}, {3.5888480928672247`*^9, 3.588848120934806*^9}, {
   3.5888570995067177`*^9, 3.588857132309902*^9}, {3.5888571683324656`*^9, 
   3.5888571854316397`*^9}, {3.588857255695913*^9, 3.588857305054199*^9}, {
   3.588857369915962*^9, 3.588857391193657*^9}, 3.5888574423079824`*^9, {
   3.588857496454846*^9, 3.5888574980750494`*^9}, {3.5888575310222588`*^9, 
   3.588857531487299*^9}, {3.5888576712890615`*^9, 3.5888576722131815`*^9}, {
   3.5888577612303767`*^9, 3.5888577612884026`*^9}, {3.5888581422372007`*^9, 
   3.588858143795399*^9}, {3.588858251476533*^9, 3.5888582615977335`*^9}, {
   3.5888583179959016`*^9, 3.588858323153573*^9}, {3.588858366309039*^9, 
   3.588858366735096*^9}, {3.588858753489617*^9, 3.5888587686955495`*^9}, {
   3.588858813643262*^9, 3.58885881821986*^9}, {3.5888827458164062`*^9, 
   3.5888827542294784`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "derivatives", " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "commonly", " ", "used", " ", "matrix", " ", "derivatives", " ", "of", " ",
     "D", 
    RowBox[{"(", 
     RowBox[{"A", ".", "X", ".", "B"}], ")"}], " ", "and", " ", "D", 
    RowBox[{"(", 
     RowBox[{"Y", "[", "X", "]"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "note", " ", "that", " ", "transpose", " ", "on", " ", "a", " ", "tensor", 
    " ", "swaps", " ", "only", " ", "the", " ", "first", " ", "two", " ", 
    "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dXB", "[", 
      RowBox[{"dX_", ",", " ", "B_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", "\[Transpose]"}], ".", 
        RowBox[{"dX", "\[Transpose]"}]}], ")"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AdX", "[", 
      RowBox[{"A_", ",", " ", "dX_"}], "]"}], " ", ":=", " ", 
     RowBox[{"A", ".", "dX"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AdXB", "[", 
      RowBox[{"A_", ",", " ", "dX_", ",", " ", "B_"}], "]"}], " ", ":=", " ", 
     RowBox[{"AdX", "[", 
      RowBox[{"A", ",", " ", 
       RowBox[{"dXB", "[", 
        RowBox[{"dX", ",", " ", "B"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "lists", " ", "need", " ", "to", " ", "be", " ", "handled", " ", 
     "differently"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dXb", "[", 
      RowBox[{"dX_", ",", " ", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{"b", ".", 
       RowBox[{"dX", "\[Transpose]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AdXb", "[", 
      RowBox[{"A_", ",", " ", "dX_", ",", " ", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{"AdX", "[", 
      RowBox[{"A", ",", " ", 
       RowBox[{"dXb", "[", 
        RowBox[{"dX", ",", " ", "b"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"assumes", " ", "dY", " ", "is", " ", "T", 
     RowBox[{"(", 
      RowBox[{"2", ",", "2"}], ")"}], " ", "and", " ", "dX", " ", "T", 
     RowBox[{"(", 
      RowBox[{"2", ",", "1"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dYdX", "[", 
      RowBox[{"dY_", ",", " ", "dX_"}], "]"}], " ", ":=", " ", 
     RowBox[{"TensorContract", "[", 
      RowBox[{
       RowBox[{"dY", ".", 
        RowBox[{"dX", "\[Transpose]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"3", ",", " ", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "derivatives", " ", "of", " ", "spatial", " ", "vector", " ", 
     "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dXba", "[", 
      RowBox[{"q_", ",", " ", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"dXB", "[", 
      RowBox[{
       RowBox[{"drot", "[", "q", "]"}], ",", " ", 
       RowBox[{"trans", "[", "r", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q", ",", " ", "X", ",", "q", ",", " ", "x"}], "}"}], ","}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", " ", 
        RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", " ", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
        ",", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"x", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}],
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dskew", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"skew", "[", "x", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"X", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], "}"}]}], 
        "]"}]}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmx", "[", "x_", "]"}], " ", ":=", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"mx", "[", "X", "]"}], ",", " ", 
         RowBox[{"{", "X", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmxstar", "[", "x_", "]"}], " ", ":=", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"mxstar", "[", "X", "]"}], ",", " ", 
         RowBox[{"{", "X", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dtransX", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"trans", "[", 
           RowBox[{"{", 
            RowBox[{"q", ",", " ", "0", ",", " ", "0"}], "}"}], "]"}], ",", 
          " ", "q"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dtransY", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"trans", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "q", ",", " ", "0"}], "}"}], "]"}], ",", 
          " ", "q"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dtransZ", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"trans", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", "q"}], "}"}], "]"}], ",", 
          " ", "q"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drotX", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rotX", "[", "q", "]"}], ",", " ", "q"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drotY", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rotY", "[", "q", "]"}], ",", " ", "q"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drotZ", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rotZ", "[", "q", "]"}], ",", " ", "q"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dtrans", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"trans", "[", "Q", "]"}], ",", " ", 
          RowBox[{"{", "Q", "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drot", "[", "q_", "]"}], " ", ":=", " ", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rot", "[", "Q", "]"}], ",", " ", 
          RowBox[{"{", "Q", "}"}]}], "]"}]}]}]}], ";"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "]", "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588856119597193*^9, 3.5888563218639174`*^9}, {
   3.588856375839778*^9, 3.5888565212541227`*^9}, {3.5888565592269487`*^9, 
   3.5888566603698173`*^9}, {3.5888568155325375`*^9, 3.588856819840067*^9}, {
   3.5888568910672235`*^9, 3.5888568921353593`*^9}, {3.5888582441266117`*^9, 
   3.5888583036660805`*^9}, {3.5888586650473804`*^9, 
   3.5888587094150157`*^9}, {3.588858853660348*^9, 3.5888588867175493`*^9}, {
   3.588860445519267*^9, 3.5888604456982927`*^9}, {3.5888632054135914`*^9, 
   3.5888632397077265`*^9}, {3.588863271513769*^9, 3.58886332418046*^9}, 
   3.588863678051839*^9, {3.5888645624216337`*^9, 3.5888646652865534`*^9}, {
   3.588865574454302*^9, 3.5888656114830074`*^9}, {3.588865641538827*^9, 
   3.58886564250395*^9}, {3.5888656738369317`*^9, 3.5888657289433107`*^9}, {
   3.5888658482374725`*^9, 3.5888658494666452`*^9}, {3.58886589503942*^9, 
   3.5888659114495044`*^9}, {3.5888659432025423`*^9, 3.588865944077654*^9}, {
   3.5888660851495867`*^9, 3.588866103434907*^9}, {3.5888670899017873`*^9, 
   3.5888670900428023`*^9}, {3.5888673144302917`*^9, 
   3.5888673507418876`*^9}, {3.5888673947495003`*^9, 
   3.5888673975578384`*^9}, {3.588867462102045*^9, 3.588867480733405*^9}, {
   3.5888675216166058`*^9, 3.5888675398219185`*^9}, {3.5888676644209394`*^9, 
   3.58886766512803*^9}, {3.5888709442590513`*^9, 3.588870945103159*^9}, {
   3.588882922349841*^9, 3.5888829259893265`*^9}, {3.588882968370694*^9, 
   3.588883071460209*^9}, {3.588883159602416*^9, 3.5888832239735904`*^9}, {
   3.588883275190121*^9, 3.5888832781174746`*^9}, {3.588883315985688*^9, 
   3.588883471061428*^9}, {3.588883633774104*^9, 3.588883661828683*^9}, {
   3.588883738896468*^9, 3.58888375161108*^9}, {3.588883781827916*^9, 
   3.58888379321638*^9}, {3.5921129816395187`*^9, 3.592112989991997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"joint", " ", "library"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"zero6", " ", "=", " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"6", ",", " ", "2"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"ds", "/", "dq"}], ",", "  ", 
      RowBox[{
       RowBox[{"ds", "/", "d"}], 
       OverscriptBox["q", "."]}]}], "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"joint", "[", 
      RowBox[{"q_", ",", " ", "r_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", " ", "\[Equal]", " ", "\"\<rx\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I6", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", " ", "zero6", ",", " ", 
         RowBox[{
          RowBox[{"rotX", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"drotX", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "\[Equal]", " ", "\"\<ry\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I6", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          ",", " ", "zero6", ",", " ", 
         RowBox[{
          RowBox[{"rotY", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"drotY", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "\[Equal]", " ", "\"\<rz\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I6", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          ",", " ", "zero6", ",", " ", 
         RowBox[{
          RowBox[{"rotZ", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"drotZ", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "\[Equal]", " ", "\"\<dx\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I6", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
          ",", " ", "zero6", ",", " ", 
         RowBox[{"trans", "[", 
          RowBox[{"r", " ", "+", " ", 
           RowBox[{
            RowBox[{
            "I3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "q"}]}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"dtransX", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "\[Equal]", " ", "\"\<dy\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I6", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
          ",", " ", "zero6", ",", " ", 
         RowBox[{"trans", "[", 
          RowBox[{"r", " ", "+", " ", 
           RowBox[{
            RowBox[{
            "I3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "q"}]}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"dtransY", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "\[Equal]", " ", "\"\<dz\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I6", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}],
          ",", " ", "zero6", ",", " ", 
         RowBox[{"trans", "[", 
          RowBox[{"r", " ", "+", " ", 
           RowBox[{
            RowBox[{
            "I3", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "q"}]}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"dtransZ", "[", "q", "]"}], ".", 
          RowBox[{"trans", "[", "r", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", "True", ",", " ", 
       RowBox[{"Throw", "[", "\"\<joint: invalid joint.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5888827070824904`*^9, 3.5888827113130236`*^9}, {
  3.588882790618103*^9, 3.5888828232292495`*^9}, {3.5888828815676622`*^9, 
  3.5888828820877285`*^9}, {3.5888836694976444`*^9, 3.5888837173357334`*^9}, {
  3.5888838430927205`*^9, 3.5888839175781784`*^9}, {3.5888839649811993`*^9, 
  3.5888840130811033`*^9}, {3.5888841013836718`*^9, 3.588884205373872*^9}, {
  3.588884950731501*^9, 3.58888496730062*^9}, {3.588885006638606*^9, 
  3.588885162595441*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", " ", "=", " ", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "links"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nm", " ", "=", " ", "6"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "Plucker", " ", "coordinates", " ", 
    RowBox[{"(", "velocity", ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nx", " ", "=", " ", 
    RowBox[{"2", "n"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "states"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parent", " ", "=", " ", 
    RowBox[{
     RowBox[{"Range", "[", "n", "]"}], " ", "-", " ", "1"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"no", " ", "last", " ", "link"}], ",", " ", 
    RowBox[{
     RowBox[{
     "but", " ", "useful", " ", "for", " ", "velocity", " ", "at", " ", 
      "tip"}], ";", " ", 
     RowBox[{
     "only", " ", "first", " ", "rule", " ", "matched", " ", "is", " ", 
      RowBox[{"used", "."}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"code", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"\"\<ry\>\"", ",", " ", 
     RowBox[{"n", "+", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"length", " ", "=", " ", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1"}], "}"}], "\[Rule]", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", " ", "1"}], "}"}], "\[Rule]", " ", 
        "0"}], ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", " ", "1"}], "}"}], "\[Rule]", " ", "L"}]}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ",", " ", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inertia", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Io", "[", 
       RowBox[{"m", ",", " ", 
        RowBox[{"{", 
         RowBox[{"r1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "Iy", ",", " ", "0"}], "}"}], "]"}]}], "]"}],
       ",", " ", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"given", " ", "values"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tau", " ", "=", " ", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "  ", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtau", " ", "=", " ", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "nx"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5885454079878902`*^9, 3.5885455035819807`*^9}, {
   3.588545535244005*^9, 3.588545574271968*^9}, 3.5885456122888107`*^9, {
   3.588545653284009*^9, 3.5885456556173124`*^9}, {3.588547511926847*^9, 
   3.588547626997472*^9}, {3.5885476583664565`*^9, 3.588547674806548*^9}, {
   3.5885484801845465`*^9, 3.588548484002041*^9}, {3.5885485511265607`*^9, 
   3.588548568231737*^9}, {3.5885486409539776`*^9, 3.588548870411056*^9}, {
   3.5885489022751036`*^9, 3.5885489266211996`*^9}, {3.5885491507956524`*^9, 
   3.5885491606529026`*^9}, {3.588549261660629*^9, 3.5885492871358504`*^9}, {
   3.588549426434675*^9, 3.588549517701277*^9}, {3.5885495481031537`*^9, 
   3.588549577456871*^9}, 3.5885496220325546`*^9, 3.588549863352205*^9, {
   3.58855063818537*^9, 3.588550720159807*^9}, {3.5885512270532336`*^9, 
   3.588551238923721*^9}, {3.5885584693545074`*^9, 3.588558469673564*^9}, {
   3.588558684394792*^9, 3.588558743892352*^9}, {3.5885588024328117`*^9, 
   3.5885589137719407`*^9}, {3.5885589440617943`*^9, 3.588559007928446*^9}, {
   3.588559063570517*^9, 3.5885591134163814`*^9}, {3.5885591443688917`*^9, 
   3.5885591551942673`*^9}, {3.5885592367016306`*^9, 
   3.5885592373797197`*^9}, {3.58855926925815*^9, 3.5885592714784317`*^9}, {
   3.5885593124726396`*^9, 3.5885593166631565`*^9}, {3.588559400935787*^9, 
   3.5885594179169264`*^9}, {3.588559466424099*^9, 3.5885595079613867`*^9}, {
   3.5885595693201876`*^9, 3.588559570166295*^9}, 3.5885596122706275`*^9, {
   3.5885650696964245`*^9, 3.5885651288149595`*^9}, {3.5885652735393496`*^9, 
   3.588565319429186*^9}, {3.588565385444557*^9, 3.588565426453788*^9}, {
   3.588565493003227*^9, 3.588565525392342*^9}, {3.588565767837908*^9, 
   3.5885657840489902`*^9}, {3.588565968307403*^9, 3.588565968646433*^9}, {
   3.58856664882516*^9, 3.588566701496991*^9}, {3.588566742437215*^9, 
   3.5885667848765903`*^9}, {3.588567390366907*^9, 3.588567390823969*^9}, {
   3.588567462678972*^9, 3.5885674632020216`*^9}, 3.5885676811797414`*^9, {
   3.5885678071407557`*^9, 3.5885678344352036`*^9}, {3.588568044995983*^9, 
   3.588568045103005*^9}, {3.588568085256081*^9, 3.5885681165743494`*^9}, {
   3.5885682465648727`*^9, 3.5885683129803133`*^9}, 3.588568362554614*^9, {
   3.588571824220859*^9, 3.5885718255390263`*^9}, {3.588572091040318*^9, 
   3.5885720912383623`*^9}, {3.5885729002181606`*^9, 
   3.5885729050427732`*^9}, {3.588573361409314*^9, 3.588573361535331*^9}, 
   3.5885735312178926`*^9, {3.5885738146209154`*^9, 3.5885738304879446`*^9}, 
   3.5885741729571877`*^9, {3.588596300938429*^9, 3.588596304074041*^9}, {
   3.5885980176282797`*^9, 3.588598019219495*^9}, 3.5885980722756643`*^9, 
   3.588599159264118*^9, {3.5886003872814636`*^9, 3.588600390401498*^9}, {
   3.588601636059701*^9, 3.588601636277732*^9}, {3.58860213650012*^9, 
   3.588602136833164*^9}, {3.588602167821101*^9, 3.5886021962737303`*^9}, {
   3.5886023637480173`*^9, 3.5886024182389617`*^9}, {3.5886025460672073`*^9, 
   3.5886025565055313`*^9}, {3.588602596032212*^9, 3.5886026079687424`*^9}, {
   3.5886026531944766`*^9, 3.588602664658933*^9}, {3.588602696217942*^9, 
   3.588602698769266*^9}, {3.5886028385691633`*^9, 3.588602888723682*^9}, {
   3.5886031693862896`*^9, 3.5886032860599527`*^9}, {3.5886033212227125`*^9, 
   3.5886033215815153`*^9}, {3.5886033869150257`*^9, 3.588603438255165*^9}, {
   3.5886034939950795`*^9, 3.58860353887677*^9}, {3.5886036111065507`*^9, 
   3.588603631168356*^9}, {3.5886037051911507`*^9, 3.5886037828175898`*^9}, {
   3.5886038147667274`*^9, 3.588603815047525*^9}, {3.5886038814574428`*^9, 
   3.5886038817694488`*^9}, {3.5886039808149147`*^9, 
   3.5886040071947784`*^9}, {3.588604191339157*^9, 3.588604239574886*^9}, {
   3.588604541719578*^9, 3.588604623776456*^9}, {3.588605903333355*^9, 
   3.588605971599723*^9}, {3.588606020256608*^9, 3.588606032799142*^9}, {
   3.5886062124506674`*^9, 3.588606225211602*^9}, {3.5886065844063997`*^9, 
   3.588606623313196*^9}, {3.5886069659708815`*^9, 3.588606991430352*^9}, {
   3.5886071522680607`*^9, 3.5886071936085057`*^9}, {3.588607311545768*^9, 
   3.58860733795685*^9}, {3.5886102566705947`*^9, 3.5886102822393093`*^9}, {
   3.588618995631944*^9, 3.588619043215995*^9}, {3.5886314137074776`*^9, 
   3.5886315242345266`*^9}, 3.5886317087319813`*^9, {3.5886317664333086`*^9, 
   3.5886317736242228`*^9}, {3.588631890480075*^9, 3.5886318947856216`*^9}, {
   3.588632215084277*^9, 3.5886322288000197`*^9}, {3.588633394409786*^9, 
   3.5886333946088142`*^9}, {3.58863435234837*^9, 3.588634354148615*^9}, {
   3.5886344132001047`*^9, 3.588634413603156*^9}, {3.588634499055016*^9, 
   3.5886345010612707`*^9}, 3.588634683697768*^9, 3.588634735721383*^9, {
   3.58863513504813*^9, 3.5886351351451435`*^9}, {3.5886362765790963`*^9, 
   3.5886362785043397`*^9}, {3.5886379356226015`*^9, 
   3.5886379469980683`*^9}, {3.5886408808210306`*^9, 
   3.5886408942186317`*^9}, {3.588640998532112*^9, 3.588641045248291*^9}, 
   3.588641293426832*^9, {3.5888589346726446`*^9, 3.588859065529294*^9}, {
   3.5888591348580875`*^9, 3.5888592586738462`*^9}, {3.588859358493535*^9, 
   3.5888593966813836`*^9}, {3.588859521027192*^9, 3.5888595537233477`*^9}, {
   3.588859715464905*^9, 3.5888599852447844`*^9}, {3.588860021100341*^9, 
   3.588860118529734*^9}, {3.588860159665949*^9, 3.588860167746977*^9}, 
   3.5888602991536818`*^9, {3.588871022926761*^9, 3.588871055389887*^9}, 
   3.588871089109174*^9, {3.58887129742865*^9, 3.588871369678647*^9}, {
   3.588871454602442*^9, 3.5888714759651737`*^9}, {3.588884332507038*^9, 
   3.588884343044364*^9}, {3.588884474558935*^9, 3.5888845084842615`*^9}, {
   3.5888847247638273`*^9, 3.5888847250948563`*^9}, {3.588887948493566*^9, 
   3.5888879485655746`*^9}, {3.5888894555649023`*^9, 3.588889461639655*^9}, {
   3.5888899932202168`*^9, 3.5888899989419627`*^9}, {3.5888949363779707`*^9, 
   3.5888949364609814`*^9}, {3.5889001377652454`*^9, 
   3.5889001440310383`*^9}, {3.588900230373854*^9, 3.58890025975534*^9}, {
   3.5889003696653085`*^9, 3.5889003701413713`*^9}, {3.588900636193516*^9, 
   3.5889006508102913`*^9}, {3.5889009128208866`*^9, 
   3.5889009160023108`*^9}, {3.588900992453329*^9, 3.588901012346877*^9}, {
   3.588901047392312*^9, 3.588901123131957*^9}, {3.5889012044712954`*^9, 
   3.588901235394206*^9}, {3.588901340678587*^9, 3.5889013463022985`*^9}, {
   3.5889013932292633`*^9, 3.588901397084759*^9}, {3.5889014809501295`*^9, 
   3.588901512880184*^9}, {3.5889016686159763`*^9, 3.588901676423968*^9}, {
   3.5889017208206005`*^9, 3.588901728153529*^9}, {3.5889018080626855`*^9, 
   3.5889018977390823`*^9}, 3.588901999662037*^9, {3.588902079361724*^9, 
   3.588902080077812*^9}, {3.588903101076991*^9, 3.5889031063706694`*^9}, 
   3.588903141121101*^9, 3.5889038185525026`*^9, 3.588904413490842*^9, {
   3.5914587669335766`*^9, 3.5914587935898743`*^9}, {3.59150401230925*^9, 
   3.5915040125905256`*^9}, {3.5915430112857656`*^9, 3.5915430126295185`*^9}, 
   3.591543980568923*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "\"\<rx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "\"\<ry\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "\"\<rz\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "\"\<dx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "\"\<dy\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", "\"\<dz\>\"", "]"}], " ", "=", "  ", 
    RowBox[{"I6", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<rx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"rot", "[", 
    RowBox[{"{", 
     RowBox[{"#", ",", " ", "0", ",", " ", "0"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<ry\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"rot", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "#", ",", " ", "0"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<rz\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"rot", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "#"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<dx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"trans", "[", 
    RowBox[{"{", 
     RowBox[{"#", ",", " ", "0", ",", " ", "0"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<dy\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"trans", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "#", ",", " ", "0"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XJ", "[", "\"\<dz\>\"", "]"}], " ", "=", "  ", 
    RowBox[{"trans", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "#"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<rx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"drotX", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<ry\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"drotY", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<rz\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"drotZ", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<dx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"dtransX", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<dy\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"dtransY", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dXJ", "[", "\"\<dz\>\"", "]"}], " ", "=", "  ", 
    RowBox[{"dtransZ", "[", "#", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetModel", "[", 
    RowBox[{
    "j_", ",", " ", "p_", ",", " ", "g_", ",", " ", 
     "\[DoubleStruckCapitalI]c_", ",", " ", "r_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nx", " ", "=", " ", 
      RowBox[{"2", "n"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nm", " ", "=", " ", "6"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"qdd", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]d", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "nx"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tau", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "  ", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtau", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "nx"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
        " ", "g"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"da", "[", "0", "]"}], " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"nm", ",", " ", "nx"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "[", "0", "]"}], " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", "nm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dv", "[", "0", "]"}], " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"nm", ",", " ", "nx"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xa", "[", "0", "]"}], " ", "=", " ", "I6"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f0ext", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "nm"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"parent", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
         "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[DoubleStruckCapitalI]", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{"SparseArray", "@", 
          RowBox[{"Io", "[", 
           RowBox[{
            RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", " ", 
              RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", " ", 
               RowBox[{"5", ";;", "7"}]}], "\[RightDoubleBracket]"}], "]"}]}],
            "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{"S", "[", 
          RowBox[{"j", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R", ",", " ", "p"}], "}"}], " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"rotation", ",", " ", "translation"}], "}"}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"XT", " ", "=", " ", 
         RowBox[{
          RowBox[{"rot", "[", 
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", 
             RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], "]"}], 
          ".", 
          RowBox[{"trans", "[", 
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", 
             RowBox[{"4", ";;", "6"}]}], "\[RightDoubleBracket]"}], "]"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xl", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"XJ", "[", 
              RowBox[{
              "j", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], ".", "XT"}], "]"}]}], "&"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dxl", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"dXJ", "[", 
              RowBox[{
              "j", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], ".", "XT"}], "]"}]}], "&"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.591667817527995*^9, 3.591668923825349*^9, {3.5916697599352307`*^9, 
   3.591669819815657*^9}, {3.5916698753458366`*^9, 3.5916698888766146`*^9}, {
   3.5916699961457586`*^9, 3.591669997476833*^9}, {3.59167068192603*^9, 
   3.59167070374928*^9}, {3.5917208858180676`*^9, 3.591720889380574*^9}, {
   3.5917221970292563`*^9, 3.591722203732394*^9}, {3.591722238732463*^9, 
   3.591722239091839*^9}, {3.591930526907305*^9, 3.5919305664205675`*^9}, {
   3.5919306118141713`*^9, 3.591930612108184*^9}, 3.591930660729968*^9, {
   3.591930696356006*^9, 3.5919307386704297`*^9}, {3.5919308258974266`*^9, 
   3.5919308840727587`*^9}, {3.591931024599806*^9, 3.591931025034828*^9}, {
   3.591931958433284*^9, 3.5919319593043294`*^9}, {3.5919331117973347`*^9, 
   3.5919331580109777`*^9}, {3.591933250024245*^9, 3.591933252427383*^9}, {
   3.591985667141246*^9, 3.5919857313879256`*^9}, {3.591987361798293*^9, 
   3.591987364276435*^9}, {3.5919978599754896`*^9, 3.59199787152915*^9}, 
   3.5919979113604307`*^9, {3.5919979589681625`*^9, 3.5919979727709627`*^9}, 
   3.5919982080554256`*^9, {3.5920191973504057`*^9, 3.592019234797552*^9}, {
   3.5921518015301204`*^9, 3.592151821661277*^9}, {3.5921518519500084`*^9, 
   3.5921518784545245`*^9}, {3.5921519174737606`*^9, 3.592151918642827*^9}, {
   3.5921519914750166`*^9, 3.5921519924810553`*^9}, 3.5921521161271386`*^9, {
   3.5921521472189164`*^9, 3.592152245920565*^9}, {3.5921524640720634`*^9, 
   3.5921524695633802`*^9}, {3.5921527028097334`*^9, 
   3.5921527107801905`*^9}, {3.59215278839163*^9, 3.592152817779317*^9}, 
   3.5921530282183657`*^9, {3.59215320443246*^9, 3.5921532065185785`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["ABA Algorithm", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.591667897763588*^9, 3.591667900579752*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"x\[Xi]_", "?", "VectorQ"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "\[Xi]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"x\[Xi]", "\[LeftDoubleBracket]", 
         RowBox[{";;", "nx"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pA", "[", "1", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"pA", "[", "2", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"pA", "[", "3", "]"}], " ", "=", " ", 
          RowBox[{"v", "[", "0", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", "  ", 
        RowBox[{"Xba", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", " ", "0", ",", " ", "0"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"J", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", " ", "All"}], 
         "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pA", "[", "4", "]"}], " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{"J", "\[Transpose]"}], ".", 
          RowBox[{"PseudoInverse", "[", 
           RowBox[{"J", ".", 
            RowBox[{"PseudoInverse", "[", 
             RowBox[{"IA", "[", "4", "]"}], "]"}], ".", 
            RowBox[{"J", "\[Transpose]"}]}], "]"}], ".", "J", ".", 
          RowBox[{"v", "[", "4", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pA", "[", "4", "]"}], " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{"J", "\[Transpose]"}], ".", 
          RowBox[{"IA", "[", "4", "]"}], ".", "J", ".", "J", ".", 
          RowBox[{"v", "[", "4", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pA", "[", "4", "]"}], " ", "=", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{"Xa", "[", "4", "]"}], "]"}], "\[Transpose]"}], ".", 
          RowBox[{
          "f0ext", "\[LeftDoubleBracket]", "n", 
           "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{
            "tau", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            " ", "-", " ", 
            RowBox[{
             RowBox[{"s", "[", "i", "]"}], ".", 
             RowBox[{"pA", "[", "i", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"parent", "[", "i", "]"}], " ", "\[NotEqual]", " ", 
             "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pa", " ", "=", " ", 
              RowBox[{
               RowBox[{"pA", "[", "i", "]"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"U", "[", "i", "]"}], 
                RowBox[{
                 RowBox[{"u", "[", "i", "]"}], "/", 
                 RowBox[{"d", "[", "i", "]"}]}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pA", "[", 
               RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"pA", "[", 
                RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "+", "  ", 
               RowBox[{
                RowBox[{
                 RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", 
                "pa"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n", ",", " ", "1", ",", " ", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", "0", "]"}], " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "nm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", "1", "]"}], " ", "=", " ", 
        RowBox[{"a", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", "2", "]"}], " ", "=", " ", 
        RowBox[{"a", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", "3", "]"}], " ", "=", " ", 
        RowBox[{"a", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], " ", "=", " ", 
        RowBox[{"a", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"XL", "[", "i", "]"}], ".", 
            RowBox[{"a", "[", 
             RowBox[{"parent", "[", "i", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "qdd", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ",
            "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u", "[", "i", "]"}], " ", "-", " ", 
              RowBox[{
               RowBox[{"U", "[", "i", "]"}], ".", 
               RowBox[{"a", "[", "i", "]"}]}]}], ")"}], "/", 
            RowBox[{"d", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"s", "[", "i", "]"}], 
             RowBox[{
             "qdd", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "qdd"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CRB", "[", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "H", ",", " ", "IC", ",", " ", "p", ",", " ", "f", ",", " ", "j"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", " ", "=", " ", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"IC", "[", "i", "]"}], " ", "=", " ", 
          RowBox[{"\[DoubleStruckCapitalI]", "[", "i", "]"}]}], ";"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"p", " ", "=", " ", 
          RowBox[{"parent", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"p", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
           RowBox[{
            RowBox[{"IC", "[", "p", "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"IC", "[", "p", "]"}], " ", "+", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", 
              RowBox[{"IC", "[", "i", "]"}], ".", 
              RowBox[{"XL", "[", "i", "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"f", " ", "=", " ", 
          RowBox[{
           RowBox[{"IC", "[", "i", "]"}], ".", 
           RowBox[{"s", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"H", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"f", ".", 
           RowBox[{"s", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"j", " ", "=", " ", "i"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"parent", "[", "j", "]"}], " ", "\[NotEqual]", " ", "0"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"XL", "[", "j", "]"}], "\[Transpose]"}], ".", "f"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"j", " ", "=", " ", 
             RowBox[{"parent", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"H", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}], " ", 
             "=", " ", 
             RowBox[{
              RowBox[{"H", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", " ", "i"}], "\[RightDoubleBracket]"}], " ", 
              "=", " ", 
              RowBox[{"f", ".", 
               RowBox[{"s", "[", "j", "]"}]}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "n", ",", " ", "1", ",", " ", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "H"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bodyJac", "[", 
    RowBox[{"q_", ",", " ", "r_", ",", " ", 
     RowBox[{"N_:", "n"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "J"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"J", " ", "=", " ", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"nm", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Xa", "[", "i", "]"}], " ", "=", " ", 
          RowBox[{"XL", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", " ", "=", " ", 
          RowBox[{"parent", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"p", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
           RowBox[{
            RowBox[{"Xa", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"Xa", "[", "i", "]"}], ".", 
             RowBox[{"Xa", "[", "p", "]"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"J", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "i"}], "\[RightDoubleBracket]"}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{"Xa", "[", "i", "]"}], "]"}], ".", 
           RowBox[{"s", "[", "i", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "N"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Xba", "[", 
        RowBox[{"q", ",", " ", "r"}], "]"}], ".", "J"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"doesn", "'"}], "t", " ", "work", "\[IndentingNewLine]", 
     RowBox[{"osim", "[", "]"}]}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"K", ",", " ", "L"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalLambda]", "[", "0", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"10", "^", "8"}], " ", 
         RowBox[{"Io", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "I3"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", 
            RowBox[{"\[CapitalLambda]", "[", " ", 
             RowBox[{"parent", "[", "i", "]"}], "]"}], ".", 
            RowBox[{"XL", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"K", " ", "=", " ", 
           RowBox[{
            RowBox[{"TensorProduct", "[", 
             RowBox[{
              RowBox[{"s", "[", "i", "]"}], ",", " ", 
              RowBox[{"s", "[", "i", "]"}]}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "i", "]"}], ".", 
              RowBox[{"\[CapitalLambda]", "[", "i", "]"}], ".", 
              RowBox[{"s", "[", "i", "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"L", " ", "=", " ", 
           RowBox[{"I6", " ", "-", " ", 
            RowBox[{"K", ".", 
             RowBox[{"\[CapitalLambda]", "[", "i", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalLambda]", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"\[DoubleStruckCapitalI]", "[", "i", "]"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"\[CapitalLambda]", "[", "i", "]"}], ".", "L"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"x\[Xi]_", "?", "VectorQ"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "\[Xi]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", " ", "=", " ", 
      RowBox[{"x\[Xi]", "\[LeftDoubleBracket]", 
       RowBox[{";;", "nx"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"x\[Xi]", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"nx", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
        " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"XL", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"xl", "[", "i", "]"}], "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Xa", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"XL", "[", "i", "]"}], ".", 
          RowBox[{"Xa", "[", 
           RowBox[{"parent", "[", "i", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vpar", " ", "=", " ", 
         RowBox[{"v", "[", 
          RowBox[{"parent", "[", "i", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vrel", " ", "=", " ", 
         RowBox[{
          RowBox[{"s", "[", "i", "]"}], " ", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "n"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"XL", "[", "i", "]"}], ".", "vpar"}], " ", "+", " ", 
          "vrel"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "[", "i", "]"}], " ", "=", "  ", 
         RowBox[{
          RowBox[{"mx", "[", 
           RowBox[{"v", "[", "i", "]"}], "]"}], ".", "vrel"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"fi", " ", "=", " ", 
         RowBox[{
          RowBox[{"\[DoubleStruckCapitalI]", "[", "i", "]"}], " ", ".", 
          RowBox[{"v", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pA", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"mxstar", "[", 
            RowBox[{"v", "[", "i", "]"}], "]"}], ".", "fi"}], " ", "-", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{"Xa", "[", "i", "]"}], "]"}], "\[Transpose]"}], ".", 
           RowBox[{
           "f0ext", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IA", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{"\[DoubleStruckCapitalI]", "[", "i", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DXL", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"dxl", "[", "i", "]"}], "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dvpar", " ", "=", " ", 
         RowBox[{"dv", "[", 
          RowBox[{"parent", "[", "i", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dvrel", " ", "=", " ", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], ",", " ", 
           RowBox[{"\[Xi]", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "n"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dv", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DXL", "[", "i", "]"}], ".", "vpar"}], ",", " ", 
            RowBox[{
            "\[Xi]", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "]"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"XL", "[", "i", "]"}], ".", "dvpar"}], " ", "+", " ", 
          "dvrel"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dc", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"dXb", "[", 
            RowBox[{
             RowBox[{"dmx", "[", 
              RowBox[{"v", "[", "i", "]"}], "]"}], ",", "vrel"}], "]"}], ".", 
           RowBox[{"dv", "[", "i", "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"mx", "[", 
            RowBox[{"v", "[", "i", "]"}], "]"}], ".", "dvrel"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dpA", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dXb", "[", 
             RowBox[{
              RowBox[{"dmxstar", "[", 
               RowBox[{"v", "[", "i", "]"}], "]"}], ",", " ", "fi"}], "]"}], 
            " ", "+", " ", 
            RowBox[{
             RowBox[{"mxstar", "[", 
              RowBox[{"v", "[", "i", "]"}], "]"}], ".", 
             RowBox[{"\[DoubleStruckCapitalI]", "[", "i", "]"}]}]}], " ", 
           ")"}], ".", 
          RowBox[{"dv", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dIA", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"nm", ",", " ", "nm", ",", " ", "nx"}], "}"}]}], "]"}]}], 
        ";"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"dIA", " ", "=", " ", 
         RowBox[{"dIi", " ", "=", " ", "0"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"U", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"IA", "[", "i", "]"}], ".", 
          RowBox[{"s", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"s", "[", "i", "]"}], ".", 
          RowBox[{"U", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
          "tau", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
          "-", " ", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], ".", 
           RowBox[{"pA", "[", "i", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UU", " ", "=", " ", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{
           RowBox[{"U", "[", "i", "]"}], ",", 
           RowBox[{"U", "[", "i", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"du", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
          "dtau", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ",
           "-", " ", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], ".", 
           RowBox[{"dpA", "[", "i", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dd", " ", "=", " ", 
         RowBox[{"AdXb", "[", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], ",", 
           RowBox[{"dIA", "[", "i", "]"}], ",", " ", 
           RowBox[{"s", "[", "i", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ss", " ", "=", " ", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], ",", " ", 
           RowBox[{"s", "[", "i", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dUU", " ", "=", " ", 
         RowBox[{"dXB", "[", 
          RowBox[{
           RowBox[{"dIA", "[", "i", "]"}], ",", " ", 
           RowBox[{"ss", ".", 
            RowBox[{"IA", "[", "i", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UdU", " ", "=", " ", 
         RowBox[{"AdX", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IA", "[", "i", "]"}], ".", "ss"}], ",", 
           RowBox[{"dIA", "[", "i", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"parent", "[", "i", "]"}], " ", "\[NotEqual]", " ", "0"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ia", " ", "=", " ", 
            RowBox[{
             RowBox[{"IA", "[", "i", "]"}], " ", "-", " ", 
             RowBox[{"UU", "/", 
              RowBox[{"d", "[", "i", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pa", " ", "=", " ", 
            RowBox[{
             RowBox[{"pA", "[", "i", "]"}], " ", "+", " ", 
             RowBox[{"Ia", ".", 
              RowBox[{"c", "[", "i", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"U", "[", "i", "]"}], 
              RowBox[{
               RowBox[{"u", "[", "i", "]"}], "/", 
               RowBox[{"d", "[", "i", "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"IA", "[", 
             RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"IA", "[", 
              RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "+", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", "Ia", 
              ".", 
              RowBox[{"XL", "[", "i", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pA", "[", 
             RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"pA", "[", 
              RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "+", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", 
              "pa"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dIa", " ", "=", " ", 
            RowBox[{
             RowBox[{"dIA", "[", "i", "]"}], " ", "-", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"dUU", " ", "+", " ", "UdU"}], ")"}], "/", 
              RowBox[{"d", "[", "i", "]"}]}], " ", "-", " ", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{"UU", "/", 
                RowBox[{
                 RowBox[{"d", "[", "i", "]"}], "^", "2"}]}], ",", "dd"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dpa", " ", "=", " ", 
            RowBox[{
             RowBox[{"dpA", "[", "i", "]"}], " ", "+", " ", 
             RowBox[{"dXb", "[", 
              RowBox[{"dIa", ",", " ", 
               RowBox[{"c", "[", "i", "]"}]}], "]"}], " ", "+", " ", 
             RowBox[{"Ia", ".", 
              RowBox[{"dc", "[", "i", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"dXb", "[", 
                 RowBox[{
                  RowBox[{"dIA", "[", "i", "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{"s", "[", "i", "]"}], " ", 
                   RowBox[{"u", "[", "i", "]"}]}]}], "]"}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"IA", "[", "i", "]"}], ".", 
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{
                   RowBox[{"s", "[", "i", "]"}], ",", " ", 
                   RowBox[{"du", "[", "i", "]"}]}], "]"}]}]}], ")"}], "/", 
              RowBox[{"d", "[", "i", "]"}]}], " ", "+", " ", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"IA", "[", "i", "]"}], ".", 
                 RowBox[{"s", "[", "i", "]"}]}], " ", 
                RowBox[{
                 RowBox[{"u", "[", "i", "]"}], "/", 
                 RowBox[{
                  RowBox[{"d", "[", "i", "]"}], "^", "2"}]}]}], ",", " ", 
               "dd"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dIA", "[", 
             RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"dIA", "[", 
              RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "+", "  ", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"DXL", "[", "i", "]"}], "\[Transpose]"}], ".", "Ia",
                  ".", 
                 RowBox[{"XL", "[", "i", "]"}]}], " ", "+", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", "Ia", 
                 ".", 
                 RowBox[{"DXL", "[", "i", "]"}]}]}], ",", 
               RowBox[{
               "\[Xi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}], " ", "+", 
             RowBox[{"AdXB", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ",", " ", 
               "dIa", ",", " ", 
               RowBox[{"XL", "[", "i", "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dpA", "[", 
             RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"dpA", "[", 
              RowBox[{"parent", "[", "i", "]"}], "]"}], " ", "+", "  ", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"DXL", "[", "i", "]"}], "\[Transpose]"}], ".", 
                "pa"}], ",", " ", 
               RowBox[{
               "\[Xi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}], " ", "+", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"XL", "[", "i", "]"}], "\[Transpose]"}], ".", 
              "dpa"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n", ",", " ", "1", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"XL", "[", "i", "]"}], ".", 
           RowBox[{"a", "[", 
            RowBox[{"parent", "[", "i", "]"}], "]"}]}], " ", "+", " ", 
          RowBox[{"c", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "qdd", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
         "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u", "[", "i", "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"U", "[", "i", "]"}], ".", 
             RowBox[{"a", "[", "i", "]"}]}]}], ")"}], "/", 
          RowBox[{"d", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"a", "[", "i", "]"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], 
           RowBox[{
           "qdd", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"da", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"XL", "[", "i", "]"}], ".", 
           RowBox[{"da", "[", 
            RowBox[{"parent", "[", "i", "]"}], "]"}]}], " ", "+", " ", 
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DXL", "[", "i", "]"}], ".", 
             RowBox[{"a", "[", 
              RowBox[{"parent", "[", "i", "]"}], "]"}]}], ",", " ", 
            RowBox[{
            "\[Xi]", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "]"}], " ", "+", " ", 
          RowBox[{"dc", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "\[Xi]d", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         " ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"du", "[", "i", "]"}], " ", "-", " ", 
            RowBox[{"AdXb", "[", 
             RowBox[{
              RowBox[{"s", "[", "i", "]"}], ",", " ", 
              RowBox[{"dIA", "[", "i", "]"}], ",", " ", 
              RowBox[{"a", "[", "i", "]"}]}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"s", "[", "i", "]"}], ".", 
             RowBox[{"IA", "[", "i", "]"}], ".", 
             RowBox[{"da", "[", "i", "]"}]}]}], ")"}], "/", 
          RowBox[{"d", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"da", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"da", "[", "i", "]"}], " ", "+", " ", 
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{"s", "[", "i", "]"}], ",", " ", 
            RowBox[{
            "\[Xi]d", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "]"}]}]}], ";"}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
          " ", "qdd"}], "]"}], ",", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"\[Xi]", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
          " ", "\[Xi]d"}], "]"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5885995383332195`*^9, 3.5885996092213144`*^9}, 
   3.5885999524873724`*^9, {3.588601675361512*^9, 3.588601758512061*^9}, {
   3.588601840767516*^9, 3.588601841180587*^9}, {3.5886018816447115`*^9, 
   3.5886019473060565`*^9}, {3.5886022797163334`*^9, 3.588602280951494*^9}, {
   3.5886043966224165`*^9, 3.588604462517539*^9}, {3.588605282680728*^9, 
   3.5886052979376717`*^9}, {3.5886054970894094`*^9, 
   3.5886056251355944`*^9}, {3.588605687973068*^9, 3.5886056896734715`*^9}, 
   3.5886061216264935`*^9, {3.5886061684269943`*^9, 3.58860619043883*^9}, {
   3.5886062292052464`*^9, 3.5886062324188795`*^9}, 3.588606265350832*^9, {
   3.588606495110093*^9, 3.5886065142670975`*^9}, {3.58860667863139*^9, 
   3.58860669264034*^9}, {3.5886068059287524`*^9, 3.5886068599677315`*^9}, {
   3.5886074128532553`*^9, 3.588607528746908*^9}, {3.5886075672022033`*^9, 
   3.588607567638996*^9}, {3.5886077049672604`*^9, 3.5886077291631193`*^9}, {
   3.5886077786312485`*^9, 3.588607794871023*^9}, 3.588607957143961*^9, {
   3.5886082791314096`*^9, 3.5886083400968623`*^9}, {3.588609697803914*^9, 
   3.588609877065426*^9}, {3.5886100237853527`*^9, 3.5886101230146103`*^9}, {
   3.5886103220273566`*^9, 3.5886103327867393`*^9}, {3.58861053071404*^9, 
   3.5886106312368336`*^9}, {3.588611251036131*^9, 3.5886112525913277`*^9}, {
   3.5886113815043917`*^9, 3.5886113855429196`*^9}, {3.5886114300018578`*^9, 
   3.5886114317250957`*^9}, {3.5886115677843876`*^9, 
   3.5886116506469193`*^9}, {3.5886118366497803`*^9, 3.588611873722494*^9}, {
   3.588611917572071*^9, 3.588612042779978*^9}, {3.5886120766523037`*^9, 
   3.5886121135239716`*^9}, {3.588612224218059*^9, 3.588612308878456*^9}, {
   3.5886123716844573`*^9, 3.5886123756339593`*^9}, {3.5886125306665444`*^9, 
   3.5886125474336567`*^9}, {3.5886126116958275`*^9, 
   3.5886127038385334`*^9}, {3.5886127356786003`*^9, 3.588612772500265*^9}, {
   3.588612909945178*^9, 3.58861291011018*^9}, {3.5886153126333413`*^9, 
   3.5886154025337667`*^9}, {3.588615929106757*^9, 3.5886159671636124`*^9}, {
   3.5886160203073483`*^9, 3.5886160339840865`*^9}, {3.588616109452679*^9, 
   3.5886161113169193`*^9}, {3.5886161517860765`*^9, 
   3.5886161522861414`*^9}, {3.58861619293729*^9, 3.588616197606882*^9}, {
   3.588616240615348*^9, 3.5886162719643326`*^9}, {3.588616304200449*^9, 
   3.588616314495736*^9}, {3.5886165379409494`*^9, 3.588616549046362*^9}, {
   3.588616603782317*^9, 3.5886166057395663`*^9}, {3.5886169247827473`*^9, 
   3.5886169429650617`*^9}, {3.588617150493795*^9, 3.588617152634066*^9}, {
   3.588617228532714*^9, 3.5886172384639945`*^9}, {3.5886176213780613`*^9, 
   3.5886176371840515`*^9}, {3.5886176695551662`*^9, 3.588617669918231*^9}, {
   3.58861854457662*^9, 3.588618584866741*^9}, {3.5886186473896847`*^9, 
   3.588618664141816*^9}, {3.5886188282496705`*^9, 3.5886188764547997`*^9}, {
   3.588618950000148*^9, 3.588618972980068*^9}, 3.5886191229861517`*^9, {
   3.588619165780572*^9, 3.5886191681148868`*^9}, {3.5886196718680286`*^9, 
   3.588619733660898*^9}, {3.588619915783515*^9, 3.5886200431317005`*^9}, {
   3.5886201388117743`*^9, 3.5886201509143114`*^9}, {3.5886204258203726`*^9, 
   3.588620434663494*^9}, {3.5886235299303675`*^9, 3.588623541694849*^9}, {
   3.588623602169527*^9, 3.5886236286488724`*^9}, {3.588623716481042*^9, 
   3.588623749941314*^9}, {3.5886238019509*^9, 3.5886238054053535`*^9}, {
   3.5886239889166603`*^9, 3.588624027284537*^9}, {3.5886240599556885`*^9, 
   3.58862416995759*^9}, {3.588624269166215*^9, 3.588624285773308*^9}, {
   3.5886243971322536`*^9, 3.588624419355056*^9}, {3.5886245190507307`*^9, 
   3.588624563248348*^9}, 3.5886247246296415`*^9, {3.588624782061962*^9, 
   3.5886248306673255`*^9}, {3.588624896437702*^9, 3.588624896658709*^9}, {
   3.588625226739682*^9, 3.5886252287389174`*^9}, {3.5886253585014095`*^9, 
   3.5886253606436996`*^9}, {3.5886265170141554`*^9, 3.588626530563859*^9}, {
   3.5886266141204786`*^9, 3.5886267144109917`*^9}, {3.588626812730488*^9, 
   3.588626823478854*^9}, {3.588626964889826*^9, 3.5886269700964003`*^9}, {
   3.588627002559368*^9, 3.5886270062518334`*^9}, {3.5886273377242713`*^9, 
   3.588627409087323*^9}, {3.58862746453437*^9, 3.588627499058758*^9}, {
   3.5886275634659433`*^9, 3.58862759425886*^9}, {3.588627670620802*^9, 
   3.588627677759704*^9}, 3.5886277087456408`*^9, {3.5886278223738656`*^9, 
   3.588627826167367*^9}, {3.5886279195237956`*^9, 3.588627948269431*^9}, {
   3.588628132704527*^9, 3.588628137911189*^9}, {3.5886283259640894`*^9, 
   3.5886283342561455`*^9}, {3.5886284143223205`*^9, 3.588628453987382*^9}, {
   3.5886285056474695`*^9, 3.588628511674235*^9}, {3.5886285613015614`*^9, 
   3.588628579886902*^9}, {3.588628732863347*^9, 3.588628766762655*^9}, {
   3.588628802056138*^9, 3.5886288079298882`*^9}, 3.5886288445395594`*^9, {
   3.5886295557800407`*^9, 3.588629630097466*^9}, {3.588629674465103*^9, 
   3.5886296752202024`*^9}, {3.5886297364069777`*^9, 
   3.5886297933012104`*^9}, {3.588629932176783*^9, 3.5886299652990103`*^9}, {
   3.588630752277425*^9, 3.5886307746942644`*^9}, {3.5886308200770288`*^9, 
   3.5886308261768036`*^9}, {3.5886308949505672`*^9, 
   3.5886309274076705`*^9}, {3.588630976035872*^9, 3.588631003140298*^9}, {
   3.5886310444775553`*^9, 3.5886310534407096`*^9}, {3.5886312411855497`*^9, 
   3.5886313193874874`*^9}, {3.5886318372563133`*^9, 3.588631843052047*^9}, {
   3.588631911483745*^9, 3.5886319217310467`*^9}, {3.5886319595578613`*^9, 
   3.588631976449933*^9}, {3.5886320709739623`*^9, 3.588632096182143*^9}, 
   3.5886321476907063`*^9, {3.58863231580906*^9, 3.588632570505434*^9}, {
   3.5886326068420525`*^9, 3.5886326588886595`*^9}, {3.588633003626479*^9, 
   3.5886330058487577`*^9}, {3.588633230610324*^9, 3.588633245642234*^9}, {
   3.5886332843238015`*^9, 3.588633326375142*^9}, {3.588633596710497*^9, 
   3.588633603488363*^9}, {3.588634643371643*^9, 3.5886346538529744`*^9}, {
   3.5886349622441673`*^9, 3.5886350174761896`*^9}, 3.5886353571386223`*^9, {
   3.5886354868220882`*^9, 3.5886354870221195`*^9}, 3.588635860708499*^9, {
   3.5886359177777576`*^9, 3.588635923274466*^9}, {3.5886360086713076`*^9, 
   3.588636011760697*^9}, {3.588636065799567*^9, 3.588636077126025*^9}, {
   3.588636203128744*^9, 3.5886362382612133`*^9}, {3.5886363846444693`*^9, 
   3.588636392622481*^9}, {3.5886376065527825`*^9, 3.5886376107083125`*^9}, {
   3.5886377561427903`*^9, 3.5886377562648087`*^9}, {3.5886378226242423`*^9, 
   3.5886378265247355`*^9}, 3.5886379228169765`*^9, {3.5886380346413517`*^9, 
   3.5886380690877347`*^9}, {3.588638347448928*^9, 3.5886384052880335`*^9}, 
   3.5886385372335253`*^9, {3.5886385737251606`*^9, 3.5886386122920647`*^9}, 
   3.5886387153719254`*^9, {3.588638870776678*^9, 3.588638871506768*^9}, {
   3.5886390081876907`*^9, 3.5886390090947876`*^9}, 3.5886397990102587`*^9, {
   3.588639880188559*^9, 3.588639880272571*^9}, {3.5886401007635994`*^9, 
   3.588640104195052*^9}, {3.5886402292572365`*^9, 3.5886402385544214`*^9}, {
   3.5886403253748446`*^9, 3.5886403254438534`*^9}, {3.588640450355853*^9, 
   3.588640450563878*^9}, {3.5886406207302113`*^9, 3.5886406230525217`*^9}, 
   3.5886406836812067`*^9, 3.5886407774781303`*^9, {3.588640816387094*^9, 
   3.588640816849134*^9}, {3.5886414612551994`*^9, 3.5886414634284716`*^9}, {
   3.5886423657336826`*^9, 3.5886423674569044`*^9}, {3.5886431662212453`*^9, 
   3.588643170897824*^9}, {3.5886447812942085`*^9, 3.5886448048261986`*^9}, {
   3.5886461137273407`*^9, 3.5886461154695644`*^9}, 3.588860365423103*^9, {
   3.588860523178139*^9, 3.5888605737835703`*^9}, {3.5888606868959446`*^9, 
   3.588860706714466*^9}, {3.5888607416199017`*^9, 3.5888608009794655`*^9}, {
   3.5888608990899343`*^9, 3.5888609207406683`*^9}, {3.588861046365653*^9, 
   3.5888610467876883`*^9}, {3.5888611244125547`*^9, 
   3.5888611414887238`*^9}, {3.588861186662464*^9, 3.5888612184074993`*^9}, {
   3.5888612562303257`*^9, 3.5888613170557103`*^9}, {3.588861387374645*^9, 
   3.5888614441652384`*^9}, {3.588861489515253*^9, 3.5888615203094387`*^9}, {
   3.5888615543827524`*^9, 3.5888615970441732`*^9}, {3.58886303644121*^9, 
   3.588863052154207*^9}, {3.5888633578157387`*^9, 3.588863368504097*^9}, {
   3.5888639710007553`*^9, 3.5888639844134665`*^9}, {3.588864216678744*^9, 
   3.58886432656571*^9}, {3.588864398426843*^9, 3.588864398934908*^9}, {
   3.588864431666064*^9, 3.588864464585252*^9}, {3.5888647081980033`*^9, 
   3.588864738822899*^9}, {3.5888649579676275`*^9, 3.5888649652895737`*^9}, {
   3.5888715722303877`*^9, 3.588871587098284*^9}, {3.5888842763539066`*^9, 
   3.588884281689585*^9}, {3.588884320862564*^9, 3.588884325769188*^9}, {
   3.588884393823688*^9, 3.588884443072934*^9}, {3.5888845773363857`*^9, 
   3.5888845997639403`*^9}, {3.588884633987277*^9, 3.588884683811613*^9}, {
   3.5888847305605645`*^9, 3.588884736303281*^9}, {3.5888848382092323`*^9, 
   3.5888849099573517`*^9}, {3.5888852579925537`*^9, 3.588885316738016*^9}, {
   3.5888854199578314`*^9, 3.5888854489185114`*^9}, {3.588885531433999*^9, 
   3.5888855648342633`*^9}, {3.588886744889716*^9, 3.588886761533242*^9}, {
   3.588887079132234*^9, 3.588887160021511*^9}, {3.588887209339779*^9, 
   3.5888872096138134`*^9}, {3.5888880673060417`*^9, 
   3.5888880674320593`*^9}, {3.5888889466661673`*^9, 
   3.5888889493175077`*^9}, {3.5888890314629407`*^9, 
   3.5888890334171963`*^9}, {3.5888890830748415`*^9, 3.588889090587798*^9}, {
   3.588889139392003*^9, 3.58888916825767*^9}, {3.5888892235366955`*^9, 
   3.588889241336958*^9}, {3.5888892868797464`*^9, 3.588889309752654*^9}, {
   3.5888893624743724`*^9, 3.588889422603712*^9}, {3.588889544145141*^9, 
   3.5888895507469807`*^9}, {3.588889735999525*^9, 3.588889792819766*^9}, {
   3.5888900339984007`*^9, 3.588890036787753*^9}, {3.5888900743615284`*^9, 
   3.5888900861440306`*^9}, {3.5888901511303053`*^9, 3.588890155969901*^9}, {
   3.588890217938774*^9, 3.5888902241925735`*^9}, {3.588890302418359*^9, 
   3.5888903473750725`*^9}, {3.588891569523077*^9, 3.5888915843739653`*^9}, 
   3.5888916185333104`*^9, {3.5888917313369884`*^9, 3.588891737158748*^9}, {
   3.5888918029607763`*^9, 3.5888918083304787`*^9}, {3.588891894473236*^9, 
   3.588891895814423*^9}, {3.5888919312259088`*^9, 3.588891955316965*^9}, {
   3.588892051472207*^9, 3.5888922112653832`*^9}, {3.5888923646761622`*^9, 
   3.588892399691609*^9}, {3.588894057143903*^9, 3.5888940582590404`*^9}, {
   3.588894978208287*^9, 3.588894982917886*^9}, {3.588901572374728*^9, 
   3.5889015784275007`*^9}, {3.588903157684205*^9, 3.58890316209077*^9}, {
   3.5889032189570127`*^9, 3.5889032236645947`*^9}, {3.588903310322605*^9, 
   3.5889033107276564`*^9}, {3.588903693981073*^9, 3.5889036992827663`*^9}, 
   3.5914597131385493`*^9, 3.591459750607374*^9, {3.5914871430813317`*^9, 
   3.5914871489886713`*^9}, 3.591489673670844*^9, 3.591490358491062*^9, {
   3.591492651353367*^9, 3.5914926858903437`*^9}, {3.591493060067789*^9, 
   3.591493101768162*^9}, {3.591493132851941*^9, 3.591493135690104*^9}, {
   3.5914932099403563`*^9, 3.591493391550759*^9}, {3.5914934639088984`*^9, 
   3.5914934975598264`*^9}, {3.591493559488373*^9, 3.591493561628495*^9}, {
   3.591493600859742*^9, 3.5914936022118196`*^9}, {3.591494157810636*^9, 
   3.5914941598797565`*^9}, 3.59149431694375*^9, {3.5914943699818087`*^9, 
   3.591494402876693*^9}, {3.591494471737631*^9, 3.591494498953173*^9}, {
   3.591494619701089*^9, 3.5914946328438435`*^9}, {3.591494900382183*^9, 
   3.591494904959424*^9}, {3.591498329696546*^9, 3.5914983377040043`*^9}, 
   3.591498374036085*^9, 3.591498411261217*^9, {3.591498730821518*^9, 
   3.5914988048787584`*^9}, {3.5914994185749025`*^9, 
   3.5914994749301295`*^9}, {3.591499534565544*^9, 3.5914995504894557`*^9}, {
   3.591499807458173*^9, 3.591499834948747*^9}, {3.5914998817464266`*^9, 
   3.5914998923640347`*^9}, {3.5915000189252844`*^9, 3.591500057475491*^9}, {
   3.5915001416173096`*^9, 3.5915001482306876`*^9}, {3.591500235372678*^9, 
   3.5915002390598893`*^9}, 3.5915002790831804`*^9, {3.591500381547048*^9, 
   3.59150039309871*^9}, {3.591500471552203*^9, 3.5915004782455864`*^9}, {
   3.5915024872706366`*^9, 3.5915024893407564`*^9}, {3.5915028615710707`*^9, 
   3.5915029338452096`*^9}, {3.5915030019701138`*^9, 3.591503004479273*^9}, {
   3.591503257337735*^9, 3.591503258571808*^9}, {3.5915038518401885`*^9, 
   3.591503853215187*^9}, {3.591503971090418*^9, 3.591504007246739*^9}, {
   3.591504134434489*^9, 3.5915041542157755`*^9}, {3.591532091892812*^9, 
   3.5915320923771877`*^9}, {3.591543051035842*^9, 3.591543051520217*^9}, {
   3.5915439817564125`*^9, 3.5915439840064173`*^9}, {3.591669941038602*^9, 
   3.5916699651949887`*^9}, {3.5916700337759137`*^9, 
   3.5916700547291126`*^9}, {3.591670091482214*^9, 3.5916701110773373`*^9}, {
   3.591670258859807*^9, 3.5916702747607293`*^9}, {3.591670371075229*^9, 
   3.591670416258835*^9}, {3.5916707655828204`*^9, 3.5916707663008614`*^9}, {
   3.5916709338324747`*^9, 3.591670946262168*^9}, {3.5916710605987115`*^9, 
   3.591671069618233*^9}, {3.5916711363850555`*^9, 3.591671142041398*^9}, {
   3.591720901677477*^9, 3.5917209395056705`*^9}, {3.5917211840217896`*^9, 
   3.591721190553047*^9}, {3.591721426850375*^9, 3.591721427319127*^9}, {
   3.591722973614787*^9, 3.5917229843648033`*^9}, 3.5917554736407785`*^9, {
   3.5918259898805466`*^9, 3.5918260364082108`*^9}, {3.591826081184752*^9, 
   3.5918261091033545`*^9}, {3.5918262227358627`*^9, 3.5918262530225945`*^9}, 
   3.5918264983536463`*^9, {3.591826552261733*^9, 3.591826603246653*^9}, {
   3.5918266602309165`*^9, 3.5918266664862742`*^9}, {3.591826698862131*^9, 
   3.591826713509966*^9}, {3.591826760829681*^9, 3.591826773998431*^9}, {
   3.591826814206753*^9, 3.591826817758938*^9}, {3.5918268560541277`*^9, 
   3.5918268787264285`*^9}, {3.5918301698558965`*^9, 3.591830269992635*^9}, {
   3.59183047856958*^9, 3.59183054078614*^9}, {3.5918307903954372`*^9, 
   3.5918307908664637`*^9}, {3.59183091459655*^9, 3.5918309290323753`*^9}, {
   3.59183103038118*^9, 3.5918310706334853`*^9}, 3.591831148137925*^9, {
   3.5919311335390444`*^9, 3.5919311865550804`*^9}, {3.5919312494996853`*^9, 
   3.59193132170582*^9}, {3.5919313630811896`*^9, 3.59193136448227*^9}, {
   3.5919313959080696`*^9, 3.591931398331208*^9}, {3.5919315777224813`*^9, 
   3.591931602694907*^9}, {3.5919316383109508`*^9, 3.5919316393160086`*^9}, {
   3.591931676226123*^9, 3.5919317867614527`*^9}, {3.591932539095533*^9, 
   3.5919325900304565`*^9}, {3.591932662167584*^9, 3.59193269842566*^9}, {
   3.5919336858032*^9, 3.591933715567909*^9}, {3.5919338864146934`*^9, 
   3.5919341526519575`*^9}, {3.5919344221842074`*^9, 3.591934431944763*^9}, {
   3.591935088694376*^9, 3.5919351058043523`*^9}, {3.5919635215600405`*^9, 
   3.591963577000235*^9}, 3.5919636207447205`*^9, {3.5919637695882616`*^9, 
   3.591963772761429*^9}, {3.591963862131549*^9, 3.591963945807338*^9}, {
   3.5919640436259403`*^9, 3.591964063822097*^9}, {3.5919642073443155`*^9, 
   3.5919642181209326`*^9}, {3.5919658796690893`*^9, 3.591965888813607*^9}, {
   3.5919659710243134`*^9, 3.5919660501698523`*^9}, 3.591966414726723*^9, {
   3.5919665832013693`*^9, 3.591966586108558*^9}, {3.5919666902164965`*^9, 
   3.591966763159698*^9}, {3.591966907214932*^9, 3.5919669258369946`*^9}, {
   3.5919669973460894`*^9, 3.5919670006722765`*^9}, {3.591967325434878*^9, 
   3.5919673503103027`*^9}, {3.59196739122465*^9, 3.5919674086216607`*^9}, {
   3.591967518165934*^9, 3.5919675236412277`*^9}, {3.5919676233479385`*^9, 
   3.591967685394489*^9}, {3.5919679490865927`*^9, 3.591967960879272*^9}, {
   3.591967992922103*^9, 3.591968018706579*^9}, {3.591968094305909*^9, 
   3.5919681044634905`*^9}, 3.59196814950207*^9, {3.5919682109965873`*^9, 
   3.5919682220952272`*^9}, {3.591968331188474*^9, 3.591968333007574*^9}, {
   3.591968916191976*^9, 3.591968947416768*^9}, {3.591968992284333*^9, 
   3.591969078972293*^9}, {3.5919691418809*^9, 3.5919691646592083`*^9}, {
   3.591969219010312*^9, 3.591969222032494*^9}, {3.591969272425376*^9, 
   3.5919693149058084`*^9}, {3.59196936102645*^9, 3.5919695112900543`*^9}, {
   3.591969742317304*^9, 3.591969778888378*^9}, {3.5919698349765916`*^9, 
   3.5919699005123405`*^9}, {3.5919700065034113`*^9, 
   3.5919700173780346`*^9}, {3.591970099600746*^9, 3.591970111023403*^9}, {
   3.5919701471124663`*^9, 3.5919702156553917`*^9}, {3.5919702555916834`*^9, 
   3.5919703064705963`*^9}, {3.5919704222892213`*^9, 3.591970426898488*^9}, {
   3.5919706361224704`*^9, 3.591970672050527*^9}, {3.5919707022892756`*^9, 
   3.5919707846559763`*^9}, {3.591970817640865*^9, 3.591970820468027*^9}, {
   3.591970882703591*^9, 3.5919709540366745`*^9}, {3.5919710737145295`*^9, 
   3.591971136037117*^9}, {3.591971199169716*^9, 3.5919712038809834`*^9}, {
   3.5919712349807835`*^9, 3.591971290144924*^9}, {3.591971321250701*^9, 
   3.591971322078752*^9}, {3.591971366807314*^9, 3.591971370453523*^9}, {
   3.59197144947705*^9, 3.591971452716234*^9}, {3.5919715862398806`*^9, 
   3.591971589876092*^9}, {3.591971696062169*^9, 3.591971745267987*^9}, {
   3.5919718031022987`*^9, 3.5919718083496*^9}, {3.591971867808004*^9, 
   3.5919718874791307`*^9}, {3.5919719700568604`*^9, 
   3.5919719932041855`*^9}, {3.591972081054221*^9, 3.591972104012548*^9}, {
   3.5919734454323483`*^9, 3.591973468920699*^9}, {3.591974011699778*^9, 
   3.591974013438878*^9}, {3.5919808609350104`*^9, 3.5919808612090263`*^9}, {
   3.5919810618485136`*^9, 3.5919811361027727`*^9}, 3.591981244015953*^9, {
   3.5919812930867586`*^9, 3.591981293308771*^9}, {3.5919814163888197`*^9, 
   3.5919814817125607`*^9}, {3.5919815160725284`*^9, 3.591981537998784*^9}, {
   3.5919815734578147`*^9, 3.591981576809024*^9}, {3.5919816509402514`*^9, 
   3.59198165791965*^9}, {3.5919818629693937`*^9, 3.5919818980884047`*^9}, {
   3.5919824239855223`*^9, 3.591982460789629*^9}, {3.591982492748459*^9, 
   3.591982594051259*^9}, {3.5919826250910397`*^9, 3.5919826280892096`*^9}, {
   3.5919843474556704`*^9, 3.5919844042699256`*^9}, {3.591985237686652*^9, 
   3.591985238045673*^9}, {3.59198550416591*^9, 3.5919855590930777`*^9}, {
   3.59198559649922*^9, 3.591985631085181*^9}, {3.59198574334461*^9, 
   3.591985936819685*^9}, {3.591985966826404*^9, 3.5919859850104465`*^9}, {
   3.591986016059227*^9, 3.5919860187603817`*^9}, {3.5919860573545923`*^9, 
   3.5919861335549555`*^9}, {3.59198616525079*^9, 3.5919863629700933`*^9}, 
   3.591986501619033*^9, {3.5919865545720663`*^9, 3.5919865562011595`*^9}, {
   3.591988154043663*^9, 3.5919882460329304`*^9}, {3.59198844788949*^9, 
   3.5919885376516294`*^9}, {3.59198886050712*^9, 3.5919888616751833`*^9}, {
   3.591989095229561*^9, 3.59198914323331*^9}, {3.591989447091711*^9, 
   3.591989455011165*^9}, {3.591989485289898*^9, 3.591989588515809*^9}, {
   3.591990221156039*^9, 3.5919902383710246`*^9}, {3.5919904023634167`*^9, 
   3.59199040753971*^9}, {3.5920191222541075`*^9, 3.5920191513447733`*^9}, {
   3.592019251794526*^9, 3.5920192541006575`*^9}, {3.5920193075877204`*^9, 
   3.5920193079677463`*^9}, {3.5920211144551935`*^9, 
   3.5920211906475573`*^9}, {3.5920212308898616`*^9, 
   3.5920212309528666`*^9}, {3.592021408762048*^9, 3.5920214125502663`*^9}, {
   3.5920215956877527`*^9, 3.5920216271285534`*^9}, {3.5920217520357065`*^9, 
   3.592021757851034*^9}, {3.592021854305563*^9, 3.5920218576557503`*^9}, {
   3.5920218951319013`*^9, 3.5920219376553364`*^9}, {3.5920220668367343`*^9, 
   3.592022084843765*^9}, {3.5920221221168995`*^9, 3.5920221291793056`*^9}, {
   3.5920221848515005`*^9, 3.5920222079158125`*^9}, {3.592022260668838*^9, 
   3.59202231044368*^9}, {3.5920233491791697`*^9, 3.5920234177130976`*^9}, {
   3.5920234781785564`*^9, 3.592023499753792*^9}, {3.592023649647376*^9, 
   3.5920236750338483`*^9}, {3.592023759600672*^9, 3.5920237706573057`*^9}, {
   3.592023858000308*^9, 3.592023871612087*^9}, {3.592023909226241*^9, 
   3.5920239136334934`*^9}, {3.5920239706827602`*^9, 3.59202397275988*^9}, {
   3.592024050467326*^9, 3.592024053852524*^9}, {3.5920242516398497`*^9, 
   3.5920242522718863`*^9}, {3.5920243099851866`*^9, 
   3.5920243314414225`*^9}, {3.592024367419481*^9, 3.5920243797131844`*^9}, {
   3.5920244113219953`*^9, 3.5920244355843844`*^9}, {3.5920244749216504`*^9, 
   3.592024540296382*^9}, {3.59202495781929*^9, 3.5920249646766834`*^9}, {
   3.5920261122994037`*^9, 3.592026163535356*^9}, {3.5920262250508623`*^9, 
   3.5920262258009043`*^9}, {3.592026353116192*^9, 3.5920263586745167`*^9}, {
   3.5920268552929497`*^9, 3.5920268893559*^9}, 3.5920270729594126`*^9, 
   3.592027111741639*^9, {3.592027213803483*^9, 3.5920273053397284`*^9}, {
   3.592027354686551*^9, 3.592027503192069*^9}, 3.592027739368584*^9, {
   3.592027807353473*^9, 3.5920278566703014`*^9}, {3.592027932934663*^9, 
   3.5920279469414716`*^9}, {3.592028086095437*^9, 3.5920280866294856`*^9}, {
   3.592028150280136*^9, 3.5920281679351225`*^9}, {3.5920282966624947`*^9, 
   3.5920283207438745`*^9}, {3.592028376097044*^9, 3.5920284159013233`*^9}, {
   3.5920286515518155`*^9, 3.592028669837861*^9}, 3.592028832530186*^9, 
   3.592028879106868*^9, {3.59202969739671*^9, 3.592029780606475*^9}, {
   3.5920299758696527`*^9, 3.5920300202762003`*^9}, {3.5920307968323555`*^9, 
   3.5920308540006275`*^9}, {3.5920309340882154`*^9, 3.592030942078673*^9}, {
   3.592031025742468*^9, 3.5920310689589386`*^9}, {3.5920536235012884`*^9, 
   3.5920536292766104`*^9}, 3.5920920366420693`*^9, {3.5920920748732586`*^9, 
   3.5920920839287777`*^9}, {3.5920921188567944`*^9, 
   3.5920921237280517`*^9}, {3.592092245785046*^9, 3.592092249064253*^9}, {
   3.5920923530341873`*^9, 3.5920923843299775`*^9}, {3.592092431574685*^9, 
   3.5920924322787294`*^9}, {3.5920926309180975`*^9, 
   3.5920926522483206`*^9}, {3.5920927206542397`*^9, 3.592092802566931*^9}, {
   3.592092850431676*^9, 3.5920928519997625`*^9}, {3.5920929386157227`*^9, 
   3.59209301847129*^9}, {3.592093067837122*^9, 3.5920931586533227`*^9}, {
   3.5920941412965956`*^9, 3.5920941464958935`*^9}, {3.5920944109370365`*^9, 
   3.5920944407417436`*^9}, {3.5920948905745087`*^9, 
   3.5920948964368396`*^9}, {3.592095505386712*^9, 3.5920955178874283`*^9}, {
   3.5920958320944223`*^9, 3.59209585731087*^9}, {3.592096107532195*^9, 
   3.59209615325781*^9}, {3.592096214596327*^9, 3.592096275755825*^9}, {
   3.5920967434426165`*^9, 3.592096756278346*^9}, {3.5920968301675787`*^9, 
   3.5920968477995853`*^9}, {3.59209703432327*^9, 3.5920971100366054`*^9}, 
   3.5920976792472024`*^9, {3.5920980579698906`*^9, 3.5920980771519885`*^9}, {
   3.592098110919923*^9, 3.592098155351471*^9}, {3.5921048667628045`*^9, 
   3.592104903685919*^9}, {3.5921049353997374`*^9, 3.5921049562259445`*^9}, {
   3.592104998602357*^9, 3.592105071698543*^9}, {3.5921051377633233`*^9, 
   3.5921051400214562`*^9}, {3.5921051763245344`*^9, 3.59210519195243*^9}, {
   3.5921052309746637`*^9, 3.5921052323227415`*^9}, {3.5921063442544184`*^9, 
   3.592106346948591*^9}, {3.592110015011635*^9, 3.5921100185498314`*^9}, {
   3.5921106985877805`*^9, 3.592110699631854*^9}, {3.592112351747447*^9, 
   3.5921124442277575`*^9}, {3.592112485249092*^9, 3.592112509319472*^9}, {
   3.5921125511578703`*^9, 3.592112578183414*^9}, {3.5921130314643717`*^9, 
   3.5921130354486*^9}, {3.5921175937996426`*^9, 3.5921175942786646`*^9}, {
   3.5921176390322313`*^9, 3.59211765781631*^9}, {3.5921177193428354`*^9, 
   3.5921177570999937`*^9}, {3.5921178177504663`*^9, 
   3.5921178260369377`*^9}, {3.5921178779349165`*^9, 
   3.5921179512931147`*^9}, {3.5921180221891737`*^9, 3.592118033492821*^9}, {
   3.592124147733387*^9, 3.5921242210195913`*^9}, {3.5921242560705957`*^9, 
   3.592124259242778*^9}, {3.592124378582611*^9, 3.5921243803017287`*^9}, {
   3.592124435895894*^9, 3.592124441207198*^9}, {3.59212447967741*^9, 
   3.5921245605310307`*^9}, {3.592152543221595*^9, 3.592152618142889*^9}, {
   3.5921526731930566`*^9, 3.5921526733290453`*^9}, {3.5921529158269324`*^9, 
   3.5921529389462566`*^9}, {3.592153054945899*^9, 3.592153056436984*^9}, 
   3.592153089027851*^9, {3.5921800169339256`*^9, 3.592180057502246*^9}, {
   3.592180146639349*^9, 3.5921803679880247`*^9}, {3.5921803981457663`*^9, 
   3.5921804310816383`*^9}, {3.592180483553643*^9, 3.592180515165453*^9}, {
   3.5921805973291583`*^9, 3.5921806070917177`*^9}, {3.5921807813326917`*^9, 
   3.5921808111544037`*^9}, 3.5921808461234064`*^9, {3.5921811366380424`*^9, 
   3.59218115295498*^9}, {3.592181188791048*^9, 3.5921811889170375`*^9}, {
   3.592181239835953*^9, 3.592181249089486*^9}, {3.5921812920669413`*^9, 
   3.5921812921369486`*^9}, {3.5921815868728266`*^9, 
   3.5921815891119547`*^9}, {3.592181870747078*^9, 3.5921818734962406`*^9}, 
   3.59218208888758*^9, {3.5921821893503265`*^9, 3.592182249659778*^9}, {
   3.5921825273226833`*^9, 3.592182528582755*^9}, {3.5921826427972937`*^9, 
   3.5921826503587384`*^9}, {3.5921879640072093`*^9, 
   3.5921879691885223`*^9}, {3.5921880522502604`*^9, 3.592188057812592*^9}, {
   3.592188329703144*^9, 3.592188343532941*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 3.5914868026208353`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{624, 887},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 86, "Section"],
Cell[682, 25, 1643, 31, 172, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2362, 61, 160, 2, 86, "Section"],
Cell[2525, 65, 634, 16, 92, "Input",
 InitializationCell->True],
Cell[3162, 83, 3078, 73, 237, "Input",
 InitializationCell->True],
Cell[6243, 158, 8260, 175, 537, "Input",
 InitializationCell->True],
Cell[14506, 335, 10262, 249, 812, "Input",
 InitializationCell->True],
Cell[24771, 586, 4806, 115, 355, "Input",
 InitializationCell->True],
Cell[29580, 703, 10032, 187, 332, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39649, 895, 145, 2, 86, "Section"],
Cell[39797, 899, 11220, 271, 1132, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51054, 1175, 149, 2, 86, "Section"],
Cell[51206, 1179, 58351, 1158, 3232, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[109594, 2342, 30, 0, 86, "Section"],
Cell[109627, 2344, 207, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
