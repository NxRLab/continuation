(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     93411,       1912]
NotebookOptionsPosition[     92251,       1867]
NotebookOutlinePosition[     92626,       1883]
CellTagsIndexPosition[     92583,       1880]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<NLink`\>\"", "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.592241768075292*^9, 3.5922417692471714`*^9}, {3.592242084931059*^9, 
   3.5922420876966925`*^9}, 3.5922421309311514`*^9, {3.592255703284815*^9, 
   3.592255706497998*^9}, {3.59225574155902*^9, 3.592255745349224*^9}, {
   3.5922557821253295`*^9, 3.592255815751254*^9}, {3.5922559034172745`*^9, 
   3.5922559113667307`*^9}, {3.5922800860555387`*^9, 3.592280103747531*^9}, {
   3.59275716675933*^9, 3.5927571696474915`*^9}, 3.5927838101231008`*^9, {
   3.5933676479376955`*^9, 3.5933676483126965`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Joint Library", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.5922560027239647`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<rx\>\"", "]"}], " ", "=", " ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<ry\>\"", "]"}], " ", "=", " ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<rz\>\"", "]"}], " ", "=", " ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<px\>\"", "]"}], " ", "=", " ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<py\>\"", "]"}], " ", "=", " ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<pz\>\"", "]"}], " ", "=", " ", 
   RowBox[{"I6", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<sph\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<rx\>\"", ",", " ", "\"\<ry\>\"", ",", " ", "\"\<rz\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joint", "[", "\"\<fb\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<px\>\"", ",", " ", "\"\<py\>\"", ",", " ", "\"\<pz\>\"", ",", " ", 
     "\"\<rx\>\"", ",", " ", "\"\<ry\>\"", ",", " ", "\"\<rz\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joint", "[", "\"\<pln\>\"", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<px\>\"", ",", " ", "\"\<py\>\"", ",", " ", "\"\<rz\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<rx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"rotX", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<ry\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"rotY", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<rz\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"rotZ", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<px\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"transX", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XJ", "[", "\"\<py\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"transY", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XJ", "[", "\"\<pz\>\"", "]"}], " ", "=", "  ", 
    RowBox[{"transZ", "[", "#", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<rx\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"drotX", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<ry\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"drotY", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<rz\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"drotZ", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<px\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"dtransX", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<py\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"dtransY", "[", "#", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXJ", "[", "\"\<pz\>\"", "]"}], " ", "=", "  ", 
   RowBox[{"dtransZ", "[", "#", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.591667817527995*^9, 3.591668923825349*^9, {3.5916697599352307`*^9, 
   3.591669819815657*^9}, {3.5916698753458366`*^9, 3.5916698888766146`*^9}, {
   3.5916699961457586`*^9, 3.591669997476833*^9}, {3.59167068192603*^9, 
   3.59167070374928*^9}, {3.5917208858180676`*^9, 3.591720889380574*^9}, {
   3.5917221970292563`*^9, 3.591722203732394*^9}, {3.591722238732463*^9, 
   3.591722239091839*^9}, {3.591930526907305*^9, 3.5919305664205675`*^9}, {
   3.5919306118141713`*^9, 3.591930612108184*^9}, 3.591930660729968*^9, {
   3.591930696356006*^9, 3.5919307386704297`*^9}, {3.5919308258974266`*^9, 
   3.5919308840727587`*^9}, {3.591931024599806*^9, 3.591931025034828*^9}, {
   3.591931958433284*^9, 3.5919319593043294`*^9}, {3.5919331117973347`*^9, 
   3.5919331580109777`*^9}, {3.591933250024245*^9, 3.591933252427383*^9}, {
   3.591985667141246*^9, 3.5919857313879256`*^9}, {3.591987361798293*^9, 
   3.591987364276435*^9}, {3.5919978599754896`*^9, 3.59199787152915*^9}, 
   3.5919979113604307`*^9, {3.5919979589681625`*^9, 3.5919979727709627`*^9}, 
   3.5919982080554256`*^9, {3.5920191973504057`*^9, 3.592019234797552*^9}, {
   3.5921518015301204`*^9, 3.592151821661277*^9}, {3.5921518519500084`*^9, 
   3.5921518784545245`*^9}, {3.5921519174737606`*^9, 3.592151918642827*^9}, {
   3.5921519914750166`*^9, 3.5921519924810553`*^9}, 3.5921521161271386`*^9, {
   3.5921521472189164`*^9, 3.592152245920565*^9}, {3.5921524640720634`*^9, 
   3.5921524695633802`*^9}, {3.5921527028097334`*^9, 
   3.5921527107801905`*^9}, {3.59215278839163*^9, 3.592152817779317*^9}, 
   3.5921530282183657`*^9, {3.59215320443246*^9, 3.5921532065185785`*^9}, {
   3.5922519586863747`*^9, 3.592251999186454*^9}, {3.592254165862566*^9, 
   3.5922542064876456`*^9}, {3.5922558428788123`*^9, 
   3.5922558607708282`*^9}, {3.5922558957868533`*^9, 3.592255901201167*^9}, {
   3.592255970324107*^9, 3.592255983444855*^9}, {3.5922563270036964`*^9, 
   3.592256338941219*^9}, {3.592257092435753*^9, 3.592257120589362*^9}, {
   3.5922572679818015`*^9, 3.592257307993095*^9}, {3.5922573544977603`*^9, 
   3.5922573588390207`*^9}, {3.5922584862415714`*^9, 
   3.5922584970631905`*^9}, {3.592272339145876*^9, 3.5922723397079115`*^9}, {
   3.5922724406026893`*^9, 3.5922724506392612`*^9}, {3.5923285065322204`*^9, 
   3.5923285261783457`*^9}, {3.592328588945943*^9, 3.5923285926511564`*^9}, {
   3.592378451717498*^9, 3.592378472565692*^9}, {3.592378552618276*^9, 
   3.5923786444545345`*^9}, {3.5927901083724346`*^9, 
   3.5927901285295887`*^9}, {3.592790375934758*^9, 3.5927903911896305`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial Vector Transformations", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.5922560027239647`*^9}, {3.5927607764450436`*^9, 3.5927607827644053`*^9}, {
  3.5933114168848066`*^9, 3.593311420744175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"parent", " ", "to", " ", "child", " ", "transform"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Xip", "[", "i", "]"}], ",", " ", 
    RowBox[{
     RowBox[{
     "where", " ", "i", " ", "is", " ", "an", " ", "integer", " ", "is", " ", 
      "defined", " ", "in", " ", 
      RowBox[{"ExpandParameters", "[", "]"}]}], ";", " ", 
     RowBox[{"same", " ", "with", " ", 
      RowBox[{
       RowBox[{"dXip", "[", "i", "]"}], "."}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Xip", "[", "x_List", "]"}], " ", ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Xip", "[", "i", "]"}], "[", 
        RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nq"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dXip", "[", 
      RowBox[{"x_List", ",", " ", "dx_List"}], "]"}], " ", ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"tensprod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dXip", "[", "i", "]"}], "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}], ",", " ", 
         RowBox[{
         "dx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nq"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "these", " ", "are", " ", "useful", " ", "when", " ", "using", " ", 
     RowBox[{"Compile", "[", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Xip", "[", "x_Symbol", "]"}], " ", ":=", " ", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Xip", "[", "i", "]"}], "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "nq"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dXip", "[", 
      RowBox[{"x_Symbol", ",", " ", "dx_Symbol"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", " ", "i"}], "}"}], ",", "  ", 
       RowBox[{
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"dx", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "n\[Lambda]"}], "}"}]}], "]"}]}]}], ";", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"tensprod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dXip", "[", "i", "]"}], "[", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], ",", " ", "d"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "nq"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "puts", " ", "all", " ", "body", " ", "spatial", " ", "vectors", " ", 
      "in", " ", "a", " ", "common", " ", "frame"}], ",", " ", 
     RowBox[{
     "where", " ", "fr", " ", "is", " ", "the", " ", "frame", " ", 
      "associated", " ", "with", " ", "body", " ", 
      RowBox[{"i", ".", "  ", "Optionally"}]}], ",", " ", 
     RowBox[{
     "a", " ", "transformation", " ", "X", " ", "can", " ", "be", " ", 
      "applied", " ", 
      RowBox[{"afterwards", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jcoord", "[", 
      RowBox[{"q_", ",", " ", "fr_", ",", " ", 
       RowBox[{"X_:", "I6"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p", ",", " ", "J", ",", " ", "XL", ",", " ", "X0", ",", " ", "Xfr"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"J", " ", "=", " ", "Zspat"}], ";", "\[IndentingNewLine]", 
        RowBox[{"XL", " ", "=", " ", 
         RowBox[{"Xip", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"X0", " ", "=", " ", "XL"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"p", " ", "=", " ", 
            RowBox[{
            "parent", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
             RowBox[{
              RowBox[{
              "X0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              " ", "=", " ", 
              RowBox[{
               RowBox[{
               "XL", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               ".", 
               RowBox[{
               "X0", "\[LeftDoubleBracket]", "p", 
                "\[RightDoubleBracket]"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "J", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
            "=", " ", 
            RowBox[{
             RowBox[{"InvXba", "[", 
              RowBox[{
              "X0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], ".", 
             RowBox[{
             "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
           ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "nq"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Xfr", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fr", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
           RowBox[{
           "X0", "\[LeftDoubleBracket]", "fr", "\[RightDoubleBracket]"}], ",",
            "I6"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Xfr", " ", "=", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"VectorQ", "[", "X", "]"}], ",", " ", 
            RowBox[{"Xba", "[", "X", "]"}], ",", " ", "X"}], "]"}], ".", 
          "Xfr"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Xfr", ".", 
         RowBox[{"J", "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.592760784808523*^9, 3.5927608324382477`*^9}, {
   3.592760878606894*^9, 3.592760898519035*^9}, {3.5927609330070095`*^9, 
   3.5927609406134453`*^9}, {3.592766529164482*^9, 3.5927665579241295`*^9}, {
   3.5927682348361607`*^9, 3.5927682531012063`*^9}, {3.5927686522540607`*^9, 
   3.592768659061454*^9}, {3.592768729429488*^9, 3.5927687465334625`*^9}, {
   3.59276979423946*^9, 3.592769839110031*^9}, {3.5927698693577633`*^9, 
   3.592769938348716*^9}, {3.5927701076534095`*^9, 3.5927701098455353`*^9}, {
   3.592770260293149*^9, 3.592770268268612*^9}, {3.5927703142292395`*^9, 
   3.5927703156843233`*^9}, {3.592770382294149*^9, 3.5927704932134895`*^9}, {
   3.59277057667127*^9, 3.592770624463006*^9}, {3.592770725399786*^9, 
   3.5927707436078253`*^9}, {3.5927708834468355`*^9, 
   3.5927710671673574`*^9}, {3.592771115960148*^9, 3.5927711428946953`*^9}, {
   3.59277121546385*^9, 3.5927712317987895`*^9}, {3.5927712903521366`*^9, 
   3.5927714878474483`*^9}, {3.5927715218253946`*^9, 
   3.5927716903440633`*^9}, {3.592771744638154*^9, 3.592771808928832*^9}, {
   3.5927718583536663`*^9, 3.5927718926686325`*^9}, {3.592771953905138*^9, 
   3.592771969039005*^9}, {3.5927725839822206`*^9, 3.5927725929257307`*^9}, {
   3.5927730784815392`*^9, 3.592773078878561*^9}, {3.5927732726666584`*^9, 
   3.5927733236765795`*^9}, {3.5927734103485394`*^9, 3.592773412926691*^9}, {
   3.5927736412547674`*^9, 3.592773643358886*^9}, {3.592773801937967*^9, 
   3.5927738025860057`*^9}, {3.5927740306490664`*^9, 3.592774079640867*^9}, {
   3.5927750254350348`*^9, 3.5927750281381893`*^9}, {3.592777833891865*^9, 
   3.59277783901816*^9}, {3.592783957812561*^9, 3.5927839578995657`*^9}, {
   3.5927870246928425`*^9, 3.5927870250518675`*^9}, {3.592787292671186*^9, 
   3.5927873057159476`*^9}, {3.592790214908536*^9, 3.592790217002653*^9}, {
   3.5927903999641466`*^9, 3.5927904012272067`*^9}, {3.592995460850711*^9, 
   3.592995495397651*^9}, {3.5929960346174555`*^9, 3.592996038476839*^9}, {
   3.5929961196332474`*^9, 3.5929961478989267`*^9}, {3.5929961936802654`*^9, 
   3.5929962434147387`*^9}, {3.5931325883082275`*^9, 
   3.5931326315270615`*^9}, {3.5931326715427656`*^9, 3.593132710511591*^9}, {
   3.593132749871039*^9, 3.5931327614960656`*^9}, {3.593132826074318*^9, 
   3.5931328523087435`*^9}, {3.593133979896178*^9, 3.593134048286936*^9}, 
   3.593134833725971*^9, {3.5931349307261624`*^9, 3.5931349651637278`*^9}, {
   3.5931350390857477`*^9, 3.593135047851391*^9}, {3.593135773587183*^9, 
   3.5931358311497974`*^9}, {3.5931358627592344`*^9, 
   3.5931358800248938`*^9}, {3.5931360458533382`*^9, 
   3.5931360997284484`*^9}, {3.593136139291025*^9, 3.5931361586973133`*^9}, {
   3.5931362017911477`*^9, 3.5931362034630256`*^9}, {3.593136250244363*^9, 
   3.593136259900636*^9}, {3.59313635097894*^9, 3.593136364666479*^9}, {
   3.5931365562762156`*^9, 3.5931365564637165`*^9}, 3.593136602635681*^9, {
   3.5931366493701477`*^9, 3.5931366540420322`*^9}, {3.593136984855179*^9, 
   3.5931369977770777`*^9}, {3.5931370621990795`*^9, 3.593137087183503*^9}, {
   3.593137151714882*^9, 3.5931371665117836`*^9}, {3.593137279527629*^9, 
   3.593137328996477*^9}, {3.5931373949966063`*^9, 3.593137395277856*^9}, {
   3.593137802872402*^9, 3.5931378732162905`*^9}, {3.593137950466442*^9, 
   3.5931379552789493`*^9}, 3.593137988122766*^9, 3.593138103263616*^9, {
   3.5931381489512053`*^9, 3.5931381559199677`*^9}, {3.593138197201305*^9, 
   3.59313821360758*^9}, {3.5931384066079597`*^9, 3.5931384404205256`*^9}, {
   3.59313847838935*^9, 3.5931384787956004`*^9}, {3.5931392106564074`*^9, 
   3.593139210718907*^9}, {3.593141882053808*^9, 3.5931418852569375`*^9}, {
   3.593142085413581*^9, 3.5931420890385876`*^9}, {3.593194639815832*^9, 
   3.5931946400814686`*^9}, {3.593194692597185*^9, 3.593194695534686*^9}, 
   3.59319504037912*^9, {3.5931951305980396`*^9, 3.593195145269945*^9}, {
   3.593195180676261*^9, 3.5931952042075586`*^9}, {3.5931955700207744`*^9, 
   3.5931955711614013`*^9}, {3.593195949271521*^9, 3.593196057740488*^9}, {
   3.5931962478658695`*^9, 3.5931962622877517`*^9}, {3.5931964707881603`*^9, 
   3.593196540178919*^9}, {3.593196578413391*^9, 3.5931966391791296`*^9}, {
   3.593196719085543*^9, 3.5931967236167793`*^9}, {3.593196907476515*^9, 
   3.5931969106171417`*^9}, {3.593196978976653*^9, 3.59319700141422*^9}, {
   3.593197086164364*^9, 3.593197088695617*^9}, 3.593197444368188*^9, {
   3.593297477246256*^9, 3.593297502636914*^9}, 3.5932976188402677`*^9, {
   3.5932976652153597`*^9, 3.5932976903560343`*^9}, {3.59329813829441*^9, 
   3.593298233763345*^9}, {3.593298263763405*^9, 3.5932982760915556`*^9}, {
   3.5932984218105903`*^9, 3.5932984384824934`*^9}, {3.5932985106857634`*^9, 
   3.593298531967055*^9}, {3.593299352828043*^9, 3.593299387703105*^9}, {
   3.593300968471818*^9, 3.593300979049966*^9}, {3.5933112546344757`*^9, 
   3.5933113058689504`*^9}, {3.5933113612128115`*^9, 3.5933114017128906`*^9}, 
   3.593316537444393*^9, {3.6027030542765026`*^9, 3.6027031907393165`*^9}, {
   3.602703404912594*^9, 3.602703476944707*^9}, 3.6027035272805915`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetModel", "[", 
     RowBox[{
     "j_", ",", " ", "\[Lambda]_", ",", " ", "c_", ",", " ", "g_", ",", " ", 
      "\[DoubleStruckCapitalI]c_", ",", " ", "fr_", ",", " ", 
      RowBox[{"nparam_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1", ",", "c2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c1", ",", "c2"}], "}"}], " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"c", " ", "\[Equal]", " ", 
           RowBox[{"{", "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", "c"}], "}"}], ",", " ", "c"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ExpandTree", "[", 
        RowBox[{"j", ",", " ", "\[Lambda]", ",", " ", "c1"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "also", " ", "sets", " ", "number", " ", "of", " ", "links"}], ",", 
         " ", "dofs", ",", " ", 
         RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetDerivatives", "[", "nparam", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"initialize", " ", "derivative", " ", "data"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "in", " ", "ExpandParameters"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"XL", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"this", " ", "is", " ", "set", " ", "in", " ", 
         RowBox[{"F", "[", "...", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ag", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"z3", ",", " ", "g"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Zspat", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"nq", ",", " ", "nm"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ZM", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"nq", ",", " ", "nq"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"znq", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "nq"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", "c2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ZJ", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"mb", ",", " ", "nq"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Zosim", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"mb", ",", " ", "mb"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zmb", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "mb"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Zmb", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"mb", ",", " ", "n\[Lambda]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ExpandParameters", "[", 
        RowBox[{"j", ",", " ", "\[DoubleStruckCapitalI]c", ",", " ", "fr"}], 
        "]"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"sets", " ", "s"}], ",", " ", "fext", ",", " ", 
       "\[DoubleStruckCapitalI]", ",", " ", 
       RowBox[{"and", " ", "Xip"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDerivatives", "[", "n_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n\[Lambda]", " ", "=", " ", "n"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d\[DoubleStruckCapitalI]", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{
             "nq", ",", " ", "nm", ",", " ", "nm", ",", " ", "n\[Lambda]"}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dXL", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"this", " ", "is", " ", "set", " ", "in", " ", 
           RowBox[{"F", "[", "...", "]"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Zdspat", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"nq", ",", " ", "nm", ",", " ", "n\[Lambda]"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ZdM", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"nq", ",", " ", "nq", ",", " ", "n\[Lambda]"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Znq", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"nq", ",", " ", "n\[Lambda]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ZdJ", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"mb", ",", " ", "nq", ",", " ", "n\[Lambda]"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Zdosim", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"mb", ",", " ", "mb", ",", " ", "n\[Lambda]"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Zmb", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"mb", ",", " ", "n\[Lambda]"}], "}"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.591667817527995*^9, 3.591668923825349*^9, {3.5916697599352307`*^9, 
   3.591669819815657*^9}, {3.5916698753458366`*^9, 3.5916698888766146`*^9}, {
   3.5916699961457586`*^9, 3.591669997476833*^9}, {3.59167068192603*^9, 
   3.59167070374928*^9}, {3.5917208858180676`*^9, 3.591720889380574*^9}, {
   3.5917221970292563`*^9, 3.591722203732394*^9}, {3.591722238732463*^9, 
   3.591722239091839*^9}, {3.591930526907305*^9, 3.5919305664205675`*^9}, {
   3.5919306118141713`*^9, 3.591930612108184*^9}, 3.591930660729968*^9, {
   3.591930696356006*^9, 3.5919307386704297`*^9}, {3.5919308258974266`*^9, 
   3.5919308840727587`*^9}, {3.591931024599806*^9, 3.591931025034828*^9}, {
   3.591931958433284*^9, 3.5919319593043294`*^9}, {3.5919331117973347`*^9, 
   3.5919331580109777`*^9}, {3.591933250024245*^9, 3.591933252427383*^9}, {
   3.591985667141246*^9, 3.5919857313879256`*^9}, {3.591987361798293*^9, 
   3.591987364276435*^9}, {3.5919978599754896`*^9, 3.59199787152915*^9}, 
   3.5919979113604307`*^9, {3.5919979589681625`*^9, 3.5919979727709627`*^9}, 
   3.5919982080554256`*^9, {3.5920191973504057`*^9, 3.592019234797552*^9}, {
   3.5921518015301204`*^9, 3.592151821661277*^9}, {3.5921518519500084`*^9, 
   3.5921518784545245`*^9}, {3.5921519174737606`*^9, 3.592151918642827*^9}, {
   3.5921519914750166`*^9, 3.5921519924810553`*^9}, 3.5921521161271386`*^9, {
   3.5921521472189164`*^9, 3.592152245920565*^9}, {3.5921524640720634`*^9, 
   3.5921524695633802`*^9}, {3.5921527028097334`*^9, 
   3.5921527107801905`*^9}, {3.59215278839163*^9, 3.592152817779317*^9}, 
   3.5921530282183657`*^9, {3.59215320443246*^9, 3.5921532065185785`*^9}, {
   3.5922519586863747`*^9, 3.592251999186454*^9}, {3.592254165862566*^9, 
   3.5922542064876456`*^9}, {3.5922558428788123`*^9, 
   3.5922558607708282`*^9}, {3.5922558957868533`*^9, 3.592255901201167*^9}, 
   3.592255970324107*^9, {3.5922580456873465`*^9, 3.592258045853349*^9}, {
   3.5922581158633614`*^9, 3.592258139375705*^9}, {3.592258226580702*^9, 
   3.592258231348975*^9}, {3.592258396619439*^9, 3.5922584020647693`*^9}, {
   3.592258438962861*^9, 3.592258459774053*^9}, {3.5922591760830736`*^9, 
   3.5922591855486183`*^9}, {3.592259257920762*^9, 3.5922592787549534`*^9}, {
   3.5922594413162627`*^9, 3.592259469596903*^9}, {3.592259570929685*^9, 
   3.5922595851425023`*^9}, {3.592259622531643*^9, 3.5922596920396233`*^9}, {
   3.5922597847129307`*^9, 3.59225978836014*^9}, {3.592265284603904*^9, 
   3.592265302772931*^9}, {3.5922660757641973`*^9, 3.592266168732519*^9}, {
   3.592266745226554*^9, 3.5922667453035393`*^9}, 3.5922667840087557`*^9, {
   3.592266872124799*^9, 3.592266894180065*^9}, {3.5922669756537285`*^9, 
   3.5922669960148973`*^9}, {3.5922671554480267`*^9, 
   3.5922672007746234`*^9}, {3.592267352764331*^9, 3.592267352851329*^9}, {
   3.5922673878293343`*^9, 3.5922674271685877`*^9}, {3.5922677518271804`*^9, 
   3.592267753864293*^9}, {3.592269365102566*^9, 3.5922693810894814`*^9}, {
   3.5922694704245977`*^9, 3.59226951552118*^9}, 3.592269559872718*^9, {
   3.592269596464834*^9, 3.592269605997359*^9}, {3.592269651011939*^9, 
   3.5922696511789675`*^9}, {3.592269686507972*^9, 3.59226972943143*^9}, {
   3.5922698283110924`*^9, 3.5922699566064405`*^9}, {3.5922700800495105`*^9, 
   3.592270104246894*^9}, {3.5922701343156166`*^9, 3.5922701411890078`*^9}, {
   3.5922701729868326`*^9, 3.592270182028349*^9}, {3.59227026813428*^9, 
   3.592270307654543*^9}, {3.592270789010106*^9, 3.592270804936021*^9}, {
   3.592271003227376*^9, 3.5922710164511337`*^9}, {3.5922710767405863`*^9, 
   3.592271096212701*^9}, {3.5922712492224765`*^9, 3.59227124969849*^9}, 
   3.5922713284640007`*^9, {3.592271377491807*^9, 3.5922713780178576`*^9}, {
   3.5922714086255894`*^9, 3.592271408733595*^9}, {3.5922714892252083`*^9, 
   3.592271557448115*^9}, {3.5922717878813114`*^9, 3.592271820858195*^9}, 
   3.5922718793635445`*^9, {3.592271916862694*^9, 3.592271917492734*^9}, {
   3.592271975838073*^9, 3.5922719809793663`*^9}, {3.5922721103467903`*^9, 
   3.592272167605055*^9}, {3.592272355126795*^9, 3.5922723559508424`*^9}, {
   3.592272387750682*^9, 3.592272430457106*^9}, {3.5922724624049335`*^9, 
   3.592272486586323*^9}, {3.592272554254202*^9, 3.5922725606365767`*^9}, {
   3.5922726000188184`*^9, 3.5922726042520723`*^9}, {3.592272771832677*^9, 
   3.5922727837953434`*^9}, {3.5922728195993934`*^9, 
   3.5922728631518846`*^9}, {3.5922729410483484`*^9, 
   3.5922729655267687`*^9}, {3.5922731177624674`*^9, 
   3.5922731543115797`*^9}, {3.592273310760521*^9, 3.5922734737338514`*^9}, {
   3.5922735108949947`*^9, 3.592273518410412*^9}, {3.5922735543504705`*^9, 
   3.59227358123601*^9}, {3.592273646181729*^9, 3.592273726257312*^9}, {
   3.5922737869537907`*^9, 3.5922738520135164`*^9}, {3.5922740041642246`*^9, 
   3.592274023666346*^9}, {3.592274258321784*^9, 3.5922742741106863`*^9}, {
   3.592274419230996*^9, 3.5922744193890047`*^9}, {3.59227448977404*^9, 
   3.5922745196417465`*^9}, {3.5922745553427935`*^9, 3.592274595237076*^9}, {
   3.592274638285543*^9, 3.5922746696913414`*^9}, {3.5922747972366467`*^9, 
   3.5922748309945784`*^9}, {3.592274966500351*^9, 3.592274991427766*^9}, {
   3.592275022895569*^9, 3.592275031693086*^9}, {3.5922750665360675`*^9, 
   3.5922752337196403`*^9}, {3.5922753371725636`*^9, 
   3.5922753612429485`*^9}, {3.592275404604432*^9, 3.592275406126515*^9}, {
   3.5922755649776125`*^9, 3.5922756207168036`*^9}, {3.5922758717241945`*^9, 
   3.5922758743503284`*^9}, {3.5922805198023577`*^9, 3.592280560296678*^9}, {
   3.592280648507742*^9, 3.592280653503023*^9}, {3.59228859193862*^9, 
   3.592288631802901*^9}, {3.5922886637607336`*^9, 3.592288669778076*^9}, {
   3.5922887474895287`*^9, 3.5922887482945967`*^9}, {3.592288778321295*^9, 
   3.5922887893069234`*^9}, {3.5922930252875032`*^9, 
   3.5922930261875534`*^9}, {3.59232216412803*^9, 3.5923221645760417`*^9}, {
   3.5923222141038747`*^9, 3.5923222146439095`*^9}, {3.592322303587002*^9, 
   3.5923223085062847`*^9}, {3.592322455802719*^9, 3.592322482674258*^9}, 
   3.592322568846193*^9, {3.592323716015887*^9, 3.5923238349947195`*^9}, {
   3.5923238811463437`*^9, 3.592323903579629*^9}, {3.592323947101121*^9, 
   3.592323958546775*^9}, 3.592325020905615*^9, 3.5923250924057074`*^9, {
   3.592325178768654*^9, 3.5923251847249947`*^9}, {3.592325509846614*^9, 
   3.592325579905626*^9}, {3.592325610773393*^9, 3.592325610986409*^9}, {
   3.5923256480075245`*^9, 3.592325653257824*^9}, {3.592326357953201*^9, 
   3.5923263611073627`*^9}, {3.5923264423020124`*^9, 
   3.5923264641812835`*^9}, {3.592326512038006*^9, 3.5923266042622867`*^9}, {
   3.5923266497838936`*^9, 3.59232674643143*^9}, {3.592326830500261*^9, 
   3.5923268797860622`*^9}, {3.5923269342291837`*^9, 
   3.5923269986578894`*^9}, {3.5923270362190285`*^9, 3.592327117486677*^9}, {
   3.5923272314232144`*^9, 3.5923272715754995`*^9}, {3.5923273065705056`*^9, 
   3.592327350989049*^9}, {3.5923274125735755`*^9, 3.592327418064891*^9}, {
   3.5923275140303864`*^9, 3.5923276062176657`*^9}, {3.5923276532933617`*^9, 
   3.592327654185412*^9}, {3.5923276926456146`*^9, 3.592327692772622*^9}, {
   3.5923277288566885`*^9, 3.592327904489751*^9}, {3.592327939983777*^9, 
   3.5923279946489096`*^9}, {3.5923280273017793`*^9, 
   3.5923280708432727`*^9}, {3.592328256381916*^9, 3.592328311494054*^9}, {
   3.592328377548837*^9, 3.5923283784428883`*^9}, {3.5923290216127205`*^9, 
   3.592329030903251*^9}, 3.5923293277412486`*^9, {3.5923294589187665`*^9, 
   3.5923294903285656`*^9}, {3.592329543190589*^9, 3.59232954460567*^9}, {
   3.5923295995248127`*^9, 3.5923297137353554`*^9}, {3.5923297507114735`*^9, 
   3.5923297799551473`*^9}, {3.5923298456749153`*^9, 
   3.5923298638739705`*^9}, {3.592329916913991*^9, 3.5923299180660534`*^9}, {
   3.5923300051120396`*^9, 3.592330006966149*^9}, {3.592330040054043*^9, 
   3.5923300669505844`*^9}, {3.592330118277522*^9, 3.592330208584695*^9}, {
   3.5923302807648277`*^9, 3.5923303462545786`*^9}, {3.5923307023329697`*^9, 
   3.59233075823417*^9}, 3.59233085839291*^9, {3.5923309133830557`*^9, 
   3.592330926128785*^9}, {3.5923309567205377`*^9, 3.59233098767231*^9}, {
   3.5923310282886353`*^9, 3.592331084900878*^9}, {3.5923312539095697`*^9, 
   3.5923312777179203`*^9}, {3.5923313996679215`*^9, 3.592331563625311*^9}, {
   3.5923316207045584`*^9, 3.5923316484191484`*^9}, {3.592331710373694*^9, 
   3.59233173455208*^9}, {3.592331766743924*^9, 3.592331818322875*^9}, {
   3.592331902011675*^9, 3.5923319996242604`*^9}, {3.5923320770106974`*^9, 
   3.5923321816526823`*^9}, {3.592332323052782*^9, 3.5923323245848713`*^9}, {
   3.5923323692014256`*^9, 3.5923324045414486`*^9}, {3.592332447873933*^9, 
   3.592332509325468*^9}, {3.592332544584469*^9, 3.592332612939383*^9}, {
   3.5923327382425585`*^9, 3.592332893818468*^9}, {3.592332937962996*^9, 
   3.5923329423152466`*^9}, {3.5923330114832063`*^9, 
   3.5923330471242476`*^9}, {3.592333090562735*^9, 3.5923331256457443`*^9}, {
   3.592333182797021*^9, 3.5923332001360097`*^9}, {3.5923333254841843`*^9, 
   3.5923333524377313`*^9}, {3.5923334143242755`*^9, 3.59233362061009*^9}, {
   3.592333653265959*^9, 3.592333655125065*^9}, {3.592333718847728*^9, 
   3.5923337979862437`*^9}, {3.592333836173434*^9, 3.5923338582126956`*^9}, {
   3.592334017578822*^9, 3.592334021541049*^9}, {3.5923340968783627`*^9, 
   3.592334161335054*^9}, {3.592334191952804*^9, 3.592334217431267*^9}, {
   3.5923345274470387`*^9, 3.592334642373602*^9}, {3.5923347077953486`*^9, 
   3.59233471623883*^9}, {3.592334765200636*^9, 3.592334767330758*^9}, {
   3.592335071649193*^9, 3.5923350768634834`*^9}, {3.5923356715045385`*^9, 
   3.592335680606055*^9}, {3.5923538222759776`*^9, 3.592353831584521*^9}, {
   3.592370916535984*^9, 3.5923709463356905`*^9}, {3.5923711734726973`*^9, 
   3.5923711932798505`*^9}, {3.5923716758344617`*^9, 3.592371686130056*^9}, {
   3.592371744953433*^9, 3.59237175434396*^9}, {3.592371797994459*^9, 
   3.5923718202977347`*^9}, {3.5923747656754103`*^9, 
   3.5923747663284464`*^9}, {3.592383856791027*^9, 3.5923838888468666`*^9}, {
   3.5925242672389746`*^9, 3.592524267779004*^9}, {3.5926274023654532`*^9, 
   3.592627408631096*^9}, {3.5926275824752035`*^9, 3.592627592350204*^9}, {
   3.592629248489919*^9, 3.592629249235964*^9}, {3.592666598963564*^9, 
   3.5926666238073626`*^9}, {3.5927480544837275`*^9, 3.592748086640041*^9}, {
   3.592748144796405*^9, 3.5927481617651877`*^9}, {3.5927573412623234`*^9, 
   3.5927574347756777`*^9}, {3.59275746746855*^9, 3.5927575284640436`*^9}, {
   3.592757602718296*^9, 3.592757738909095*^9}, {3.5927578052508936`*^9, 
   3.592757817615602*^9}, {3.5927579162412496`*^9, 3.5927579330742135`*^9}, {
   3.5927579847871747`*^9, 3.5927581240521483`*^9}, {3.5927583344062004`*^9, 
   3.5927583505581193`*^9}, 3.5927585361497507`*^9, 3.5927587936214943`*^9, {
   3.5927722205204062`*^9, 3.5927722225355215`*^9}, 3.592772282776972*^9, {
   3.592772503867646*^9, 3.592772533815345*^9}, {3.5927729193364277`*^9, 
   3.5927729319051447`*^9}, 3.5927730226563387`*^9, {3.59277308372884*^9, 
   3.5927730939204226`*^9}, {3.5927736067457905`*^9, 
   3.5927736229767203`*^9}, {3.592774750369296*^9, 3.592774751706359*^9}, {
   3.592774918688921*^9, 3.5927749209450636`*^9}, {3.5927750138903694`*^9, 
   3.5927750150804386`*^9}, {3.5927758075778255`*^9, 3.5927758297290907`*^9}, 
   3.5927758991700706`*^9, 3.592776634043154*^9, {3.5927838843703566`*^9, 
   3.592783909985819*^9}, 3.5927840139887733`*^9, {3.592784078955496*^9, 
   3.592784082913722*^9}, 3.592784163587345*^9, 3.5927844291405516`*^9, {
   3.592787029139098*^9, 3.5927870296661277`*^9}, {3.592795076924966*^9, 
   3.5927950799641404`*^9}, {3.5927966990768614`*^9, 3.5927967261314106`*^9}, 
   3.5927974903971777`*^9, {3.5928532026848984`*^9, 3.5928532129349174`*^9}, {
   3.592853268575651*^9, 3.5928532751225386`*^9}, {3.5928646899159594`*^9, 
   3.5928647156035233`*^9}, {3.5928649608227425`*^9, 
   3.5928649642446213`*^9}, {3.5928650351197734`*^9, 3.592865035526013*^9}, {
   3.592997964386854*^9, 3.592997965339981*^9}, {3.5929982374186516`*^9, 
   3.5929982698562026`*^9}, {3.5929990054201403`*^9, 
   3.5929990359670744`*^9}, {3.5929990747796507`*^9, 3.592999077435906*^9}, {
   3.5929996605932937`*^9, 3.592999811718605*^9}, {3.592999847078039*^9, 
   3.5929998475780396`*^9}, {3.592999884296874*^9, 3.592999903375021*^9}, {
   3.5929999497188616`*^9, 3.592999951828241*^9}, {3.593000133500471*^9, 
   3.5930001517661314`*^9}, {3.5930001841255703`*^9, 3.593000241344432*^9}, {
   3.593000320422727*^9, 3.593000325625847*^9}, {3.5930047794626813`*^9, 
   3.5930048130252466`*^9}, {3.5930076839214864`*^9, 
   3.5930077052965283`*^9}, {3.593007753812248*^9, 3.5930077743279257`*^9}, {
   3.593007819765502*^9, 3.593007828906145*^9}, {3.593008132578616*^9, 
   3.5930082017662487`*^9}, {3.5931384523424244`*^9, 3.593138458623686*^9}, {
   3.593139223218931*^9, 3.593139237203333*^9}, {3.59330403638407*^9, 
   3.5933040374465714`*^9}, {3.5933146987974606`*^9, 
   3.5933147181099977`*^9}, {3.5933148354852285`*^9, 
   3.5933148372977314`*^9}, {3.5933149153447595`*^9, 3.593314915735385*^9}, {
   3.5933284495330343`*^9, 3.5933284498060474`*^9}, {3.5933702211108885`*^9, 
   3.5933702214858894`*^9}, {3.602616632375787*^9, 3.602616639250167*^9}, {
   3.6026166804415255`*^9, 3.602616701736745*^9}, {3.6026169797616663`*^9, 
   3.6026169994388037`*^9}, {3.602617436014795*^9, 3.6026174451513176`*^9}, {
   3.6026174944601603`*^9, 3.6026174948251715`*^9}, {3.6026175687084036`*^9, 
   3.6026175882275114`*^9}, {3.6026176389854183`*^9, 
   3.6026176392874355`*^9}, {3.6027069028889008`*^9, 
   3.6027069529367657`*^9}, {3.602707103595394*^9, 3.6027071080636597`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandJoints", "[", "j_", "]"}], " ", ":=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{
            RowBox[{"joint", "[", "#", "]"}], ",", " ", "StringQ"}], "]"}], 
          ",", " ", 
          RowBox[{"joint", "[", "#", "]"}], ",", " ", "#"}], "]"}], "&"}], 
       ",", " ", "j"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandParameters", "[", 
     RowBox[{"j_", ",", " ", "\[DoubleStruckCapitalI]c_", ",", " ", "fr_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kb", ",", " ", "kf", ",", " ", "jc", ",", " ", "S"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", "Zspat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"f0ext", " ", "=", " ", "Zspat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"nq", ",", " ", "nm", ",", " ", "nm"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"kb", " ", "=", " ", 
           RowBox[{
           "map", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "last", " ", "link", " ", "of", " ", "expanded", " ", "link", " ", 
            "i"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"kf", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", " ", "\[Equal]", " ", "1"}], ",", " ", "1", ",", 
             " ", 
             RowBox[{
              RowBox[{"map", "\[LeftDoubleBracket]", 
               RowBox[{"i", " ", "-", " ", "1"}], "\[RightDoubleBracket]"}], 
              " ", "+", " ", "1"}]}], "]"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{
           "1", "st", " ", "link", " ", "of", " ", "expanded", " ", "link", 
            " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"jc", " ", "=", " ", 
           RowBox[{
           "j", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"S", " ", "=", " ", 
           RowBox[{"joint", "[", "jc", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"VectorQ", "[", 
             RowBox[{"S", ",", " ", "StringQ"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"jc", " ", "=", " ", "S"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "set", " ", "motion", " ", "freedoms", " ", "for", " ", 
                "expanded", " ", "links"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"s", "\[LeftDoubleBracket]", 
                  RowBox[{"kf", " ", "+", " ", "k"}], 
                  "\[RightDoubleBracket]"}], " ", "=", " ", 
                 RowBox[{"joint", "[", 
                  RowBox[{"jc", "\[LeftDoubleBracket]", 
                   RowBox[{"k", "+", "1"}], "\[RightDoubleBracket]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"links", " ", "kf"}], "+", 
                  RowBox[{"1", " ", "to", " ", 
                   RowBox[{
                   "map", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", "are", " ", "coincident", 
                   " ", "with", " ", "kf"}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"XT", " ", "=", " ", "I6"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Xip", "[", 
                  RowBox[{"kf", "+", "k"}], "]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"XJ", "[", 
                    RowBox[{"jc", "\[LeftDoubleBracket]", 
                    RowBox[{"k", "+", "1"}], "\[RightDoubleBracket]"}], "]"}],
                     ".", "XT"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"n\[Lambda]", " ", ">", " ", "0"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dXip", "[", 
                    RowBox[{"kf", "+", "k"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"dXJ", "[", 
                    RowBox[{"jc", "\[LeftDoubleBracket]", 
                    RowBox[{"k", "+", "1"}], "\[RightDoubleBracket]"}], "]"}],
                     ".", "XT"}], "]"}], "&"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                  "zero", " ", "inertia", " ", "for", " ", "extra", " ", 
                   "links", " ", "kf", " ", "to", " ", 
                   RowBox[{
                   "map", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], " ", "-", " ", "1"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", 
                  RowBox[{"kb", " ", "-", " ", "k"}], 
                  "\[RightDoubleBracket]"}], " ", "=", " ", "Z6"}], ";"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"{", 
                RowBox[{"k", ",", " ", "1", ",", " ", 
                 RowBox[{
                  RowBox[{
                  "ni", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", "-", " ", "1"}]}], "}"}]}],
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"now", " ", "get", " ", "1"}], "-", 
               RowBox[{
               "dof", " ", "code", " ", "of", " ", "first", " ", "expanded", 
                " ", "joint", " ", "of", " ", "i"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"jc", " ", "=", " ", 
              RowBox[{
              "jc", " ", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"S", " ", "=", " ", 
              RowBox[{"joint", "[", "jc", "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"set", " ", "up", " ", "links", " ", "kb"}], " ", "&"}],
              " ", "kf"}], ";", " ", 
            RowBox[{
             RowBox[{
             "these", " ", "are", " ", "equal", " ", "for", " ", "1"}], "-", 
             RowBox[{"dof", " ", "links"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "s", "\[LeftDoubleBracket]", "kf", "\[RightDoubleBracket]"}], " ", 
           "=", " ", "S"}], ";", "\[IndentingNewLine]", 
          RowBox[{"XT", " ", "=", " ", 
           RowBox[{"Xba", "[", 
            RowBox[{
            "fr", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Xip", "[", "kf", "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"XJ", "[", "jc", "]"}], ".", "XT"}], "]"}], "&"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n\[Lambda]", " ", ">", " ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"dXip", "[", "kf", "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"dXJ", "[", "jc", "]"}], ".", "XT"}], "]"}], "&"}]}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", "kb", 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{
               "\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "]"}], " ", "\[Equal]", " ", 
              "10"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Io", "[", 
              RowBox[{
               RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", 
               " ", 
               RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"2", ";;", "7"}]}], "\[RightDoubleBracket]"}], ",", 
               " ", 
               RowBox[{"DiagonalMatrix", "[", 
                RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"8", ";;", "10"}]}], "\[RightDoubleBracket]"}], 
                "]"}]}], "]"}], ",", " ", 
             RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Io", "[", 
              RowBox[{
               RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", 
               " ", 
               RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"2", ";;", "7"}]}], "\[RightDoubleBracket]"}], ",", 
               " ", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"\[DoubleStruckCapitalI]c", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", " ", 
                   RowBox[{"8", ";;", "16"}]}], "\[RightDoubleBracket]"}], 
                 ",", " ", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "nb"}], "}"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandTree", "[", 
     RowBox[{"j_", ",", " ", "\[Lambda]_", ",", " ", "b_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nm", " ", "=", " ", "6"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nb", " ", "=", " ", 
        RowBox[{"Length", "@", "j"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mb", " ", "=", " ", 
        RowBox[{"Length", "@", "b"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ni", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"VectorQ", "[", 
              RowBox[{
               RowBox[{"joint", "[", "#", "]"}], ",", " ", "StringQ"}], "]"}],
              ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"joint", "[", "#", "]"}], "]"}], ",", " ", "1"}], "]"}],
            "&"}], ",", " ", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nq", " ", "=", " ", 
        RowBox[{"Total", "[", "ni", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nx", " ", "=", " ", 
        RowBox[{"2", "nq"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"parent0", " ", "=", " ", "\[Lambda]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"allocate", " ", "mem"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"parent", " ", "=", " ", 
        RowBox[{
         RowBox[{"Range", "[", "nq", "]"}], " ", "-", " ", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"map", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "nb"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bodies", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "mb"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "create", " ", "mapping", " ", "from", " ", "original", " ", "to", 
         " ", "extended", " ", "tree"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"map", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", "=", " ", 
        RowBox[{
        "ni", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "map", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{"map", "\[LeftDoubleBracket]", 
            RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "ni", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "2", ",", " ", "nb"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "create", " ", "extended", " ", "tree", " ", "and", " ", "body", " ", 
         "arrays"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "parent", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ",
         "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"parent", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"map", "\[LeftDoubleBracket]", 
             RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "+", "1"}], 
           "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\[Lambda]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], " ", "\[NotEqual]", " ", "0"}], ",", 
            " ", 
            RowBox[{"map", "\[LeftDoubleBracket]", 
             RowBox[{
             "\[Lambda]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", " ", 
            "0"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "2", ",", " ", "nb"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "bodies", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
               RowBox[{
               "map", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
               ",", " ", "0"}], "]"}], "&"}], ",", " ", 
            RowBox[{
            "b", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "mb"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "nca"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MakeNCA", "[", 
        RowBox[{"parent", ",", " ", "nq"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeNCA", "[", 
     RowBox[{"parent_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"nearest", " ", "common", " ", "ancestor", " ", 
        RowBox[{"(", "nca", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nca", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"nca", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", "i"}], "\[RightDoubleBracket]"}], " ", "=",
            " ", "i"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"your", " ", 
            RowBox[{"parent", "'"}], "s", " ", "ncas", " ", "are", " ", 
            "your", " ", "ncas"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
           "parent", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"parent", "'"}], "s", " ", "ancestors"}], " ", "+", 
              " ", "siblings"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"nca", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", " ", 
                RowBox[{"1", ";;", "p"}]}], "\[RightDoubleBracket]"}], " ", 
              "=", " ", 
              RowBox[{"nca", "\[LeftDoubleBracket]", 
               RowBox[{"p", ",", " ", 
                RowBox[{"1", ";;", "p"}]}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"parent", "'"}], "s", " ", "siblings"}], " ", "+", 
               " ", "kids"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nca", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", " ", 
                RowBox[{
                 RowBox[{"p", "+", "1"}], ";;", 
                 RowBox[{"i", "-", "1"}]}]}], "\[RightDoubleBracket]"}], " ", 
              "=", " ", 
              RowBox[{"nca", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "+", "1"}], ";;", 
                 RowBox[{"i", "-", "1"}]}], ",", " ", "p"}], 
               "\[RightDoubleBracket]"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nca", " ", "=", " ", 
        RowBox[{"nca", " ", "+", " ", 
         RowBox[{
          RowBox[{"LowerTriangularize", "[", 
           RowBox[{"nca", ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], "\[Transpose]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetPath", "[", 
   RowBox[{"i_", ",", " ", "j_"}], "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "i2a", ",", " ", "j2a"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "returns", " ", "the", " ", "path", " ", "from", " ", "i", " ", "to", 
      " ", "j"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "this", " ", "can", " ", "also", " ", "be", " ", "used", " ", "to", " ",
        "return", " ", "the", " ", "children", " ", "on", " ", "a", " ", 
       "path", " ", "if", " ", "a"}], " ", "\[Element]", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "j"}], "}"}], "."}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", " ", "\[Equal]", " ", "0"}], " ", "||", " ", 
         RowBox[{"j", " ", "\[Equal]", " ", "0"}]}], ",", " ", "0", ",", " ", 
        RowBox[{"nca", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"i2a", " ", "=", " ", 
      RowBox[{"NestWhileList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "parent", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
         "&"}], ",", " ", "i", ",", " ", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", " ", "a"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"j2a", " ", "=", " ", 
      RowBox[{"NestWhileList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "parent", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
         "&"}], ",", " ", "j", ",", " ", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", " ", "a"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"i2a", ",", " ", 
       RowBox[{"Rest", "@", 
        RowBox[{"Reverse", "@", "j2a"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.591667817527995*^9, 3.591668923825349*^9, {3.5916697599352307`*^9, 
   3.591669819815657*^9}, {3.5916698753458366`*^9, 3.5916698888766146`*^9}, {
   3.5916699961457586`*^9, 3.591669997476833*^9}, {3.59167068192603*^9, 
   3.59167070374928*^9}, {3.5917208858180676`*^9, 3.591720889380574*^9}, {
   3.5917221970292563`*^9, 3.591722203732394*^9}, {3.591722238732463*^9, 
   3.591722239091839*^9}, {3.591930526907305*^9, 3.5919305664205675`*^9}, {
   3.5919306118141713`*^9, 3.591930612108184*^9}, 3.591930660729968*^9, {
   3.591930696356006*^9, 3.5919307386704297`*^9}, {3.5919308258974266`*^9, 
   3.5919308840727587`*^9}, {3.591931024599806*^9, 3.591931025034828*^9}, {
   3.591931958433284*^9, 3.5919319593043294`*^9}, {3.5919331117973347`*^9, 
   3.5919331580109777`*^9}, {3.591933250024245*^9, 3.591933252427383*^9}, {
   3.591985667141246*^9, 3.5919857313879256`*^9}, {3.591987361798293*^9, 
   3.591987364276435*^9}, {3.5919978599754896`*^9, 3.59199787152915*^9}, 
   3.5919979113604307`*^9, {3.5919979589681625`*^9, 3.5919979727709627`*^9}, 
   3.5919982080554256`*^9, {3.5920191973504057`*^9, 3.592019234797552*^9}, {
   3.5921518015301204`*^9, 3.592151821661277*^9}, {3.5921518519500084`*^9, 
   3.5921518784545245`*^9}, {3.5921519174737606`*^9, 3.592151918642827*^9}, {
   3.5921519914750166`*^9, 3.5921519924810553`*^9}, 3.5921521161271386`*^9, {
   3.5921521472189164`*^9, 3.592152245920565*^9}, {3.5921524640720634`*^9, 
   3.5921524695633802`*^9}, {3.5921527028097334`*^9, 
   3.5921527107801905`*^9}, {3.59215278839163*^9, 3.592152817779317*^9}, 
   3.5921530282183657`*^9, {3.59215320443246*^9, 3.5921532065185785`*^9}, {
   3.5922519586863747`*^9, 3.592251999186454*^9}, {3.592254165862566*^9, 
   3.5922542064876456`*^9}, {3.5922558428788123`*^9, 
   3.5922558607708282`*^9}, {3.5922558957868533`*^9, 3.592255901201167*^9}, 
   3.592255970324107*^9, {3.5922580456873465`*^9, 3.592258045853349*^9}, {
   3.5922581158633614`*^9, 3.592258139375705*^9}, {3.592258226580702*^9, 
   3.592258231348975*^9}, {3.592258396619439*^9, 3.5922584020647693`*^9}, {
   3.592258438962861*^9, 3.592258459774053*^9}, {3.5922591760830736`*^9, 
   3.5922591855486183`*^9}, {3.592259257920762*^9, 3.5922592787549534`*^9}, {
   3.5922594413162627`*^9, 3.592259469596903*^9}, {3.592259570929685*^9, 
   3.5922595851425023`*^9}, {3.592259622531643*^9, 3.5922596920396233`*^9}, {
   3.5922597847129307`*^9, 3.59225978836014*^9}, {3.592265284603904*^9, 
   3.592265302772931*^9}, {3.5922660757641973`*^9, 3.592266168732519*^9}, {
   3.592266745226554*^9, 3.5922667453035393`*^9}, 3.5922667840087557`*^9, {
   3.592266872124799*^9, 3.592266894180065*^9}, {3.5922669756537285`*^9, 
   3.5922669960148973`*^9}, {3.5922671554480267`*^9, 
   3.5922672007746234`*^9}, {3.592267352764331*^9, 3.592267352851329*^9}, {
   3.5922673878293343`*^9, 3.5922674271685877`*^9}, {3.5922677518271804`*^9, 
   3.592267753864293*^9}, {3.592269365102566*^9, 3.5922693810894814`*^9}, {
   3.5922694704245977`*^9, 3.59226951552118*^9}, 3.592269559872718*^9, {
   3.592269596464834*^9, 3.592269605997359*^9}, {3.592269651011939*^9, 
   3.5922696511789675`*^9}, {3.592269686507972*^9, 3.59226972943143*^9}, {
   3.5922698283110924`*^9, 3.5922699566064405`*^9}, {3.5922700800495105`*^9, 
   3.592270104246894*^9}, {3.5922701343156166`*^9, 3.5922701411890078`*^9}, {
   3.5922701729868326`*^9, 3.592270182028349*^9}, {3.59227026813428*^9, 
   3.592270307654543*^9}, {3.592270789010106*^9, 3.592270804936021*^9}, {
   3.592271003227376*^9, 3.5922710164511337`*^9}, {3.5922710767405863`*^9, 
   3.592271096212701*^9}, {3.5922712492224765`*^9, 3.59227124969849*^9}, 
   3.5922713284640007`*^9, {3.592271377491807*^9, 3.5922713780178576`*^9}, {
   3.5922714086255894`*^9, 3.592271408733595*^9}, {3.5922714892252083`*^9, 
   3.592271557448115*^9}, {3.5922717878813114`*^9, 3.592271820858195*^9}, 
   3.5922718793635445`*^9, {3.592271916862694*^9, 3.592271917492734*^9}, {
   3.592271975838073*^9, 3.5922719809793663`*^9}, {3.5922721103467903`*^9, 
   3.592272167605055*^9}, {3.592272355126795*^9, 3.5922723559508424`*^9}, {
   3.592272387750682*^9, 3.592272430457106*^9}, {3.5922724624049335`*^9, 
   3.592272486586323*^9}, {3.592272554254202*^9, 3.5922725606365767`*^9}, {
   3.5922726000188184`*^9, 3.5922726042520723`*^9}, {3.592272771832677*^9, 
   3.5922727837953434`*^9}, {3.5922728195993934`*^9, 
   3.5922728631518846`*^9}, {3.5922729410483484`*^9, 
   3.5922729655267687`*^9}, {3.5922731177624674`*^9, 
   3.5922731543115797`*^9}, {3.592273310760521*^9, 3.5922734737338514`*^9}, {
   3.5922735108949947`*^9, 3.592273518410412*^9}, {3.5922735543504705`*^9, 
   3.59227358123601*^9}, {3.592273646181729*^9, 3.592273726257312*^9}, {
   3.5922737869537907`*^9, 3.5922738520135164`*^9}, {3.5922740041642246`*^9, 
   3.592274023666346*^9}, {3.592274258321784*^9, 3.5922742741106863`*^9}, {
   3.592274419230996*^9, 3.5922744193890047`*^9}, {3.59227448977404*^9, 
   3.5922745196417465`*^9}, {3.5922745553427935`*^9, 3.592274595237076*^9}, {
   3.592274638285543*^9, 3.5922746696913414`*^9}, {3.5922747972366467`*^9, 
   3.5922748309945784`*^9}, {3.592274966500351*^9, 3.592274991427766*^9}, {
   3.592275022895569*^9, 3.592275031693086*^9}, {3.5922750665360675`*^9, 
   3.5922752337196403`*^9}, {3.5922753371725636`*^9, 
   3.5922753612429485`*^9}, {3.592275404604432*^9, 3.592275406126515*^9}, {
   3.5922755649776125`*^9, 3.5922756207168036`*^9}, {3.5922758717241945`*^9, 
   3.5922758743503284`*^9}, {3.5922805198023577`*^9, 3.592280560296678*^9}, {
   3.592280648507742*^9, 3.592280653503023*^9}, {3.59228859193862*^9, 
   3.592288631802901*^9}, {3.5922886637607336`*^9, 3.592288669778076*^9}, {
   3.5922887474895287`*^9, 3.5922887482945967`*^9}, {3.592288778321295*^9, 
   3.5922887893069234`*^9}, {3.5922930252875032`*^9, 
   3.5922930261875534`*^9}, {3.59232216412803*^9, 3.5923221645760417`*^9}, {
   3.5923222141038747`*^9, 3.5923222146439095`*^9}, {3.592322303587002*^9, 
   3.5923223085062847`*^9}, {3.592322455802719*^9, 3.592322482674258*^9}, 
   3.592322568846193*^9, {3.592323716015887*^9, 3.5923238349947195`*^9}, {
   3.5923238811463437`*^9, 3.592323903579629*^9}, {3.592323947101121*^9, 
   3.592323958546775*^9}, 3.592325020905615*^9, 3.5923250924057074`*^9, {
   3.592325178768654*^9, 3.5923251847249947`*^9}, {3.592325509846614*^9, 
   3.592325579905626*^9}, {3.592325610773393*^9, 3.592325610986409*^9}, {
   3.5923256480075245`*^9, 3.592325653257824*^9}, {3.592326357953201*^9, 
   3.5923263611073627`*^9}, {3.5923264423020124`*^9, 
   3.5923264641812835`*^9}, {3.592326512038006*^9, 3.5923266042622867`*^9}, {
   3.5923266497838936`*^9, 3.59232674643143*^9}, {3.592326830500261*^9, 
   3.5923268797860622`*^9}, {3.5923269342291837`*^9, 
   3.5923269986578894`*^9}, {3.5923270362190285`*^9, 3.592327117486677*^9}, {
   3.5923272314232144`*^9, 3.5923272715754995`*^9}, {3.5923273065705056`*^9, 
   3.592327350989049*^9}, {3.5923274125735755`*^9, 3.592327418064891*^9}, {
   3.5923275140303864`*^9, 3.5923276062176657`*^9}, {3.5923276532933617`*^9, 
   3.592327654185412*^9}, {3.5923276926456146`*^9, 3.592327692772622*^9}, {
   3.5923277288566885`*^9, 3.592327904489751*^9}, {3.592327939983777*^9, 
   3.5923279946489096`*^9}, {3.5923280273017793`*^9, 
   3.5923280708432727`*^9}, {3.592328256381916*^9, 3.592328311494054*^9}, {
   3.592328377548837*^9, 3.5923283784428883`*^9}, {3.5923290216127205`*^9, 
   3.592329030903251*^9}, 3.5923293277412486`*^9, {3.5923294589187665`*^9, 
   3.5923294903285656`*^9}, {3.592329543190589*^9, 3.59232954460567*^9}, {
   3.5923295995248127`*^9, 3.5923297137353554`*^9}, {3.5923297507114735`*^9, 
   3.5923297799551473`*^9}, {3.5923298456749153`*^9, 
   3.5923298638739705`*^9}, {3.592329916913991*^9, 3.5923299180660534`*^9}, {
   3.5923300051120396`*^9, 3.592330006966149*^9}, {3.592330040054043*^9, 
   3.5923300669505844`*^9}, {3.592330118277522*^9, 3.592330208584695*^9}, {
   3.5923302807648277`*^9, 3.5923303462545786`*^9}, {3.5923307023329697`*^9, 
   3.59233075823417*^9}, 3.59233085839291*^9, {3.5923309133830557`*^9, 
   3.592330926128785*^9}, {3.5923309567205377`*^9, 3.59233098767231*^9}, {
   3.5923310282886353`*^9, 3.592331084900878*^9}, {3.5923312539095697`*^9, 
   3.5923312777179203`*^9}, {3.5923313996679215`*^9, 3.592331563625311*^9}, {
   3.5923316207045584`*^9, 3.5923316484191484`*^9}, {3.592331710373694*^9, 
   3.59233173455208*^9}, {3.592331766743924*^9, 3.592331818322875*^9}, {
   3.592331902011675*^9, 3.5923319996242604`*^9}, {3.5923320770106974`*^9, 
   3.5923321816526823`*^9}, {3.592332323052782*^9, 3.5923323245848713`*^9}, {
   3.5923323692014256`*^9, 3.5923324045414486`*^9}, {3.592332447873933*^9, 
   3.592332509325468*^9}, {3.592332544584469*^9, 3.592332612939383*^9}, {
   3.5923327382425585`*^9, 3.592332893818468*^9}, {3.592332937962996*^9, 
   3.5923329423152466`*^9}, {3.5923330114832063`*^9, 
   3.5923330471242476`*^9}, {3.592333090562735*^9, 3.5923331256457443`*^9}, {
   3.592333182797021*^9, 3.5923332001360097`*^9}, {3.5923333254841843`*^9, 
   3.5923333524377313`*^9}, {3.5923334143242755`*^9, 3.59233362061009*^9}, {
   3.592333653265959*^9, 3.592333655125065*^9}, {3.592333718847728*^9, 
   3.5923337979862437`*^9}, {3.592333836173434*^9, 3.5923338582126956`*^9}, {
   3.592334017578822*^9, 3.592334021541049*^9}, {3.5923340968783627`*^9, 
   3.592334161335054*^9}, {3.592334191952804*^9, 3.592334217431267*^9}, {
   3.5923345274470387`*^9, 3.592334642373602*^9}, {3.5923347077953486`*^9, 
   3.59233471623883*^9}, {3.592334765200636*^9, 3.592334767330758*^9}, {
   3.592335071649193*^9, 3.5923350768634834`*^9}, {3.5923356715045385`*^9, 
   3.592335680606055*^9}, {3.5923538222759776`*^9, 3.592353831584521*^9}, {
   3.592370916535984*^9, 3.5923709463356905`*^9}, {3.5923711734726973`*^9, 
   3.5923711932798505`*^9}, {3.5923716758344617`*^9, 3.592371686130056*^9}, {
   3.592371744953433*^9, 3.59237175434396*^9}, {3.592371797994459*^9, 
   3.5923718202977347`*^9}, {3.5923747656754103`*^9, 
   3.5923747663284464`*^9}, {3.592383856791027*^9, 3.5923838888468666`*^9}, {
   3.5925242672389746`*^9, 3.592524267779004*^9}, {3.5926274023654532`*^9, 
   3.592627408631096*^9}, {3.5926275824752035`*^9, 3.592627592350204*^9}, {
   3.592629248489919*^9, 3.592629249235964*^9}, {3.592666598963564*^9, 
   3.5926666238073626`*^9}, {3.5927480544837275`*^9, 3.592748086640041*^9}, {
   3.592748144796405*^9, 3.5927481617651877`*^9}, {3.5927573412623234`*^9, 
   3.5927574347756777`*^9}, {3.59275746746855*^9, 3.5927575284640436`*^9}, {
   3.592757602718296*^9, 3.592757738909095*^9}, {3.5927578052508936`*^9, 
   3.592757817615602*^9}, {3.5927579162412496`*^9, 3.5927579330742135`*^9}, {
   3.5927579847871747`*^9, 3.5927581240521483`*^9}, {3.5927583344062004`*^9, 
   3.5927583505581193`*^9}, 3.5927585361497507`*^9, {3.5927585961802025`*^9, 
   3.5927586271859827`*^9}, {3.592760178720814*^9, 3.5927601805439177`*^9}, {
   3.5927609618316603`*^9, 3.5927609624546967`*^9}, {3.592761705624259*^9, 
   3.5927617295366244`*^9}, {3.592761761840474*^9, 3.5927618444832067`*^9}, {
   3.5927618954711266`*^9, 3.5927618971682234`*^9}, 3.5927722880152674`*^9, 
   3.5927724400529785`*^9, 3.5927737486189156`*^9, {3.59278532976274*^9, 
   3.5927853310748105`*^9}, 3.592865011885339*^9, {3.592998251903042*^9, 
   3.5929982578093033`*^9}, {3.5930049819943275`*^9, 3.593005031978801*^9}, {
   3.593005091775792*^9, 3.593005112619583*^9}, {3.5933134779669466`*^9, 
   3.59331348117008*^9}, {3.5933135216232977`*^9, 3.5933135244045515`*^9}, {
   3.593973417214839*^9, 3.5939735067199636`*^9}, {3.593973769481007*^9, 
   3.5939737843378735`*^9}, {3.593973926281987*^9, 3.5939739276240625`*^9}, {
   3.593973963001085*^9, 3.593973963648127*^9}, {3.5962988837573338`*^9, 
   3.596298891054226*^9}, 3.602506267571031*^9, {3.6025063148457375`*^9, 
   3.602506402993786*^9}, {3.602506500207349*^9, 3.6025065026015034`*^9}, {
   3.602506611266713*^9, 3.602506621027272*^9}, {3.602509813708104*^9, 
   3.6025099441475735`*^9}, {3.6025099971836133`*^9, 
   3.6025101057698507`*^9}, {3.6025101538775997`*^9, 3.602510229888958*^9}, {
   3.602510285548126*^9, 3.6025103031511345`*^9}, 3.6025103712620354`*^9, {
   3.6025106022062607`*^9, 3.602510602658305*^9}, {3.602510656901393*^9, 
   3.60251070207498*^9}, {3.602510802510731*^9, 3.6025108054909024`*^9}, {
   3.6025121567533035`*^9, 3.602512157485327*^9}, {3.60251219992276*^9, 
   3.602512200076767*^9}, {3.602512281343419*^9, 3.6025123251379414`*^9}, 
   3.6025125282475586`*^9, {3.6025966892036605`*^9, 3.602596699266176*^9}, {
   3.6025967547975307`*^9, 3.6025968008601246`*^9}, {3.602596848282092*^9, 
   3.6025971048919706`*^9}, {3.6025971520639367`*^9, 3.602597153173314*^9}, {
   3.6025971908765125`*^9, 3.6025972346109724`*^9}, {3.6025972927985888`*^9, 
   3.602597342548684*^9}, {3.6025974649082985`*^9, 3.6025976055804496`*^9}, {
   3.6025976636274366`*^9, 3.602597667002463*^9}, 3.6025977256588087`*^9, {
   3.6025978610965734`*^9, 3.6025978702215953`*^9}, {3.6025979252217007`*^9, 
   3.602597925846697*^9}, {3.602617382638736*^9, 3.602617385560906*^9}, {
   3.602617653775265*^9, 3.6026176554283595`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Animation", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.5962915648964467`*^9, 3.596291566021453*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetPointsAndLines", "[", 
     RowBox[{"q_", ",", " ", "poi_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", " ", "pts", ",", " ", "rots", ",", " ", "lines"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pts", ",", " ", "rots"}], "}"}], " ", "=", " ", 
        RowBox[{"GetPoints", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lines", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          "&"}], " ", "/@", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"poi", ",", " ", 
           RowBox[{
            RowBox[{"IntegerQ", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"poi", ",", " ", 
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pts", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"pts", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"rots", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "\[RightDoubleBracket]"}], "\[Transpose]"}], ".", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              " ", "+", " ", 
              RowBox[{"pts", "\[LeftDoubleBracket]", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], ")"}], "&"}], " ", "/@", " ", 
           "p"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"parent0", ",", " ", 
          RowBox[{"p", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lines", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"lines", ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               " ", "\[NotEqual]", " ", "0"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"pts", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "\[RightDoubleBracket]"}], ",", " ", 
                RowBox[{
                "pts", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Length", "@", "p"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lines", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"lines", ",", " ", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"#", "===", " ", "Null"}], ")"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pts", ",", " ", "lines"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawFigure2D", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"VertexColors", "\[Rule]", " ", "Black"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawFigure2D", "[", 
     RowBox[{"q_", ",", " ", "poi_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pts", ",", " ", "lines", ",", " ", "g1", ",", " ", "g2", ",", "g3", 
        ",", " ", "vc", ",", " ", "pr"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pts", ",", " ", "lines"}], "}"}], " ", "=", " ", 
        RowBox[{"GetPointsAndLines", "[", 
         RowBox[{"q", ",", " ", "poi"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vc", " ", "=", " ", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", "VertexColors"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pr", " ", "=", " ", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", "PlotRange"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g1", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Line", "@", 
             RowBox[{"lines", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", "All", ",", " ", 
               RowBox[{"{", 
                RowBox[{"3", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}],
             ",", " ", 
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", " ", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{"pts", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
              ",", " ", "vc"}], "]"}]}], "}"}], ",", " ", "pr"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g2", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Line", "@", 
             RowBox[{"lines", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", "All", ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "2"}], "}"}]}], 
              "\[RightDoubleBracket]"}]}], ",", " ", 
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", " ", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{"pts", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
              ",", " ", "vc"}], "]"}]}], "}"}], ",", " ", "pr"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g3", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Line", "@", 
             RowBox[{"lines", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", "All", ",", " ", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}],
             ",", " ", 
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", " ", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{"pts", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}], 
              ",", " ", "vc"}], "]"}]}], "}"}], ",", " ", "pr"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"g1", ",", "g2", ",", "g3"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawFigure3D", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"VertexColors", "\[Rule]", " ", "Black"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrawFigure3D", "[", 
    RowBox[{"q_", ",", " ", "poi_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", " ", "lines", ",", " ", "vc", ",", " ", "pr"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pts", ",", " ", "lines"}], "}"}], " ", "=", " ", 
       RowBox[{"GetPointsAndLines", "[", 
        RowBox[{"q", ",", " ", "poi"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vc", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "VertexColors", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "vc", "]"}]}], ",", " ", 
        RowBox[{"vc", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"vc", ",", " ", 
           RowBox[{"Length", "@", "pts"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pr", " ", "=", " ", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", "PlotRange"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Tube", "/@", 
           RowBox[{"lines", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", "All", ",", " ", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "vc", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"pts", "\[LeftDoubleBracket]", 
                 RowBox[{"#", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], 
                 "\[RightDoubleBracket]"}], ",", " ", "0.025"}], "]"}]}], 
             "}"}], "&"}], " ", "/@", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "pts"}], "]"}]}]}], "}"}], ",", " ", 
        "pr"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5962916807404227`*^9, 3.5962916818654265`*^9}, {
   3.5962917375842896`*^9, 3.5962918128813086`*^9}, {3.596295724423031*^9, 
   3.596295766516862*^9}, {3.5962958019700766`*^9, 3.5962958130482035`*^9}, {
   3.5962959266109467`*^9, 3.5962960939862523`*^9}, {3.596296145470729*^9, 
   3.596296228033392*^9}, {3.5962965011745462`*^9, 3.596296513627701*^9}, {
   3.596296598252864*^9, 3.596296606034129*^9}, {3.596297960880542*^9, 
   3.596297991427469*^9}, {3.596298040818184*^9, 3.5962980507869554`*^9}, {
   3.596298092208911*^9, 3.5962981215370965`*^9}, {3.596298154380923*^9, 
   3.596298241209201*^9}, {3.596298290428048*^9, 3.5962983837563553`*^9}, {
   3.596298437709608*^9, 3.596298451568988*^9}, 3.596298543256668*^9, {
   3.596298911398012*^9, 3.5962989188355403`*^9}, 3.5962989799606466`*^9, {
   3.5962995864561777`*^9, 3.59629967261259*^9}, {3.596299705581409*^9, 
   3.596299709315792*^9}, {3.596299848159814*^9, 3.596299930753737*^9}, {
   3.5963000186132727`*^9, 3.596300028941414*^9}, {3.596300073394643*^9, 
   3.5963001327385063`*^9}, {3.5963001911448603`*^9, 
   3.5963001938480067`*^9}, {3.5963004449266167`*^9, 
   3.5963004514266186`*^9}, {3.596300577286256*^9, 3.596300589286262*^9}, {
   3.596300644536368*^9, 3.596300657895774*^9}, {3.5963007849741564`*^9, 
   3.5963008053179398`*^9}, 3.596300866896185*^9, {3.5963009290681763`*^9, 
   3.596300955865119*^9}, {3.5963010248027415`*^9, 3.5963010307090015`*^9}, {
   3.5963010718028307`*^9, 3.596301076177842*^9}, {3.5963011608811483`*^9, 
   3.5963011626467795`*^9}, {3.5963012158031263`*^9, 
   3.5963012345375233`*^9}, {3.5963017959761443`*^9, 
   3.5963017982417574`*^9}, {3.596393528851539*^9, 3.596393531843712*^9}, {
   3.5963936533186636`*^9, 3.5963936540987115`*^9}, {3.5963939086362877`*^9, 
   3.5963939451223774`*^9}, {3.5963944199685698`*^9, 3.596394421008649*^9}, {
   3.5963944733046246`*^9, 3.5963946486466675`*^9}, {3.5963948735435452`*^9, 
   3.596394880845963*^9}, {3.59639497014408*^9, 3.5963950704478226`*^9}, {
   3.596395107179925*^9, 3.596395210457838*^9}, {3.5963955485272007`*^9, 
   3.5963955588727913`*^9}, {3.596395987850362*^9, 3.5963959952887983`*^9}, {
   3.602208153525608*^9, 3.602208158650631*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 3.5914868026208353`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{496, 631},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 86, "Section"],
Cell[682, 25, 1716, 26, 72, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2435, 56, 206, 3, 86, "Section"],
Cell[2644, 61, 6415, 138, 492, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9096, 204, 324, 4, 86, "Section"],
Cell[9423, 210, 12014, 248, 792, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[21474, 463, 196, 3, 86, "Section"],
Cell[21673, 468, 20464, 346, 812, "Input",
 InitializationCell->True],
Cell[42140, 816, 35585, 700, 2632, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[77762, 1521, 248, 3, 86, "Section"],
Cell[78013, 1526, 13945, 327, 1392, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[91995, 1858, 30, 0, 86, "Section"],
Cell[92028, 1860, 207, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
