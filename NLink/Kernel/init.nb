(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     80388,       1610]
NotebookOptionsPosition[     79680,       1580]
NotebookOutlinePosition[     80076,       1597]
CellTagsIndexPosition[     80033,       1594]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, 
   3.5922895582469563`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`Usage`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`PackageVariables`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`SpatialVectors`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`SparcityOperations`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`RigidBodySystem`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`Dynamics`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`CompiledCode`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<NLink`ContinuationMethods`\>\"", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.592239943509227*^9, 3.5922399820561876`*^9}, {3.5922472305833893`*^9, 
   3.592247244802156*^9}, {3.5922512353880877`*^9, 3.5922512705444045`*^9}, {
   3.5922513050913467`*^9, 3.5922514372009954`*^9}, {3.59225146788854*^9, 
   3.592251700685872*^9}, 3.592254598707162*^9, {3.5922546582385283`*^9, 
   3.5922546594416585`*^9}, {3.5922548578326693`*^9, 3.592254859379553*^9}, {
   3.592254994426689*^9, 3.592254995598579*^9}, 3.5922550320048876`*^9, {
   3.5922760893416405`*^9, 3.5922760970150766`*^9}, {3.592276229928692*^9, 
   3.5922762313607693`*^9}, {3.592289558247957*^9, 3.592289652489353*^9}, {
   3.5922900405915775`*^9, 3.592290049493086*^9}, {3.592425173146072*^9, 
   3.5924251807555046`*^9}, {3.5927875396893306`*^9, 3.592787575036359*^9}, {
   3.593429743957363*^9, 3.5934297514573746`*^9}, {3.60276396242095*^9, 
   3.6027639807490005`*^9}, {3.6027640549922523`*^9, 
   3.6027640559043045`*^9}, {3.602783657501352*^9, 3.6027836610735545`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, 
   3.5922895582469563`*^9, {3.592426034577403*^9, 3.59242603512843*^9}, {
   3.5928665766969185`*^9, 3.5928665787594337`*^9}}],

Cell[CellGroupData[{

Cell["\<\
The following test compares intermediate results to that of a known system: \
the unpinned double pendulum (the floating base is attached to the proximal \
end of the inner link) with a pivot constraint at the distal end of the outer \
link.  When testing other systems, the constraints are assumed to be Pfaffian \
constraints.\
\>", "Subsection",
 CellChangeTimes->{{3.5928665981813383`*^9, 3.5928666142126284`*^9}, {
  3.5933620080058937`*^9, 3.593362170006212*^9}, {3.5933623515534368`*^9, 
  3.593362360069083*^9}, {3.593367380624674*^9, 3.5933673870153112`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\<../../\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"<<", "\"\<NLink`\>\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SimpleMechanicalSystem", "[", 
    RowBox[{
    "t_", ",", " ", "q_", ",", " ", "u_", ",", " ", "T_", ",", " ", "V_", ",",
      " ", "U_", ",", " ", "r_", ",", " ", "x0_", ",", " ", "u0_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "\[CapitalGamma]", ",", " ", "dq", ",", " ", 
       "\[Lambda]d", ",", " ", "M", ",", " ", "Minv", ",", " ", "C", ",", " ",
        "G", ",", " ", "F", ",", " ", "dc", ",", " ", "dM", ",", " ", "dMinv",
        ",", " ", "J", ",", " ", "\[CapitalLambda]", ",", " ", 
       "d\[CapitalLambda]", ",", " ", "P", ",", " ", "dP", ",", " ", 
       "\[Lambda]", ",", " ", "d\[Lambda]", ",", " ", "dF"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"M_", ",", " ", "var_", ",", " ", "ind_"}], "]"}], " ", ":=", 
       " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j", ",", " ", "k"}], "}"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "j", ",", " ", "k"}], "}"}], " ", "=", " ",
            "ind"}], ";", " ", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"M", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "var", "\[LeftDoubleBracket]", "k", 
                "\[RightDoubleBracket]"}]}], "]"}], " ", "+", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"M", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "var", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}], "]"}], " ", "-", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"M", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "var", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "@", "q"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dq", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"q", ",", " ", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]d", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", "dq", ",", " ", "u"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"derivatives", " ", 
        RowBox[{"w", ".", "r", ".", "t"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"T", ",", " ", 
         RowBox[{"{", 
          RowBox[{"dq", ",", " ", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"G", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"V", ",", " ", 
         RowBox[{"{", "q", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"M", ",", " ", "q", ",", " ", 
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2", ",", "k"}], "}"}]}], "]"}], 
             RowBox[{
             "dq", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"k", ",", " ", "n"}], "}"}]}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Minv", " ", "=", " ", 
       RowBox[{"Inverse", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"F", " ", "=", " ", 
       RowBox[{"Minv", ".", 
        RowBox[{"(", 
         RowBox[{"U", " ", "-", " ", 
          RowBox[{"C", ".", "dq"}], " ", "-", " ", "G"}], ")"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"unconstrained", " ", "equations", " ", "of", " ", "motion"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"J", " ", "=", "  ", 
       RowBox[{"D", "[", 
        RowBox[{"r", ",", " ", 
         RowBox[{"{", "q", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalLambda]", " ", "=", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{"J", ".", "Minv", ".", 
         RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", " ", "=", " ", 
       RowBox[{
        RowBox[{"J", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", "J"}]}], 
      ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"constraint", " ", "forces"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dc", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"C", ".", "dq"}], "+", " ", "G"}], ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"derivatives", " ", "of", " ", "various", " ", "quantities"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dM", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"M", ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dMinv", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"Minv", ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dF", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"F", ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[CapitalLambda]", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"\[CapitalLambda]", ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[Lambda]", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"\[Lambda]", ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "n", "]"}], " ", "-", " ", 
          RowBox[{"Minv", ".", "\[Lambda]"}]}], ")"}], ".", "F"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "projection", " ", "to", " ", "feasible", " ", "accelerations"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dP", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{"P", ",", " ", 
         RowBox[{"{", "\[Lambda]d", "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"derivative", " ", "of", " ", "projection", " ", "operator"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "P", " ", "takes", " ", "too", " ", "long", " ", "to", " ", 
         "compute"}], ",", " ", 
        RowBox[{"so", " ", "replace", " ", 
         RowBox[{"w", "/", " ", "numeric"}], " ", "values"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Minv", " ", "=", " ", 
         RowBox[{"Minv", " ", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"\[Lambda]d", "\[Rule]", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"x0", ",", " ", "u0"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dMinv", " ", "=", " ", 
         RowBox[{"dMinv", " ", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"\[Lambda]d", "\[Rule]", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"x0", ",", " ", "u0"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]", " ", "=", " ", 
         RowBox[{"\[Lambda]", " ", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"\[Lambda]d", "\[Rule]", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"x0", ",", " ", "u0"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d\[Lambda]", " ", "=", " ", 
         RowBox[{"d\[Lambda]", " ", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"\[Lambda]d", "\[Rule]", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"x0", ",", " ", "u0"}], "]"}]}], "]"}]}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"dP", " ", "=", " ", 
         RowBox[{
          RowBox[{"F", ".", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Minv", ".", "d\[Lambda]"}]}], " ", "-", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Lambda]", "\[Transpose]"}], ".", 
                 RowBox[{"dMinv", "\[Transpose]"}]}], ")"}], 
               "\[Transpose]"}]}], ")"}], "\[Transpose]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], " ", "-", " ", 
             RowBox[{"Minv", ".", "\[Lambda]"}]}], ")"}], ".", "dF"}]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", ",", "Minv", ",", " ", 
         RowBox[{
          RowBox[{"C", ".", "dq"}], " ", "+", " ", "G"}], ",", " ", "dc", ",",
          " ", "dM", ",", " ", "dMinv", ",", " ", "F", ",", " ", "dF", ",", 
         " ", 
         RowBox[{"Append", "[", 
          RowBox[{"r", ",", " ", "0"}], "]"}], ",", " ", "J", ",", " ", 
         "\[CapitalLambda]", ",", " ", "d\[CapitalLambda]", ",", " ", 
         RowBox[{"\[Lambda]", ".", "dq"}], ",", " ", "P", ",", " ", "dP"}], 
        "}"}], " ", "/.", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{"\[Lambda]d", "\[Rule]", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"x0", ",", " ", "u0"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoublePendulum", "[", 
     RowBox[{"x0_", ",", " ", "u0_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "T", ",", " ", "V", ",", " ", "U", ",", " ", "r1", ",", " ", "r2", ",",
         " ", "rc", ",", " ", "q", ",", " ", "qx", ",", " ", "qy", ",", " ", 
        "q1", ",", " ", "q2", ",", " ", "u", ",", " ", "t", ",", " ", "SMS", 
        ",", " ", "ZVC"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"qx", "[", "t", "]"}], ",", " ", 
          RowBox[{"qy", "[", "t", "]"}], ",", " ", 
          RowBox[{"q1", "[", "t", "]"}], ",", " ", 
          RowBox[{"q2", "[", "t", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"r1", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "+", " ", 
           RowBox[{"Lc", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "]"}]}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "-", " ", 
           RowBox[{"Lc", "  ", 
            RowBox[{"Cos", "[", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "]"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "+", " ", 
           RowBox[{"L", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "]"}]}], " ", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", " ", "-", " ", "Lc"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
              "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", "+", " ", 
              RowBox[{
              "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
             "]"}]}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "-", " ", 
           RowBox[{"L", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "]"}]}], " ", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"L", " ", "-", " ", "Lc"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
              "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", "+", " ", 
              RowBox[{
              "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
             "]"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rc", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "+", " ", 
           RowBox[{"L", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "]"}]}], " ", "+", 
           RowBox[{"L", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
              "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", "+", " ", 
              RowBox[{
              "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
             "]"}]}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "-", " ", 
           RowBox[{"L", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "]"}]}], " ", "-", 
           RowBox[{"L", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
              "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", "+", " ", 
              RowBox[{
              "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
             "]"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"V", " ", "=", " ", 
        RowBox[{"g", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{
            "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           " ", "+", " ", 
           RowBox[{"m", " ", 
            RowBox[{
            "r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "m", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"r1", ",", "t"}], "]"}], ".", 
           RowBox[{"D", "[", 
            RowBox[{"r1", ",", "t"}], "]"}]}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "Ic", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"q1", "'"}], "[", "t", "]"}], "^", "2"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "m", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"r2", ",", "t"}], "]"}], ".", 
           RowBox[{"D", "[", 
            RowBox[{"r2", ",", "t"}], "]"}]}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", "Ic", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"q2", "'"}], "[", "t", "]"}], "+", 
             RowBox[{
              RowBox[{"q1", "'"}], "[", "t", "]"}]}], ")"}], "^", "2"}]}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"U", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "#", "]"}], "&"}], ",", " ", 
          RowBox[{"Length", "@", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"SimpleMechanicalSystem", "[", 
        RowBox[{
        "t", ",", " ", "q", ",", " ", "U", ",", " ", "T", ",", " ", "V", ",", 
         " ", "U", ",", " ", "rc", ",", " ", "x0", ",", " ", "u0"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoublePendulumNLinks", "[", 
     RowBox[{"x0_", ",", " ", "u0_", ",", " ", "dx0_", ",", " ", "du0_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "joints", ",", " ", "n", ",", "nd", ",", " ", "parent", ",", " ", "b", 
        ",", " ", "R", ",", " ", "frames", ",", " ", "inertia", ",", " ", "M",
         ",", " ", "Minv", ",", " ", "dM", ",", " ", "c", ",", " ", "Ld", ",",
         " ", "D", ",", " ", "dLd", ",", " ", "dD", ",", " ", "J", ",", " ", 
        "Yd", ",", " ", "YD", ",", " ", "Xa", ",", " ", "rc", ",", " ", 
        "\[CapitalLambda]", ",", " ", "d\[CapitalLambda]inv", ",", " ", 
        "\[Lambda]", ",", " ", "P", ",", " ", "dP", ",", " ", "rot", ",", " ",
         "drot", ",", " ", "F", ",", " ", "dF"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"joints", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "\"\<px\>\"", ",", " ", "\"\<py\>\"", ",", " ", "\"\<rz\>\"", ",", 
          " ", "\"\<rz\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "@", "joints"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"#", " ", "of", " ", "links"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"parent", " ", "=", " ", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], " ", "-", " ", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"4", ",", " ", "4"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rc", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
          RowBox[{"-", "L"}], ",", " ", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xa", " ", "=", " ", 
        RowBox[{"NLink`Private`Xba", "[", "rc", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", " ", "1"}], ",", 
             " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "5"}], "}"}], "\[Rule]", " ", "1"}]}], "}"}],
            ",", " ", 
           RowBox[{"{", 
            RowBox[{"2", ",", " ", "6"}], "}"}]}], "]"}], ".", "Xa"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"frames", " ", "=", " ", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4", ",", " ", "5"}], "}"}], "\[Rule]", " ", 
            RowBox[{"-", "L"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", " ", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"inertia", "  ", "=", " ", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", " ", "1"}], "}"}], "\[Rule]", " ", "m"}], " ",
             ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"4", ",", " ", "1"}], "}"}], "\[Rule]", " ", "m"}], ",",
             " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", " ", "6"}], "}"}], "\[Rule]", " ", 
             RowBox[{"-", "Lc"}]}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"4", ",", " ", "6"}], "}"}], "\[Rule]", " ", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"L", "-", "Lc"}], ")"}]}]}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", " ", "10"}], "}"}], "\[Rule]", " ", "Ic"}], 
            ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"4", ",", " ", "10"}], "}"}], "\[Rule]", " ", "Ic"}]}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", " ", "10"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetModel", "[", 
        RowBox[{"joints", ",", " ", "parent", ",", " ", "b", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "g", ",", " ", "0"}], "}"}], ",", " ", 
         "inertia", ",", " ", "frames", ",", " ", "R", ",", " ", 
         RowBox[{"3", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"F", " ", "=", " ", 
        RowBox[{"NLink`Private`F", "[", 
         RowBox[{"x0", ",", " ", "u0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dF", " ", "=", " ", 
        RowBox[{"NLink`Private`dF", "[", 
         RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", "NLink`Private`c"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", " ", "=", " ", "NLink`Private`M"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"factorized", " ", "M"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ld", " ", "=", " ", 
        RowBox[{
         RowBox[{"LowerTriangularize", "[", 
          RowBox[{"M", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], " ", "+", " ", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"D", " ", "=", " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Diagonal", "@", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"NLink`Private`Minvx", "[", 
         RowBox[{"M", ",", " ", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dM", " ", "=", " ", "NLink`Private`dM"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dLd", " ", "=", " ", "dM"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dLd", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i", ",", ";;"}], "\[RightDoubleBracket]"}], "=",
           "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dD", " ", "=", " ", "dM"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dD", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{"1", ";;", 
             RowBox[{"i", "-", "1"}]}], ",", ";;"}], 
           "\[RightDoubleBracket]"}], "=", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "2", ",", " ", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dM", " ", "=", " ", 
        RowBox[{
         RowBox[{"NLink`Private`dXB", "[", 
          RowBox[{
           RowBox[{"dLd", "\[Transpose]"}], ",", " ", 
           RowBox[{"D", ".", "Ld"}]}], "]"}], " ", "+", " ", 
         RowBox[{"NLink`Private`AdXB", "[", 
          RowBox[{
           RowBox[{"Ld", "\[Transpose]"}], ",", " ", "dD", ",", " ", "Ld"}], 
          "]"}], " ", "+", " ", 
         RowBox[{"NLink`Private`AdX", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Ld", "\[Transpose]"}], ".", "D"}], ",", " ", "dLd"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xa", " ", "=", " ", 
        RowBox[{"Dot", " ", "@@", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
           "NLink`Private`XL", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "n", ",", " ", "1", ",", " ", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"NLink`Private`P", "[", "F", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dP", " ", "=", " ", 
        RowBox[{"NLink`Private`dP", "[", 
         RowBox[{"F", ",", " ", "dF"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", "NLink`Private`J"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\[CapitalLambda]", " ", "=", " ", "NLink`Private`\[CapitalLambda]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{
         RowBox[{"J", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", "J"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "our", " ", "definition", " ", "of", " ", "certain", " ", 
          "variables", " ", "are", " ", 
          RowBox[{"w", ".", "r", ".", "t"}], " ", "a", " ", "different", " ", 
          "coordinate", " ", "system"}], ",", " ", 
         RowBox[{
         "so", " ", "do", " ", "a", " ", "change", " ", "of", " ", 
          "coordinates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rot", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"NLink`Private`rotZ", "[", 
           RowBox[{
            RowBox[{
            "x0", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
            RowBox[{
            "x0", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
           "]"}], "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", "2"}], ",", 
           RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"drot", " ", "=", " ", 
        RowBox[{"NLink`Private`tensprod", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"rot", ".", 
            RowBox[{
             RowBox[{"NLink`Private`drotZ", "[", 
              RowBox[{
               RowBox[{
               "x0", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x0", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
               "]"}], "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"1", ";;", "2"}], ",", 
              RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ".", 
            "rot"}]}], ",", " ", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i_", " ", "/;", " ", 
               RowBox[{
                RowBox[{"i", " ", "\[Equal]", " ", "3"}], " ", "||", " ", 
                RowBox[{"i", " ", "\[Equal]", " ", "4"}]}]}], "\[Rule]", " ", 
              "1"}], "}"}], ",", " ", 
            RowBox[{"3", "n"}]}], "]"}]}], " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d\[CapitalLambda]inv", " ", "=", " ", 
        RowBox[{
         RowBox[{"NLink`Private`dXB", "[", 
          RowBox[{"drot", ",", " ", 
           RowBox[{"NLink`Private`\[CapitalLambda]inv", ".", 
            RowBox[{"rot", "\[Transpose]"}]}]}], "]"}], " ", "+", " ", 
         RowBox[{"NLink`Private`AdXB", "[", 
          RowBox[{
          "rot", ",", " ", "NLink`Private`d\[CapitalLambda]inv", ",", " ", 
           RowBox[{"rot", "\[Transpose]"}]}], "]"}], " ", "+", " ", 
         RowBox[{"NLink`Private`AdX", "[", 
          RowBox[{
           RowBox[{"rot", ".", "NLink`Private`\[CapitalLambda]inv"}], ",", 
           " ", 
           RowBox[{"drot", "\[Transpose]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rot", " ", "=", " ", 
        RowBox[{
         RowBox[{"NLink`Private`rotZ", "[", 
          RowBox[{
           RowBox[{
           "x0", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "x0", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
          "]"}], "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", " ", "=", "  ", 
        RowBox[{
         RowBox[{"rot", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", 
         "rot"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Ld", "\[Transpose]"}], ".", "D", ".", "Ld"}], ",", " ", 
         "Minv", ",", " ", "c", ",", " ", "NLink`Private`dc", ",", " ", "dM", 
         ",", " ", 
         RowBox[{"-", 
          RowBox[{"Minv", ".", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Minv", ".", "dM"}], ")"}], "\[Transpose]"}]}]}], ",", 
         " ", "F", ",", " ", "dF", ",", " ", 
         RowBox[{"NLink`Private`MovePoint", "[", 
          RowBox[{"Xa", ",", " ", 
           RowBox[{"rc", "\[LeftDoubleBracket]", 
            RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Inverse", "[", "rot", "]"}], ".", "J"}], ",", " ", 
         "\[CapitalLambda]", ",", " ", 
         RowBox[{"-", 
          RowBox[{"\[CapitalLambda]", ".", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalLambda]", ".", "d\[CapitalLambda]inv"}], ")"}],
             "\[Transpose]"}]}]}], ",", " ", 
         RowBox[{"\[Lambda]", ".", 
          RowBox[{"x0", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], ",",
          " ", "P", ",", " ", "dP"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"physical", " ", "parameters"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"L", "=", "0.610"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lc", "=", "0.5462312933834292"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "9.81"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "3.083276839957533"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", " ", "=", " ", 
   RowBox[{"2", " ", "L"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"d", "/", "g"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"di", " ", "=", " ", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"L", "-", "Lc"}], ")"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"L", "/", "d"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lc", "=", 
   RowBox[{"Lc", "/", "d"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", " ", "=", " ", 
   RowBox[{
    RowBox[{"d", "/", "di"}], " ", "m"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ic", "=", 
   RowBox[{"5.386568898408416*^-2", " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"d", " ", "di"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", "=", " ", 
    RowBox[{
     RowBox[{"g", " ", "/", "d"}], " ", 
     RowBox[{"dt", "^", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0", ",", " ", "0", ",", " ", "1", ",", "2", ",", "0", ",", " ", "0", 
      ",", " ", "3", ",", "4"}], "}"}], " ", "+", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", " ", 
      RowBox[{"2", "n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u0", " ", "=", " ", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", "n"}], "]"}], " ", "+", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", " ", "n"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx0", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "n"}], ",", " ", 
      RowBox[{"3", "n"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du0", " ", "=", " ", 
    RowBox[{"PadLeft", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", 
        RowBox[{"3", "n"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"First", "/@", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"dp", " ", "=", " ", 
        RowBox[{"DoublePendulum", "[", 
         RowBox[{"x0", ",", " ", "u0"}], "]"}]}], ";"}], "]"}], ",", " ", 
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"dpn", " ", "=", " ", 
        RowBox[{"DoublePendulumNLinks", "[", 
         RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], 
         "]"}]}], ";"}], "]"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", " ", "/@", " ", "dp"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", " ", "/@", " ", "dpn"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"(", 
    RowBox[{"dp", " ", "-", " ", "dpn"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{
  3.591721599371851*^9, {3.591721657996955*^9, 3.5917218084503746`*^9}, {
   3.5917218422941875`*^9, 3.5917220327476854`*^9}, {3.5917221392010207`*^9, 
   3.5917221567948055`*^9}, {3.5917222529199934`*^9, 
   3.5917223548108172`*^9}, {3.591722488342326*^9, 3.5917224926079597`*^9}, {
   3.59172301984925*^9, 3.5917230238648806`*^9}, {3.5917548461083035`*^9, 
   3.591754916467821*^9}, {3.591754979421064*^9, 3.5917549812804403`*^9}, {
   3.591755016811763*^9, 3.591755016983638*^9}, {3.5917550792650127`*^9, 
   3.591755080171262*^9}, {3.5917551296401234`*^9, 3.591755129827608*^9}, {
   3.5917551599057894`*^9, 3.5917551615620584`*^9}, {3.5917552074215097`*^9, 
   3.591755237187193*^9}, {3.591755370312454*^9, 3.5917553754687157`*^9}, 
   3.5917555803128643`*^9, {3.5917556134848003`*^9, 3.591755613578553*^9}, {
   3.591755778360127*^9, 3.591755815891447*^9}, {3.5917558605634127`*^9, 
   3.5917558925322247`*^9}, {3.591756074391956*^9, 3.591756149548354*^9}, {
   3.591756310970561*^9, 3.5917563151268034`*^9}, {3.5917564127207413`*^9, 
   3.591756437314536*^9}, 3.5917576509149857`*^9, {3.5917586590247173`*^9, 
   3.5917586816740136`*^9}, {3.5917588377309666`*^9, 
   3.5917588511307173`*^9}, {3.5917589551996775`*^9, 
   3.5917590770446553`*^9}, {3.591759369200386*^9, 3.591759378725931*^9}, {
   3.5917594490959616`*^9, 3.591759451098076*^9}, {3.5917599633694115`*^9, 
   3.5917599822164917`*^9}, {3.591831546886757*^9, 3.5918315477358027`*^9}, {
   3.591831914062784*^9, 3.5918319505428705`*^9}, {3.5918321680303297`*^9, 
   3.5918321780379043`*^9}, {3.591832462070164*^9, 3.591832487757639*^9}, {
   3.5918374522729387`*^9, 3.5918374593833447`*^9}, {3.5918376451989837`*^9, 
   3.59183765385448*^9}, 3.5918379687915144`*^9, {3.591838731134189*^9, 
   3.591838777415824*^9}, 3.5918389424242754`*^9, {3.5918390452891626`*^9, 
   3.5918390550887313`*^9}, {3.591839249217846*^9, 3.5918392578893423`*^9}, {
   3.5918393778882093`*^9, 3.591839409848044*^9}, {3.5918397141144657`*^9, 
   3.5918397163125916`*^9}, {3.591839830737147*^9, 3.59183986374505*^9}, {
   3.591839925744606*^9, 3.5918399336640387`*^9}, {3.5918400255463*^9, 
   3.5918400433453407`*^9}, {3.591840126970111*^9, 3.5918401284171915`*^9}, {
   3.591840302186164*^9, 3.591840305185315*^9}, {3.591840439376017*^9, 
   3.591840512306177*^9}, {3.5918406365222917`*^9, 3.591840654106298*^9}, {
   3.591840685067074*^9, 3.5918407787944393`*^9}, {3.5918408097882123`*^9, 
   3.5918408861855884`*^9}, {3.5918410254105616`*^9, 3.591841029145772*^9}, {
   3.5918413007313256`*^9, 3.5918413038505044`*^9}, {3.59184133974856*^9, 
   3.591841344363824*^9}, {3.591841389450407*^9, 3.591841440930358*^9}, {
   3.591841505426051*^9, 3.5918415280013385`*^9}, 3.591841637402603*^9, {
   3.5918417527952166`*^9, 3.591841780504822*^9}, {3.5918418438504505`*^9, 
   3.591841857018185*^9}, {3.591841957611964*^9, 3.5918419949070816`*^9}, {
   3.5918422339937763`*^9, 3.59184229353718*^9}, {3.591842352472558*^9, 
   3.591842476137637*^9}, {3.5918425121297045`*^9, 3.591842514489834*^9}, {
   3.591842554763142*^9, 3.5918426008407784`*^9}, {3.5918426541948338`*^9, 
   3.591842657386019*^9}, {3.5918426882917895`*^9, 3.591842713057211*^9}, {
   3.5918428252826295`*^9, 3.591842840067481*^9}, {3.5918428765625715`*^9, 
   3.5918429038581314`*^9}, {3.591842937826098*^9, 3.5918429492817335`*^9}, {
   3.5918432365701838`*^9, 3.591843237209222*^9}, {3.591843311546482*^9, 
   3.5918433382490106`*^9}, {3.591843391915079*^9, 3.591843470498603*^9}, {
   3.5918435162131987`*^9, 3.5918435664160767`*^9}, {3.591843607597433*^9, 
   3.5918436788575263`*^9}, {3.5918437120904164`*^9, 
   3.5918437267602544`*^9}, {3.5918441849446816`*^9, 
   3.5918443947467146`*^9}, {3.5918446094359927`*^9, 3.591844642171868*^9}, {
   3.591844687523486*^9, 3.591844783530966*^9}, {3.5918805227323666`*^9, 
   3.591880570522108*^9}, {3.5918806202429523`*^9, 3.5918806438023033`*^9}, {
   3.591880815617144*^9, 3.5918808586456075`*^9}, {3.591880992238255*^9, 
   3.5918810273502684`*^9}, {3.5918810899138517`*^9, 3.591881090174862*^9}, {
   3.591881263814807*^9, 3.591881290790355*^9}, {3.5918813933462257`*^9, 
   3.591881467522476*^9}, {3.5918815086338277`*^9, 3.591881548841132*^9}, {
   3.5918816810016994`*^9, 3.591881683592863*^9}, {3.5918817362688704`*^9, 
   3.591881804449771*^9}, 3.5918818388847427`*^9, {3.5918819216324787`*^9, 
   3.5918819240196133`*^9}, {3.5918819841700625`*^9, 3.591881992830556*^9}, {
   3.5918820512759056`*^9, 3.591882054858108*^9}, {3.5918821550708475`*^9, 
   3.591882205082714*^9}, {3.5918822380816007`*^9, 3.591882263082035*^9}, {
   3.591882301378228*^9, 3.5918823039543734`*^9}, {3.5918823500840144`*^9, 
   3.5918824424423037`*^9}, {3.591882498688527*^9, 3.591882537282735*^9}, {
   3.5918825863115454`*^9, 3.5918825881586485`*^9}, {3.591882893177118*^9, 
   3.591882901150573*^9}, {3.591882954394621*^9, 3.5918829570007687`*^9}, {
   3.5918830081857014`*^9, 3.5918830293939185`*^9}, {3.591883117612985*^9, 
   3.5918832182137327`*^9}, {3.5918832504125767`*^9, 3.591883353242462*^9}, {
   3.591883386563373*^9, 3.591883449496996*^9}, {3.5918834854660344`*^9, 
   3.5918834973227158`*^9}, {3.5918837844951606`*^9, 
   3.5918837867132883`*^9}, {3.5918838445775976`*^9, 
   3.5918839007548385`*^9}, {3.5918839316105833`*^9, 
   3.5918839442343063`*^9}, {3.5918840002195144`*^9, 
   3.5918840206586847`*^9}, {3.591884248162711*^9, 3.591884253760034*^9}, {
   3.591884331346496*^9, 3.5918843602021313`*^9}, {3.5918844114590654`*^9, 
   3.5918845240895157`*^9}, 3.5918845845449777`*^9, {3.5918846293875494`*^9, 
   3.591884646440541*^9}, {3.5918847991162834`*^9, 3.591884897739914*^9}, {
   3.5918850129215093`*^9, 3.591885040256072*^9}, {3.5918851175324974`*^9, 
   3.59188512195675*^9}, {3.591885273837453*^9, 3.5918852753555355`*^9}, {
   3.591885330703707*^9, 3.5918853726151047`*^9}, 3.591885587547432*^9, {
   3.5918858031617603`*^9, 3.5918858136493635`*^9}, {3.5918863491660285`*^9, 
   3.591886355580413*^9}, {3.5918864404212575`*^9, 3.5918864530149755`*^9}, {
   3.5918869598860054`*^9, 3.591887106281384*^9}, {3.591887146207694*^9, 
   3.591887214473585*^9}, {3.591887250427641*^9, 3.5918872656215286`*^9}, {
   3.5918873000574827`*^9, 3.591887349785339*^9}, {3.591887398001094*^9, 
   3.591887398407118*^9}, {3.591887563511571*^9, 3.591887719288492*^9}, {
   3.5918878047513847`*^9, 3.591887815846023*^9}, {3.591888566919035*^9, 
   3.591888632337781*^9}, {3.591889110734195*^9, 3.59188919942127*^9}, {
   3.5918892350642967`*^9, 3.5918892470339794`*^9}, {3.5918892888113747`*^9, 
   3.5918892990099554`*^9}, {3.5918893370761356`*^9, 
   3.5918893599964485`*^9}, {3.5918893967725544`*^9, 
   3.5918895272570295`*^9}, {3.5918895888705583`*^9, 
   3.5918896565604315`*^9}, {3.5918896915884376`*^9, 3.591889702044039*^9}, {
   3.5918897471566176`*^9, 3.5918897590433035`*^9}, {3.591889894630065*^9, 
   3.591889942557826*^9}, {3.591889991181596*^9, 3.5918899992620597`*^9}, {
   3.591890044763663*^9, 3.5918900519490805`*^9}, {3.591890110233412*^9, 
   3.591890162794425*^9}, {3.591890197310398*^9, 3.591890218826634*^9}, {
   3.591890270566597*^9, 3.591890270717623*^9}, {3.5918903831010413`*^9, 
   3.591890459683423*^9}, {3.591890490332179*^9, 3.5918905180367656`*^9}, {
   3.591890559367135*^9, 3.5918905646624403`*^9}, {3.591890615621353*^9, 
   3.5918906711095324`*^9}, {3.591890713750975*^9, 3.591890725366646*^9}, 
   3.5918907663989997`*^9, {3.591890796485714*^9, 3.5918908047491875`*^9}, {
   3.5918908357399597`*^9, 3.5918908713720217`*^9}, {3.5918909072940598`*^9, 
   3.5918909225439367`*^9}, {3.59189098885273*^9, 3.5918910895175066`*^9}, {
   3.5918912873758297`*^9, 3.5918913027527094`*^9}, {3.5918913375246983`*^9, 
   3.5918913386687775`*^9}, {3.59189146286387*^9, 3.591891487160267*^9}, {
   3.5918916663215246`*^9, 3.591891676828148*^9}, {3.591891790949664*^9, 
   3.5918919326307774`*^9}, {3.5918919675347767`*^9, 
   3.5918920244940376`*^9}, {3.591892456466776*^9, 3.591892460072979*^9}, {
   3.5918925936656327`*^9, 3.5918925965287933`*^9}, {3.591892684860856*^9, 
   3.5918927411660795`*^9}, {3.591892839372701*^9, 3.5918928986780996`*^9}, {
   3.5918929519601526`*^9, 3.5918929700331855`*^9}, {3.591893031899726*^9, 
   3.5918931034578266`*^9}, {3.5918931556808147`*^9, 3.591893172423772*^9}, {
   3.5918932106479645`*^9, 3.5918932127500834`*^9}, {3.5918933506879826`*^9, 
   3.591893368911025*^9}, {3.591893420527003*^9, 3.591893436525898*^9}, {
   3.591893469646797*^9, 3.5918934907980213`*^9}, {3.591893602678413*^9, 
   3.591893619767394*^9}, {3.5918945596412125`*^9, 3.591894570022812*^9}, 
   3.591894816306915*^9, {3.5918949239850817`*^9, 3.591894943176178*^9}, {
   3.5918950029366007`*^9, 3.59189502052763*^9}, {3.5918951743634176`*^9, 
   3.5918952106255007`*^9}, 3.5918954509362774`*^9, {3.5918954822830534`*^9, 
   3.591895514845936*^9}, {3.591895545790691*^9, 3.5918955756694207`*^9}, {
   3.5918956321526403`*^9, 3.5918956965213227`*^9}, {3.5918957384457216`*^9, 
   3.5918958154811354`*^9}, {3.591895913104726*^9, 3.5918960073361197`*^9}, {
   3.5918964108432293`*^9, 3.59189642214189*^9}, {3.591896481006266*^9, 
   3.591896495129051*^9}, {3.5918965607928305`*^9, 3.5918965881853824`*^9}, 
   3.5918966387452803`*^9, {3.591896711144423*^9, 3.591896735238804*^9}, {
   3.5918967979693985`*^9, 3.5918968032247*^9}, {3.591897114311515*^9, 
   3.5918971358007455`*^9}, {3.591897179184248*^9, 3.5918972242428107`*^9}, {
   3.591897459544285*^9, 3.591897482943644*^9}, {3.5918976052736278`*^9, 
   3.591897608959837*^9}, {3.5918976753936443`*^9, 3.5918977835338364`*^9}, 
   3.591897932414362*^9, {3.5918980045914955`*^9, 3.5918980075656753`*^9}, {
   3.5918980567764997`*^9, 3.5918981164299*^9}, 3.591898153903049*^9, {
   3.5918981970465164`*^9, 3.5918982073841114`*^9}, 3.5918984299348555`*^9, {
   3.5918984872861404`*^9, 3.5918984898142824`*^9}, {3.591898535508906*^9, 
   3.59189863663169*^9}, {3.591898707559752*^9, 3.5918987582566557`*^9}, {
   3.591898792473626*^9, 3.5918988214082713`*^9}, {3.591898882672778*^9, 
   3.5918988828847914`*^9}, {3.5918989780512457`*^9, 3.591899021011705*^9}, 
   3.591899128785874*^9, {3.5918992046342173`*^9, 3.591899245458555*^9}, {
   3.5918993388989086`*^9, 3.591899535753183*^9}, 3.591899670137875*^9, 
   3.591899768067484*^9, {3.5918998026634645`*^9, 3.5918998093368497`*^9}, {
   3.5918998932816544`*^9, 3.5919000290254283`*^9}, {3.5919000723709097`*^9, 
   3.5919000826735*^9}, 3.5919001372336254`*^9, {3.5919002335931454`*^9, 
   3.591900244130749*^9}, {3.5919003059062867`*^9, 3.5919003418813467`*^9}, {
   3.591900374184213*^9, 3.591900426089188*^9}, {3.59190061857819*^9, 
   3.5919006655838842`*^9}, {3.5919007106234636`*^9, 
   3.5919007385040607`*^9}, {3.5919012176414986`*^9, 
   3.5919012202716465`*^9}, {3.59190494854215*^9, 3.591904949661219*^9}, 
   3.591907411378192*^9, {3.591907588586341*^9, 3.591907589500393*^9}, {
   3.5919076768503957`*^9, 3.5919076771474094`*^9}, {3.5919079104027696`*^9, 
   3.5919079476139097`*^9}, {3.591908000712941*^9, 3.5919080606873784`*^9}, {
   3.5919096071816735`*^9, 3.5919096235006094`*^9}, {3.5919096568635163`*^9, 
   3.59190966037372*^9}, {3.5919096914334965`*^9, 3.591909791985257*^9}, {
   3.5919098300494337`*^9, 3.5919098314215136`*^9}, 3.5919098622072735`*^9, {
   3.5919134831912656`*^9, 3.5919135268707676`*^9}, {3.5919137024378214`*^9, 
   3.5919137327035527`*^9}, {3.591913782751423*^9, 3.5919138119830947`*^9}, {
   3.5919140184159217`*^9, 3.5919140213050976`*^9}, 3.5919140585682154`*^9, {
   3.591914097534447*^9, 3.591914097757476*^9}, {3.5919141445081377`*^9, 
   3.591914179638151*^9}, {3.59193438905231*^9, 3.59193441045754*^9}, {
   3.591966458835248*^9, 3.5919664692448425`*^9}, {3.5919665335975323`*^9, 
   3.5919665427470703`*^9}, {3.5919673762977953`*^9, 
   3.5919673763947964`*^9}, {3.591969200660266*^9, 3.591969201050289*^9}, 
   3.591969372956131*^9, 3.591970325418682*^9, {3.591986522731243*^9, 
   3.5919865386791677`*^9}, {3.591986839396378*^9, 3.5919869165168076`*^9}, {
   3.5919869691718044`*^9, 3.5919869770912623`*^9}, {3.5919870286362267`*^9, 
   3.5919870635552096`*^9}, 3.5919871568205547`*^9, {3.591987257442315*^9, 
   3.5919872872730227`*^9}, {3.591987319652893*^9, 3.5919873229720697`*^9}, {
   3.5919873949061885`*^9, 3.5919873960322523`*^9}, {3.591987474394741*^9, 
   3.5919875609376974`*^9}, {3.5919892117472286`*^9, 3.591989215817464*^9}, {
   3.5919896222657433`*^9, 3.591989626663992*^9}, {3.5919897210353966`*^9, 
   3.5919897234905367`*^9}, {3.591989878961439*^9, 3.5919899150415087`*^9}, {
   3.591989947977393*^9, 3.5919899492484674`*^9}, {3.5919899845214853`*^9, 
   3.591990075265684*^9}, {3.591990297996437*^9, 3.5919903119722366`*^9}, {
   3.5919904147551227`*^9, 3.5919904155051684`*^9}, 3.5919910030838146`*^9, {
   3.5919913460144553`*^9, 3.591991346093461*^9}, {3.591991381525489*^9, 
   3.5919913815804896`*^9}, {3.5919914302462797`*^9, 3.591991484981414*^9}, 
   3.591992053861005*^9, {3.5919921520856113`*^9, 3.5919923247945075`*^9}, {
   3.591992374564357*^9, 3.591992400171838*^9}, {3.591992574653816*^9, 
   3.591992599388232*^9}, {3.5919996164230876`*^9, 3.591999643214609*^9}, {
   3.5920000354330697`*^9, 3.5920000547611732`*^9}, {3.5920000935223937`*^9, 
   3.5920001741060066`*^9}, {3.592009683096558*^9, 3.592009745121109*^9}, {
   3.592009882834997*^9, 3.5920100259391937`*^9}, {3.592010167304285*^9, 
   3.592010180999072*^9}, 3.5920161932273693`*^9, {3.5920163022826204`*^9, 
   3.592016382781227*^9}, {3.5920167207385807`*^9, 3.592016748774186*^9}, {
   3.5920174895506086`*^9, 3.592017534516183*^9}, {3.5920217125694456`*^9, 
   3.592021732304578*^9}, 3.5920217883427825`*^9, 3.592021871246551*^9, {
   3.5920221762369967`*^9, 3.592022176936034*^9}, {3.5920222151692286`*^9, 
   3.592022252008338*^9}, 3.592024546678742*^9, {3.5920301708008175`*^9, 
   3.592030176747161*^9}, {3.5920656190862217`*^9, 3.59206562129235*^9}, {
   3.5920923083716307`*^9, 3.5920923093696976`*^9}, 3.5920923403994637`*^9, {
   3.5921219535817385`*^9, 3.5921219553948383`*^9}, 3.5921531657502446`*^9, {
   3.592153196295994*^9, 3.5921531980630927`*^9}, {3.592153384259758*^9, 
   3.592153465910434*^9}, {3.5921639379511433`*^9, 3.592163940046255*^9}, {
   3.592164011550344*^9, 3.592164028546316*^9}, {3.5921640752399945`*^9, 
   3.592164107186819*^9}, {3.592164170032423*^9, 3.592164189006524*^9}, {
   3.5921643464115205`*^9, 3.5921644364096904`*^9}, {3.592164489104692*^9, 
   3.5921644955670657`*^9}, {3.592164536722424*^9, 3.5921645367934237`*^9}, {
   3.592164624540451*^9, 3.592164627004593*^9}, {3.5921647229830885`*^9, 
   3.5921647233621283`*^9}, {3.592164806897894*^9, 3.592164822967812*^9}, {
   3.59216487934604*^9, 3.592164965674986*^9}, 3.5921653066995163`*^9, {
   3.5921657863819857`*^9, 3.5921658497656155`*^9}, {3.5921658949952073`*^9, 
   3.5921659280290947`*^9}, {3.5921660045634794`*^9, 3.592166023116543*^9}, 
   3.5921727806065216`*^9, 3.592172829960348*^9, {3.5921730001730947`*^9, 
   3.5921730094266253`*^9}, 3.592173141683199*^9, 3.5921731825895414`*^9, {
   3.592173488664069*^9, 3.5921734932753334`*^9}, {3.5921738707089477`*^9, 
   3.5921739183116713`*^9}, {3.5921863410962653`*^9, 
   3.5921864496294837`*^9}, {3.592186498936302*^9, 3.592186519796502*^9}, {
   3.592186694089483*^9, 3.592186694387519*^9}, 3.592186794004201*^9, {
   3.592186856037757*^9, 3.592186857414833*^9}, 3.5921868991542215`*^9, {
   3.592187056726263*^9, 3.592187058277338*^9}, {3.592187123697085*^9, 
   3.592187129328413*^9}, {3.5921872551466103`*^9, 3.5921872558166485`*^9}, 
   3.5922545281132717`*^9, {3.592289662764948*^9, 3.5922897196011977`*^9}, {
   3.5922897720281982`*^9, 3.5922897766484623`*^9}, {3.5922899226798277`*^9, 
   3.5922899384387302`*^9}, {3.592325488310385*^9, 3.592325489828468*^9}, {
   3.5923256924520707`*^9, 3.592325797161067*^9}, 3.592325858391573*^9, {
   3.5923342543143764`*^9, 3.5923343105445986`*^9}, {3.5923344517626867`*^9, 
   3.592334456663967*^9}, {3.592334788983995*^9, 3.592334801260701*^9}, {
   3.5923348517726035`*^9, 3.5923348661844187`*^9}, {3.592334919810487*^9, 
   3.5923349718144684`*^9}, {3.5923350489668818`*^9, 3.592335053368135*^9}, 
   3.5923351247472296`*^9, {3.5923351929471316`*^9, 3.5923352685504603`*^9}, {
   3.5923353485670433`*^9, 3.5923353880713058`*^9}, {3.592335503014886*^9, 
   3.592335503450917*^9}, {3.5923356214136653`*^9, 3.5923356281990566`*^9}, {
   3.592336348096282*^9, 3.592336378610027*^9}, {3.592336964148562*^9, 
   3.5923369743721485`*^9}, {3.5923370472453175`*^9, 
   3.5923370494604445`*^9}, {3.5923371783378277`*^9, 3.592337207976525*^9}, {
   3.592337261271577*^9, 3.5923372721071973`*^9}, 3.592338170116646*^9, 
   3.592338264679036*^9, {3.5923383336579895`*^9, 3.592338335293082*^9}, {
   3.5923383776915145`*^9, 3.5923383779565268`*^9}, {3.5923389326812897`*^9, 
   3.5923389474891405`*^9}, {3.592339495737537*^9, 3.59233949997878*^9}, {
   3.592339699126184*^9, 3.592339741257597*^9}, 3.5923398932813005`*^9, {
   3.5923399782201676`*^9, 3.592339978298171*^9}, {3.5923427446565895`*^9, 
   3.5923427965475626`*^9}, {3.592342827313322*^9, 3.5923428295274515`*^9}, 
   3.5923497646156125`*^9, 3.5923499540754623`*^9, 3.5923501141936283`*^9, 
   3.5923506140922585`*^9, {3.592350782062874*^9, 3.5923508069343023`*^9}, {
   3.5923519166988544`*^9, 3.5923519603213525`*^9}, {3.592352004543885*^9, 
   3.59235201439845*^9}, {3.5923520604710875`*^9, 3.592352063007234*^9}, {
   3.592353896344219*^9, 3.592353948778225*^9}, {3.592355696783326*^9, 
   3.5923556994314747`*^9}, {3.592355740249816*^9, 3.5923557404388247`*^9}, {
   3.5923614599074354`*^9, 3.5923615203048944`*^9}, {3.592362670386755*^9, 
   3.5923626902428923`*^9}, {3.5923638084909306`*^9, 3.59236381743544*^9}, {
   3.592364101648716*^9, 3.592364135321662*^9}, {3.5923714005887036`*^9, 
   3.592371476678059*^9}, {3.5923718943449926`*^9, 3.5923718945039883`*^9}, {
   3.592378506861656*^9, 3.592378509709819*^9}, {3.592379903410631*^9, 
   3.592379910113011*^9}, {3.592379955922635*^9, 3.5923799701514616`*^9}, {
   3.592381519991207*^9, 3.5923815227453623`*^9}, {3.5923823501347466`*^9, 
   3.592382352058856*^9}, {3.5923825013424053`*^9, 3.592382546019964*^9}, {
   3.592383531474398*^9, 3.592383549185412*^9}, {3.5923843494372406`*^9, 
   3.592384350669307*^9}, {3.592409961844974*^9, 3.5924099630120535`*^9}, {
   3.5924319150061555`*^9, 3.592431926356805*^9}, {3.5924319864172416`*^9, 
   3.59243209750861*^9}, {3.5924321584030943`*^9, 3.5924322407548094`*^9}, {
   3.5924323214424295`*^9, 3.5924323528572273`*^9}, {3.5924323890753098`*^9, 
   3.592432399761915*^9}, {3.592437574288983*^9, 3.592437576014078*^9}, 
   3.5924379589900084`*^9, {3.5924380121990633`*^9, 3.592438015045218*^9}, {
   3.5924384784077573`*^9, 3.5924384986709146`*^9}, {3.5925029487661343`*^9, 
   3.592502951076269*^9}, {3.5925111062032843`*^9, 3.592511159745353*^9}, {
   3.5925111996986413`*^9, 3.592511247952404*^9}, {3.592511314232196*^9, 
   3.592511394777813*^9}, {3.592511480953745*^9, 3.5925114974186907`*^9}, {
   3.592524319783981*^9, 3.592524326833387*^9}, {3.5925244173815727`*^9, 
   3.5925244213317986`*^9}, {3.5925244803911996`*^9, 3.592524482969329*^9}, {
   3.5925322401505556`*^9, 3.5925322586446333`*^9}, {3.5925323069673853`*^9, 
   3.59253235029286*^9}, {3.592532393190319*^9, 3.5925323951014304`*^9}, {
   3.5925324377568693`*^9, 3.5925324380849085`*^9}, {3.5925328306223693`*^9, 
   3.5925328719487357`*^9}, {3.592533137536943*^9, 3.59253317360001*^9}, {
   3.592533392821565*^9, 3.5925333950607166`*^9}, {3.5925334382771654`*^9, 
   3.59253348050159*^9}, {3.592533558421049*^9, 3.5925335766770935`*^9}, {
   3.5925336228217545`*^9, 3.5925336460100613`*^9}, {3.5925336916426773`*^9, 
   3.592533714607992*^9}, {3.592533783576942*^9, 3.592533784275001*^9}, {
   3.5925338719350014`*^9, 3.5925339203907804`*^9}, {3.5925345297266855`*^9, 
   3.5925345483517375`*^9}, {3.5925348706311893`*^9, 
   3.5925349004419007`*^9}, {3.592536473123976*^9, 3.5925364732909727`*^9}, {
   3.5925366961827364`*^9, 3.5925367071003594`*^9}, {3.5925367461546173`*^9, 
   3.5925367466186223`*^9}, 3.5925368455132856`*^9, {3.5925371117435303`*^9, 
   3.5925372502154617`*^9}, {3.5925373746015854`*^9, 3.5925373760566707`*^9}, 
   3.5925375341257267`*^9, {3.5925378919792166`*^9, 3.5925379001386833`*^9}, {
   3.5925429139338074`*^9, 3.592542921717267*^9}, 3.5925429619905553`*^9, 
   3.592543305146209*^9, {3.5925434290553055`*^9, 3.592543469560622*^9}, {
   3.5925436217263384`*^9, 3.5925436296137905`*^9}, {3.5925752939358115`*^9, 
   3.592575327080709*^9}, 3.5925755065629888`*^9, 3.59257555369069*^9, {
   3.5925760466919217`*^9, 3.5925760467549257`*^9}, {3.5925761396192436`*^9, 
   3.5925761892630825`*^9}, {3.5925800446818686`*^9, 
   3.5925800449858885`*^9}, {3.592580239090006*^9, 3.5925804597106404`*^9}, {
   3.5925806026058235`*^9, 3.5925806332995825`*^9}, {3.5925806690176263`*^9, 
   3.592580754555541*^9}, 3.592581762434246*^9, {3.5925818817320747`*^9, 
   3.5925818957488775`*^9}, {3.5925821748458595`*^9, 
   3.5925821846374245`*^9}, {3.592582216139221*^9, 3.592582299145997*^9}, 
   3.592582342041435*^9, {3.592666661635562*^9, 3.592666662744937*^9}, {
   3.592713436869402*^9, 3.592713461711823*^9}, {3.5927147127704644`*^9, 
   3.5927147238921013`*^9}, 3.5927149145020185`*^9, 3.59275822760408*^9, {
   3.5927583749355145`*^9, 3.5927583771556406`*^9}, {3.5927620732223063`*^9, 
   3.59276208428494*^9}, {3.5927630316781936`*^9, 3.5927630405947175`*^9}, {
   3.592763642622175*^9, 3.592763648991558*^9}, {3.592764931237975*^9, 
   3.5927649858690987`*^9}, {3.5927731583941154`*^9, 
   3.5927731639194317`*^9}, {3.592773347184927*^9, 3.5927733473999395`*^9}, {
   3.592774116160965*^9, 3.59277422734233*^9}, {3.5927742987434187`*^9, 
   3.592774305326793*^9}, {3.5927761752718787`*^9, 3.592776192661878*^9}, {
   3.592776396283557*^9, 3.5927765080609345`*^9}, {3.5927824653910985`*^9, 
   3.592782495822838*^9}, 3.5927825355521126`*^9, {3.5927830143635283`*^9, 
   3.592783018330755*^9}, {3.592783358535239*^9, 3.592783363244512*^9}, {
   3.5927847021401806`*^9, 3.5927847052273626`*^9}, {3.5928667057284184`*^9, 
   3.592866710697192*^9}, {3.592866751931634*^9, 3.592866820244281*^9}, {
   3.5928668674474955`*^9, 3.5928668678537354`*^9}, {3.5928669773695765`*^9, 
   3.592866998900869*^9}, {3.592867235401329*^9, 3.5928673153858604`*^9}, {
   3.592867348276552*^9, 3.592867362745329*^9}, {3.592867719417898*^9, 
   3.5928677773086405`*^9}, {3.592867850511908*^9, 3.5928679387308292`*^9}, {
   3.5928680842936144`*^9, 3.592868084465495*^9}, {3.5928687567545013`*^9, 
   3.5928687606617255`*^9}, {3.5928697068226185`*^9, 3.592869733536167*^9}, {
   3.5928699295843754`*^9, 3.59286994808543*^9}, {3.592870029127079*^9, 
   3.5928700308751755`*^9}, {3.593008460673005*^9, 3.5930084643136396`*^9}, {
   3.593008598360774*^9, 3.593008603267034*^9}, 3.5930086725796695`*^9, {
   3.5930101657975206`*^9, 3.593010175266289*^9}, {3.5930102186726236`*^9, 
   3.5930102808289957`*^9}, 3.5930103275947113`*^9, {3.593010387204203*^9, 
   3.593010389235476*^9}, {3.5930104847669125`*^9, 3.5930104871575236`*^9}, {
   3.593010571454563*^9, 3.593010583782715*^9}, {3.593010681423529*^9, 
   3.593010685048538*^9}, {3.593093199158263*^9, 3.5930932015488963`*^9}, {
   3.5931004579957495`*^9, 3.593100481042669*^9}, {3.593100517386487*^9, 
   3.593100567589717*^9}, {3.59310062255857*^9, 3.593100630105462*^9}, {
   3.593101969326831*^9, 3.593101977920594*^9}, {3.5931021409678106`*^9, 
   3.59310217376473*^9}, {3.5931022089210463`*^9, 3.593102211092928*^9}, 
   3.593110932043898*^9, 3.593111137466175*^9, 3.5931114272636147`*^9, {
   3.5931133890174527`*^9, 3.593113445314439*^9}, {3.59311356004904*^9, 
   3.5931135608771653`*^9}, {3.593113610846015*^9, 3.593113623564785*^9}, {
   3.5931139027840824`*^9, 3.5931139470341682`*^9}, 3.5931139857217484`*^9, {
   3.5931141139251184`*^9, 3.5931141349095364`*^9}, {3.593114672863712*^9, 
   3.5931146923793774`*^9}, {3.593114814113989*^9, 3.5931148626140842`*^9}, {
   3.5931244354476633`*^9, 3.593124493580985*^9}, {3.593125296876004*^9, 
   3.5931253583565054`*^9}, {3.593125424479295*^9, 3.5931254687758274`*^9}, 
   3.593125501085682*^9, {3.5931260946486735`*^9, 3.5931260997029605`*^9}, {
   3.593126193616338*^9, 3.59312622311103*^9}, {3.5931262919459715`*^9, 
   3.5931263039036565`*^9}, {3.5931266472293177`*^9, 3.593126649964472*^9}, {
   3.5931266901847773`*^9, 3.5931266914628506`*^9}, {3.5931267530393777`*^9, 
   3.593126772419482*^9}, {3.5931285377430625`*^9, 3.5931285397781787`*^9}, {
   3.593128585948823*^9, 3.593128588365964*^9}, {3.5931286812642794`*^9, 
   3.5931287343053226`*^9}, {3.593128781030997*^9, 3.5931287960208616`*^9}, {
   3.5931288476298103`*^9, 3.593128850469969*^9}, {3.593128955013961*^9, 
   3.5931290183545847`*^9}, {3.593129060683012*^9, 3.5931292566142273`*^9}, {
   3.5931293159836316`*^9, 3.5931294173004293`*^9}, {3.5931294620139923`*^9, 
   3.593129496220951*^9}, {3.593129580101757*^9, 3.5931296013489695`*^9}, {
   3.5931296407172284`*^9, 3.593129646087536*^9}, {3.593129686563854*^9, 
   3.5931297290642834`*^9}, {3.5931304726536694`*^9, 
   3.5931304730911703`*^9}, {3.5931313571495695`*^9, 
   3.5931313641652064`*^9}, {3.593131886259982*^9, 3.5931319607444997`*^9}, {
   3.593132099057269*^9, 3.593132112276046*^9}, {3.5931327335741367`*^9, 
   3.5931327366210194`*^9}, {3.5931381350918036`*^9, 3.593138139232438*^9}, {
   3.593138583233308*^9, 3.593138672108477*^9}, {3.5931388151087594`*^9, 
   3.5931388232337737`*^9}, {3.593138936374634*^9, 3.5931390052028856`*^9}, {
   3.5931394293912196`*^9, 3.5931394297818356`*^9}, {3.593139720829281*^9, 
   3.593139761938735*^9}, {3.5931398002981834`*^9, 3.5931398015794373`*^9}, 
   3.5931927674244413`*^9, {3.5931972216490154`*^9, 3.593197244039674*^9}, {
   3.593197323102327*^9, 3.5931973335711107`*^9}, {3.5932023541746655`*^9, 
   3.593202358409048*^9}, {3.5932024997218256`*^9, 3.5932025180187387`*^9}, {
   3.5932025969720287`*^9, 3.5932025984407682`*^9}, {3.5932107878533726`*^9, 
   3.5932107945917683`*^9}, {3.593210832747944*^9, 3.593210986475751*^9}, {
   3.593216558045812*^9, 3.5932166028113794`*^9}, {3.5932202382045574`*^9, 
   3.5932202655991306`*^9}, {3.5932203056464243`*^9, 3.593220346111745*^9}, {
   3.593220710124587*^9, 3.5932209928537774`*^9}, {3.5932211749622064`*^9, 
   3.5932211829036617`*^9}, {3.5932241108947687`*^9, 
   3.5932241184472013`*^9}, {3.59322416678497*^9, 3.5932243080400586`*^9}, {
   3.593224415090189*^9, 3.593224420114477*^9}, {3.5932272380488544`*^9, 
   3.593227242995135*^9}, {3.5932272730848565`*^9, 3.5932274076245613`*^9}, {
   3.593227470068137*^9, 3.593227494417551*^9}, {3.5932275261333475`*^9, 
   3.5932275266353765`*^9}, {3.593227630676334*^9, 3.593227634041523*^9}, {
   3.593227677844035*^9, 3.593227758207636*^9}, {3.593227788285364*^9, 
   3.593227820398218*^9}, {3.593227859299427*^9, 3.5932278989786997`*^9}, {
   3.5932279677286367`*^9, 3.5932279761281204`*^9}, {3.5932280653952293`*^9, 
   3.5932280786439877`*^9}, {3.593228265190685*^9, 3.5932284338483334`*^9}, {
   3.5932284736896076`*^9, 3.5932285252455635`*^9}, {3.5932285723022614`*^9, 
   3.593228662296412*^9}, {3.5932287033767605`*^9, 3.593228724920998*^9}, {
   3.5932287602650175`*^9, 3.593228785777483*^9}, {3.593228840322607*^9, 
   3.593228870777355*^9}, {3.593230142650186*^9, 3.5932301550328956`*^9}, {
   3.5932306668172035`*^9, 3.5932306669612155`*^9}, {3.5932328898272753`*^9, 
   3.5932329082648087`*^9}, {3.5932332924686856`*^9, 3.59323329462494*^9}, {
   3.5932680098565807`*^9, 3.593268011700335*^9}, {3.593268055341044*^9, 
   3.5932682097632256`*^9}, {3.593268239872652*^9, 3.593268262060198*^9}, {
   3.593268342279125*^9, 3.593268396154211*^9}, 3.59326843785742*^9, {
   3.593268536279496*^9, 3.593268569920178*^9}, {3.5932686709360247`*^9, 
   3.5932687224048476`*^9}, {3.593268876327026*^9, 3.593268975811596*^9}, {
   3.593269116108758*^9, 3.5932691353744087`*^9}, {3.5932691891870117`*^9, 
   3.5932692002964044`*^9}, {3.5932692471715007`*^9, 
   3.5932692479996405`*^9}, {3.593269291702858*^9, 3.593269428593731*^9}, {
   3.5932694721563177`*^9, 3.5932694779844522`*^9}, {3.5932696433597755`*^9, 
   3.5932696779379826`*^9}, {3.593269710672406*^9, 3.593269720094301*^9}, {
   3.5932697765006576`*^9, 3.5932697889538236`*^9}, {3.593269855578946*^9, 
   3.593269861985205*^9}, {3.5932699181728315`*^9, 3.593270038673049*^9}, {
   3.5932700730793653`*^9, 3.5932700899387856`*^9}, {3.593270229423423*^9, 
   3.593270250907852*^9}, {3.5932702897829123`*^9, 3.593270375142458*^9}, {
   3.5932704075331526`*^9, 3.5932704946895647`*^9}, {3.59327063358048*^9, 
   3.593270887768463*^9}, {3.593270922284152*^9, 3.593271049425027*^9}, {
   3.593271121925172*^9, 3.593271133722085*^9}, {3.593271177081541*^9, 
   3.593271178034647*^9}, {3.593271239237896*^9, 3.5932712658629503`*^9}, {
   3.5932714471133204`*^9, 3.5932715997386007`*^9}, {3.593271658488714*^9, 
   3.5932716673168716`*^9}, {3.5932716990981903`*^9, 3.593271751363898*^9}, {
   3.5932718015358715`*^9, 3.593271806614006*^9}, {3.593272173536598*^9, 
   3.5932721849116397`*^9}, {3.5932722893649645`*^9, 3.593272544240463*^9}, {
   3.5932725962405634`*^9, 3.593272640146891*^9}, {3.593272677756344*^9, 
   3.5932726864594727`*^9}, {3.5932729812569275`*^9, 
   3.5932730209988813`*^9}, {3.5932730964365206`*^9, 3.59327312235845*^9}, {
   3.5932733977524834`*^9, 3.593273419024702*^9}, {3.5932736646603546`*^9, 
   3.5932736793322716`*^9}, {3.5932738463794584`*^9, 
   3.5932738947076902`*^9}, {3.593273934098379*^9, 3.5932741052080917`*^9}, {
   3.5932742190989428`*^9, 3.5932743065209827`*^9}, {3.593274378208638*^9, 
   3.5932743935680356`*^9}, {3.5932744540368977`*^9, 3.593274454786903*^9}, {
   3.593274510787012*^9, 3.5932746228497286`*^9}, {3.5932750798974953`*^9, 
   3.5932751329444885`*^9}, {3.593275704211217*^9, 3.5932757266487637`*^9}, {
   3.593275779461361*^9, 3.5932758095551786`*^9}, {3.593277149932806*^9, 
   3.593277229417326*^9}, {3.5932772747924194`*^9, 3.59327727826118*^9}, {
   3.5932773249643908`*^9, 3.59327736755822*^9}, {3.593277498667852*^9, 
   3.593277516480385*^9}, 3.59327757165237*^9, {3.5932776029024305`*^9, 
   3.5932776441993856`*^9}, {3.5932802218294277`*^9, 
   3.5932802254388084`*^9}, {3.5932805802363806`*^9, 
   3.5932806007051682`*^9}, {3.593289347628524*^9, 3.5932893525191765`*^9}, {
   3.5932895307695246`*^9, 3.593289559019562*^9}, {3.593296571650735*^9, 
   3.5932966028695526`*^9}, {3.593296643166487*^9, 3.593296723213516*^9}, {
   3.593296811573079*^9, 3.5932968270418425`*^9}, {3.5932970124640837`*^9, 
   3.593297018557846*^9}, {3.593297135042448*^9, 3.593297138651833*^9}, {
   3.593297318449057*^9, 3.5932973444803605`*^9}, {3.593298630998498*^9, 
   3.5932986799360943`*^9}, {3.593299435437572*^9, 3.5932994370313263`*^9}, {
   3.593299553765929*^9, 3.5932995542190537`*^9}, {3.593300584767945*^9, 
   3.593300585330448*^9}, {3.593300755987029*^9, 3.593300861659111*^9}, {
   3.593301063706381*^9, 3.593301079925173*^9}, {3.5933016945669937`*^9, 
   3.5933016965513697`*^9}, {3.593301727254555*^9, 3.593301775364027*^9}, {
   3.593302027536406*^9, 3.593302029192649*^9}, {3.593302089520891*^9, 
   3.5933020907083893`*^9}, {3.593302178364812*^9, 3.5933022125680056`*^9}, {
   3.5933023205682154`*^9, 3.5933023232869697`*^9}, {3.593302385599592*^9, 
   3.59330246022475*^9}, {3.593302538959263*^9, 3.593302665178265*^9}, 
   3.593302715131486*^9, {3.593302926053774*^9, 3.5933029285381546`*^9}, {
   3.5933029650694847`*^9, 3.593302977288252*^9}, {3.5933030292883515`*^9, 
   3.5933030339914837`*^9}, {3.5933030642727947`*^9, 
   3.5933031311166763`*^9}, {3.5933031955230494`*^9, 3.593303202101189*^9}, {
   3.5933032522262897`*^9, 3.5933032742888303`*^9}, {3.5933033168826604`*^9, 
   3.593303318867043*^9}, {3.59330334902335*^9, 3.5933033604140096`*^9}, {
   3.5933037304928474`*^9, 3.5933037949773474`*^9}, {3.5933042254625835`*^9, 
   3.593304254071995*^9}, {3.593305105448662*^9, 3.5933051145268183`*^9}, {
   3.593306156950714*^9, 3.593306159591362*^9}, {3.5933063459979615`*^9, 
   3.5933063981543226`*^9}, {3.5933065005138855`*^9, 
   3.5933065532639914`*^9}, {3.5933067857331953`*^9, 
   3.5933068264989004`*^9}, {3.593306894545909*^9, 3.593306947967907*^9}, {
   3.593307021593033*^9, 3.593307045405577*^9}, {3.593307188093357*^9, 
   3.593307229155952*^9}, {3.593307279171674*^9, 3.593307292452937*^9}, 
   3.5933073312186375`*^9, {3.5933081523296185`*^9, 3.59330817618904*^9}, {
   3.593308267418319*^9, 3.5933082736016564`*^9}, {3.593315923622164*^9, 
   3.5933159382780046`*^9}, {3.5933168197730684`*^9, 
   3.5933168216324463`*^9}, {3.593323813988572*^9, 3.5933238240351477`*^9}, {
   3.5933238914260073`*^9, 3.5933238935921288`*^9}, {3.5933239491213083`*^9, 
   3.593323972929674*^9}, {3.5933339525151677`*^9, 3.5933339880012035`*^9}, {
   3.5933340470965867`*^9, 3.5933340765102863`*^9}, {3.593334110750232*^9, 
   3.5933341214288435`*^9}, {3.593334795098422*^9, 3.5933348078321524`*^9}, {
   3.5933622231000633`*^9, 3.593362279022049*^9}, {3.5933623168971214`*^9, 
   3.593362320209627*^9}, {3.5933624436473703`*^9, 3.593362477209938*^9}, {
   3.5933625091943865`*^9, 3.593362530897539*^9}, {3.5933632125082455`*^9, 
   3.5933632157582655`*^9}, {3.593364423377389*^9, 3.5933644268773923`*^9}, {
   3.593364590705837*^9, 3.593364591440215*^9}, {3.593365047941105*^9, 
   3.593365052894238*^9}, {3.5933650835193224`*^9, 3.5933651036912365`*^9}, {
   3.5933660950994043`*^9, 3.593366106427554*^9}, {3.5933661888964634`*^9, 
   3.5933661958339777`*^9}, {3.593367658625214*^9, 3.593367658718978*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Compiled Function", "Subsection",
 CellChangeTimes->{{3.5928665981813383`*^9, 3.5928666479001827`*^9}, {
  3.592869137147995*^9, 3.5928691902120333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "sure", " ", "no", " ", "calls", " ", "are", " ", "being", 
    " ", "made", " ", "to", " ", 
    RowBox[{"MainEvaluate", "[", "...", "]"}], " ", "beyond", " ", "the", " ",
     "call", " ", "to", " ", 
    RowBox[{"LinearSolve", "[", "]"}], " ", "and", " ", 
    RowBox[{"Inverse", "[", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetSystemOptions", "[", 
     RowBox[{"\"\<CompileOptions\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<CompileReportExternal\>\"", "\[Rule]", "True"}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FdF", " ", "=", " ", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dp", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
          "}"}], ",", " ", 
        RowBox[{
         RowBox[{"dp", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}],
          "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{"GetAccelerationFunction", "[", "\"\<FdF\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FdF", " ", "//", " ", "Chop"}], " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], "]"}],
      " ", "//", " ", "Chop"}], " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Norm", "[", 
    RowBox[{"FdF", " ", "-", " ", 
     RowBox[{"f", "[", 
      RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], 
      "]"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PdP", " ", "=", " ", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "dp", "\[LeftDoubleBracket]", "14", "\[RightDoubleBracket]"}], "}"}],
         ",", " ", 
        RowBox[{
         RowBox[{
         "dp", "\[LeftDoubleBracket]", "15", "\[RightDoubleBracket]"}], 
         "\[Transpose]"}]}], "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{"GetAccelerationFunction", "[", "\"\<All\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PdP", " ", "//", " ", "Chop"}], " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], "]"}],
      " ", "//", " ", "Chop"}], " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Norm", "[", 
    RowBox[{"PdP", " ", "-", " ", 
     RowBox[{"f", "[", 
      RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], 
      "]"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"how", " ", "fast", " ", "is", " ", 
     RowBox[{"it", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"runs", " ", "=", " ", "1000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"First", "[", 
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x0", ",", " ", "u0", ",", " ", "dx0", ",", " ", "du0"}], 
          "]"}], ",", " ", 
         RowBox[{"{", "runs", "}"}]}], "]"}], ";"}], "]"}], "]"}], "/", 
    "runs"}]}]}]], "Input",
 CellChangeTimes->{{3.5927875133858347`*^9, 3.5927875296897597`*^9}, {
   3.592787585057931*^9, 3.5927875886581373`*^9}, {3.592787850794151*^9, 
   3.5927878943976483`*^9}, {3.5927882616546755`*^9, 3.592788262133707*^9}, {
   3.592788732454641*^9, 3.5927887432942615`*^9}, 3.5927894576951694`*^9, {
   3.5927964779581966`*^9, 3.5927965350054665`*^9}, {3.5927966506780868`*^9, 
   3.5927966526542034`*^9}, {3.5927978247443247`*^9, 3.592797830368642*^9}, {
   3.592798232799689*^9, 3.5927982349348097`*^9}, {3.59280562805519*^9, 
   3.5928056362556715`*^9}, {3.592808394588812*^9, 3.592808396093899*^9}, {
   3.5928542678276043`*^9, 3.5928543197027197`*^9}, {3.5928544423279495`*^9, 
   3.5928545370000067`*^9}, {3.592854609328273*^9, 3.592854616281414*^9}, 
   3.5928654846831384`*^9, {3.5928688338006234`*^9, 3.5928688631513023`*^9}, {
   3.59286909488157*^9, 3.5928691350668736`*^9}, {3.5928691960173664`*^9, 
   3.5928692277821827`*^9}, 3.592869582569503*^9, {3.5928696484582715`*^9, 
   3.592869701657342*^9}, {3.5928697411445847`*^9, 3.592869766430029*^9}, {
   3.5928700155963006`*^9, 3.592870019842541*^9}, {3.5928700962229176`*^9, 
   3.5928700991920867`*^9}, {3.5928702422902803`*^9, 
   3.5928702583542027`*^9}, {3.592870291278088*^9, 3.5928703480353355`*^9}, {
   3.5933239855663958`*^9, 3.5933240756595583`*^9}, {3.5933310199832354`*^9, 
   3.593331028183699*^9}, {3.593334218401397*^9, 3.593334221147571*^9}, {
   3.5933619399901342`*^9, 3.593361942302638*^9}, {3.5933626409290085`*^9, 
   3.593362921585807*^9}, {3.5933629569608755`*^9, 3.593363032882897*^9}, {
   3.5933630850392513`*^9, 3.5933630943048925`*^9}, {3.5933636257039533`*^9, 
   3.5933636276102023`*^9}, {3.593363731563533*^9, 3.5933637466885643`*^9}, {
   3.593363970689*^9, 3.5933639947202997`*^9}, {3.5933640686891947`*^9, 
   3.593364077142333*^9}, {3.5933641500487394`*^9, 3.593364150642475*^9}, {
   3.593366306302944*^9, 3.59336630647482*^9}, {3.593366428459431*^9, 
   3.5933664398969536`*^9}, {3.5933664799126563`*^9, 
   3.5933664807876587`*^9}, {3.5933677493910165`*^9, 
   3.5933677805629525`*^9}, {3.5933678192505283`*^9, 
   3.5933678285005455`*^9}, {3.5933678692506266`*^9, 3.5933678732350082`*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{624, 887},
WindowMargins->{{Automatic, 2}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 128, 2, 86, "Section"],
Cell[710, 26, 2841, 52, 172, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3588, 83, 219, 3, 86, "Section"],
Cell[CellGroupData[{
Cell[3832, 90, 578, 9, 199, "Subsection"],
Cell[4413, 101, 69283, 1342, 3432, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73733, 1448, 165, 2, 49, "Subsection"],
Cell[73901, 1452, 5751, 124, 412, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
