(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     75196,       1680]
NotebookOptionsPosition[     74161,       1639]
NotebookOutlinePosition[     74538,       1655]
CellTagsIndexPosition[     74495,       1652]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", "\"\<EulerLagrange`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELSystem", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELSystem", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELTestModel", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELSystem", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELp", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELp", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELpdot", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELpdot", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELKE", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELKE", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELPE", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELPE", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELM", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELM", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELc", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELc", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELF", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELF", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELdF", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELdF", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELP", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELP", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELdP", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELdP", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELJ", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELJ", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELJdot", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELJdot", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELdJ", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELJ", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELdJdot", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELJdot", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "ELsteps", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"ELsteps", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"ValueQ", "[", "ELPostProcess", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"ELPostProcess", "::", "usage"}], " ", "=", " ", "\"\<\>\""}]}],
     "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"vp", ";"}], "\[IndentingNewLine]", 
 RowBox[{"pf", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckCapitalI]", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ELsteps", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<p\>\"", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"\"\<pdot\>\"", "\[Rule]", "2"}], ",", " ", 
     RowBox[{"\"\<\[DoubleStruckCapitalI]\>\"", "\[Rule]", " ", "3"}], ",", 
     " ", 
     RowBox[{"\"\<KE\>\"", "\[Rule]", " ", "4"}], ",", " ", 
     RowBox[{"\"\<PE\>\"", "\[Rule]", " ", "5"}], ",", " ", 
     RowBox[{"\"\<M\>\"", "\[Rule]", " ", "6"}], ",", " ", 
     RowBox[{"\"\<vp\>\"", "\[Rule]", " ", "7"}], ",", " ", 
     RowBox[{"\"\<pf\>\"", "\[Rule]", " ", "8"}], ",", " ", 
     RowBox[{"\"\<Xdot\>\"", "\[Rule]", " ", "9"}], ",", " ", 
     RowBox[{"\"\<dXdot\>\"", "\[Rule]", " ", "10"}], ",", " ", 
     RowBox[{"\"\<J\>\"", "\[Rule]", " ", "11"}], ",", " ", 
     RowBox[{"\"\<dJ\>\"", "\[Rule]", " ", "12"}], ",", " ", 
     RowBox[{"\"\<Jdot\>\"", "\[Rule]", " ", "13"}], ",", " ", 
     RowBox[{"\"\<dJdot\>\"", "\[Rule]", " ", "14"}], ",", " ", 
     RowBox[{"\"\<P\>\"", "\[Rule]", " ", "15"}], ",", " ", 
     RowBox[{"\"\<dP\>\"", "\[Rule]", " ", "16"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"postprocess", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"Identity", ",", " ", 
      RowBox[{"Length", "[", "ELsteps", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tests", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "TestMc", ",", " ", "TestQnt", ",", " ", "TestP", ",", " ", "TestF"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"run", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"True", ",", " ", "True", ",", " ", "False", ",", " ", "False"}],
      "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tests", "::", "err"}], " ", "=", " ", 
   "\"\<Number of tests does not equal the number of default run variables \
for calling TestModel, expect runtime errors.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "run", "]"}], " ", "\[NotEqual]", " ", 
     RowBox[{"Length", "[", "tests", "]"}]}], ",", " ", 
    RowBox[{"Message", "[", 
     RowBox[{"tests", "::", "err"}], "]"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.592241768075292*^9, 3.5922417692471714`*^9}, {3.592242084931059*^9, 
   3.5922420876966925`*^9}, 3.5922421309311514`*^9, {3.592255703284815*^9, 
   3.592255706497998*^9}, {3.59225574155902*^9, 3.592255745349224*^9}, {
   3.5922557821253295`*^9, 3.592255815751254*^9}, {3.5922559034172745`*^9, 
   3.5922559113667307`*^9}, {3.5922800860555387`*^9, 3.592280103747531*^9}, {
   3.59275716675933*^9, 3.5927571696474915`*^9}, 3.5927838101231008`*^9, {
   3.5933676479376955`*^9, 3.5933676483126965`*^9}, 3.602872256432743*^9, {
   3.603380915318615*^9, 3.603380918979824*^9}, {3.6033934025206985`*^9, 
   3.6033934257660294`*^9}, {3.6033935121569767`*^9, 
   3.6033936426374483`*^9}, {3.603393736610832*^9, 3.603393775319051*^9}, {
   3.603393809740019*^9, 3.6033938174874597`*^9}, {3.6033938475751886`*^9, 
   3.603393849271282*^9}, {3.603396761666065*^9, 3.6033967932868757`*^9}, {
   3.6033968367693663`*^9, 3.6033968888413477`*^9}, 3.6033970149915724`*^9, {
   3.6033970748119974`*^9, 3.603397090611913*^9}, {3.6033972258206453`*^9, 
   3.603397234531144*^9}, {3.603397592343635*^9, 3.603397593919722*^9}, {
   3.6034162078356824`*^9, 3.6034162094887786`*^9}, {3.60341734917204*^9, 
   3.6034173620797806`*^9}, {3.6034196224772243`*^9, 
   3.6034196603743925`*^9}, {3.603636091361239*^9, 3.6036361010331297`*^9}, {
   3.603761331516438*^9, 3.603761350813348*^9}, {3.6037649046985207`*^9, 
   3.603764909995405*^9}, {3.603765005933093*^9, 3.603765039620677*^9}, {
   3.603765363558796*^9, 3.6037654953559284`*^9}, {3.6037655300747623`*^9, 
   3.6037655305434985`*^9}, {3.603765807075285*^9, 3.6037658881535683`*^9}, {
   3.604792453371852*^9, 3.6047924668875036`*^9}, {3.6048425152070084`*^9, 
   3.6048425184882684`*^9}, {3.6048441256320376`*^9, 3.604844157616475*^9}, {
   3.6048442348756447`*^9, 3.604844245033226*^9}, {3.6048442769480543`*^9, 
   3.60484430497766*^9}, {3.6048447284219084`*^9, 3.604844732585147*^9}, {
   3.6048471105073223`*^9, 3.604847116259652*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Euler-Lagrange", "Section",
 CellChangeTimes->{{3.6027813283659725`*^9, 3.6027813805679736`*^9}, 
   3.603380884477849*^9, {3.603393874776743*^9, 3.603393874933749*^9}}],

Cell[CellGroupData[{

Cell["Helper Functions", "Subsection",
 CellChangeTimes->{{3.6033938855113583`*^9, 3.603393893972842*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createInertiaTensor", "[", "m_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "I", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"create", " ", "3", "x3", " ", "inertia", " ", "tensor"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"I", " ", "=", " ", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "#", "]"}], ",", " ", 
           RowBox[{"DiagonalMatrix", "[", "#", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"MatrixQ", "[", "#", "]"}], ",", "#", ",", 
           "\[IndentingNewLine]", "True", ",", " ", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0", ",", "#"}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"I", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "]"}], ",", " ", "0"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "}"}]}], "}"}], 
          "]"}], "&"}], " ", "/@", " ", "m"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", 
     RowBox[{"M_", ",", " ", "var_", ",", " ", "ind_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "j", ",", " ", "k"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "j", ",", " ", "k"}], "}"}], " ", "=", " ", 
        "ind"}], ";", " ", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"M", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "var", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "]"}], " ", "+", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"M", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "var", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
           "]"}], " ", "-", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"M", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "var", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           "]"}]}], ")"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VP", "[", 
     RowBox[{"M_", ",", " ", "X_", ",", " ", "nq_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalGamma]", "[", 
           RowBox[{"M", ",", " ", "X", ",", " ", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2", ",", "k"}], "}"}]}], "]"}], 
          RowBox[{"X", "\[LeftDoubleBracket]", 
           RowBox[{"k", "+", "nq"}], "\[RightDoubleBracket]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", "nq"}], "}"}]}], "]"}], "&"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"nq", ",", "nq"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"process", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"process", "[", 
    RowBox[{"expr_", ",", " ", "i_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pp", " ", "=", " ", 
       RowBox[{
       "postprocess", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
     RowBox[{"pp", "[", "expr", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.603395382663094*^9, 3.6033953927466717`*^9}, {
   3.603395695662019*^9, 3.6033956990352116`*^9}, {3.603395738759487*^9, 
   3.603395739181511*^9}, 3.603395871328096*^9, {3.603395937597873*^9, 
   3.603395941060075*^9}, {3.6033959794332876`*^9, 3.6033959952991776`*^9}, {
   3.603396044640003*^9, 3.603396095197896*^9}, {3.603396170691222*^9, 
   3.603396179170703*^9}, {3.6034071217403507`*^9, 3.6034071322069507`*^9}, {
   3.603407175545432*^9, 3.603407205923171*^9}, {3.603407236473921*^9, 
   3.603407238255023*^9}, {3.6034074176632943`*^9, 3.603407462035838*^9}, {
   3.603408454889695*^9, 3.6034085837770767`*^9}, {3.60340863047375*^9, 
   3.603408634231966*^9}, {3.6034102233139687`*^9, 3.603410226622157*^9}, 
   3.603410500250826*^9, 3.603410681073182*^9, {3.6034109125504513`*^9, 
   3.603410916033636*^9}, {3.6034109615722446`*^9, 3.6034109694826975`*^9}, {
   3.603411003491645*^9, 3.6034110154133277`*^9}, {3.603411178603675*^9, 
   3.603411320543801*^9}, {3.603411394873058*^9, 3.603411402999523*^9}, {
   3.6034114783858595`*^9, 3.6034115138038683`*^9}, {3.603411565450824*^9, 
   3.6034115655108294`*^9}, {3.603411909166508*^9, 3.6034119221502533`*^9}, 
   3.603416218237275*^9, {3.603417995910077*^9, 3.603418050192185*^9}, {
   3.6034181313928328`*^9, 3.6034181406413784`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Functions", "Subsection",
 CellChangeTimes->{{3.6033938855113583`*^9, 3.603393902797344*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ELSystem", "::", "ndof"}], " ", "=", " ", 
   "\"\<There are `1` mass parameters, but `2` spatial vectors.  The two must \
be equal.\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ELSystem", "[", 
     RowBox[{
     "nq_", ",", " ", "mass_", ",", "pcom_", ",", " ", "gravity_", ",", " ", 
      RowBox[{"cons_:", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", "}"}], "&"}], ")"}]}], ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", " ", "ret1", ",", " ", "ret2", ",", " ", "X", ",", " ", "U", 
        ",", " ", "xx", ",", " ", "uu", ",", " ", "g"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "mass", "]"}], " ", "\[NotEqual]", " ", 
          RowBox[{"Length", "[", "pcom", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"ELSystem", "::", "ndof"}], ",", " ", 
            RowBox[{"Length", "[", "mass", "]"}], ",", " ", 
            RowBox[{"Length", "[", "pcom", "]"}]}], "]"}], ";", " ", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", "0", "0"},
            {"0", "0", "0"},
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"},
            {"0", "0", "0"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "convert", " ", "from", " ", "3", "D", " ", "to", " ", "6", "D", " ", 
         "spatial", " ", "vectors"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        StyleBox[
         RowBox[{"Part", "::", "partd"}], "MessageName"], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        StyleBox[
         RowBox[{"Part", "::", "take"}], "MessageName"], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "xx", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
           "&"}], ",", " ", 
          RowBox[{"2", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"U", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "uu", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
           "&"}], ",", " ", "nq"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "gravity", "]"}], ",", " ", 
          RowBox[{"PadLeft", "[", 
           RowBox[{"gravity", ",", " ", "6"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "gravity", ",", "0"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "1"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "Null"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "Null"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"#", "[", "X", "]"}], "]"}], " ", "\[Equal]", " ", 
               "3"}], ",", " ", 
              RowBox[{"A", ".", 
               RowBox[{"#", "[", "X", "]"}]}], ",", " ", 
              RowBox[{"#", "[", "X", "]"}]}], "]"}], "&"}], " ", "/@", " ", 
           "pcom"}], ",", " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELp", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "2"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "p"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "Null"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", 
                RowBox[{"X", "\[LeftDoubleBracket]", 
                 RowBox[{";;", "nq"}], "\[RightDoubleBracket]"}], "}"}]}], 
              "]"}], ".", 
             RowBox[{"X", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"-", "nq"}], ";;"}], "\[RightDoubleBracket]"}]}], 
            "&"}], " ", "/@", " ", "ret1"}], ",", " ", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELpdot", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret2", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "3"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "p"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "pdot"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"createInertiaTensor", "[", "mass", "]"}], ",", "3"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "4"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "p"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "pdot"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"Total", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", ".", "#2", ".", "#1"}], "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"ret2", ",", " ", "\[DoubleStruckCapitalI]"}], "}"}]}],
              "]"}], "]"}]}], ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELKE", "[", "x_", "]"}], " ", ":=", "  ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret2", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "5"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "p"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "KE"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"mass", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], "*", 
            RowBox[{"(", 
             RowBox[{"ret1", ".", "g"}], ")"}]}], "]"}], ",", " ", "5"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELPE", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "6"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "PE"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "KE"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"ret2", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"-", "nq"}], ";;"}], "\[RightDoubleBracket]"}], ",", 
              " ", "2"}], "}"}]}], "]"}], ",", " ", "6"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELM", "[", "x_", "]"}], ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret2", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "7"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "PE"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "M"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VP", "[", 
            RowBox[{"ret2", ",", " ", "X", ",", " ", "nq"}], "]"}], ".", 
           RowBox[{"X", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "nq"}], ";;"}], "\[RightDoubleBracket]"}]}], ",", 
          " ", "7"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vp", "[", "x_", "]"}], " ", ":=", "  ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret2", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "8"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "PE"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "vp"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"ret1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"X", "\[LeftDoubleBracket]", 
              RowBox[{";;", "nq"}], "\[RightDoubleBracket]"}], "}"}]}], "]"}],
           ",", " ", "8"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pf", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELc", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ret1", "+", "ret2"}], ")"}], " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "9"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "pf"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "vp"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"ret1", "+", "ret2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"ELM", "[", "X", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"ret2", ".", 
           RowBox[{"(", 
            RowBox[{"U", "-", " ", "ret1"}], ")"}]}], ",", " ", "9"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELF", "[", 
         RowBox[{"x_", ",", " ", "u_"}], "]"}], ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xx", "\[Rule]", " ", "x"}], ",", " ", 
            RowBox[{"uu", "\[Rule]", " ", "u"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "10"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "F"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", 
          RowBox[{"Inverse", "[", "M", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"ret1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{"X", ",", "U"}], "]"}], "}"}]}], "]"}], ",", " ", 
          "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELdF", "[", 
         RowBox[{"x_", ",", " ", "u_"}], "]"}], ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xx", "\[Rule]", " ", "x"}], ",", " ", 
            RowBox[{"uu", "\[Rule]", " ", "u"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "11"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "dF"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", 
          RowBox[{"Inverse", "[", "M", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"cons", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{"A", ",", " ", "11"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELJ", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "12"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "J"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", 
          RowBox[{"Inverse", "[", "M", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ELJ", "[", "X", "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{"X", ",", " ", "U"}], "]"}], "}"}]}], "]"}], ",", " ", 
          "12"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELdJ", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "13"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "dJ"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", 
          RowBox[{"Inverse", "[", "M", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"A", " ", "\[Equal]", " ", 
             RowBox[{"{", "}"}]}], ",", " ", "A", ",", " ", 
            RowBox[{
             RowBox[{"X", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"-", "nq"}], ";;"}], "\[RightDoubleBracket]"}], ".", 
             RowBox[{
              RowBox[{"ret1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "All", ",", 
                RowBox[{";;", "nq"}]}], "\[RightDoubleBracket]"}], 
              "\[Transpose]"}]}]}], "]"}], ",", " ", "13"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELJdot", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "14"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "Jdot"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", 
          RowBox[{"Inverse", "[", "M", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ELJdot", "[", "X", "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{"X", ",", "U"}], "]"}], "}"}]}], "]"}], ",", " ", 
          "14"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELdJdot", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret1", " ", "/.", " ", 
          RowBox[{"xx", "\[Rule]", " ", "x"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "15"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", "dJdot"}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", 
          RowBox[{"Inverse", "[", "M", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret1", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"A", " ", "\[Equal]", " ", 
           RowBox[{"{", "}"}]}], ",", " ", "A", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ELJdot", "[", "X", "]"}], ".", 
            RowBox[{"X", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"-", "nq"}], ";;"}], "\[RightDoubleBracket]"}]}], " ", 
           "+", " ", 
           RowBox[{
            RowBox[{"ELJ", "[", "X", "]"}], ".", 
            RowBox[{"ELF", "[", 
             RowBox[{"X", ",", " ", "U"}], "]"}]}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"NLinks", " ", "uses", " ", "PseudoInverse"}], ",", " ", 
         RowBox[{
         "but", " ", "it", " ", "can", " ", "take", " ", "forever", " ", "to",
           " ", "compute"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"A", " ", "\[Equal]", " ", 
             RowBox[{"{", "}"}]}], ",", " ", "A", ",", " ", 
            RowBox[{
             RowBox[{"ELF", "[", 
              RowBox[{"X", ",", " ", "U"}], "]"}], " ", "-", " ", 
             RowBox[{"ret2", ".", 
              RowBox[{"A", "\[Transpose]"}], ".", 
              RowBox[{"Inverse", "[", 
               RowBox[{"A", ".", "ret2", ".", 
                RowBox[{"A", "\[Transpose]"}]}], "]"}], ".", "ret1"}]}]}], 
           "]"}], ",", " ", "15"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELP", "[", 
         RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret2", " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xx", " ", "\[Rule]", " ", "x"}], ",", " ", 
            RowBox[{"uu", "\[Rule]", " ", "u"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "16"}], ",", " ", 
         RowBox[{"ret1", " ", "=", " ", 
          RowBox[{
           RowBox[{"Jdot", ".", "qdot"}], " ", "+", " ", 
           RowBox[{"J", ".", "F"}]}]}], ",", " ", 
         RowBox[{"ret2", " ", "=", " ", "P"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ret2", " ", "=", " ", 
        RowBox[{"process", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"ret2", ",", " ", 
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{"X", ",", "U"}], "]"}], "}"}]}], "]"}], ",", " ", 
          "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELdP", "[", 
         RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ret2", " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xx", " ", "\[Rule]", " ", "x"}], ",", " ", 
            RowBox[{"uu", " ", "\[Rule]", " ", "u"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "partd"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"On", "[", 
        RowBox[{"Part", "::", "take"}], "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ELPostProcess", "[", "pp_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ppnew", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ppnew", " ", "=", " ", 
       RowBox[{"pp", " ", "/.", " ", "ELsteps"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"postprocess", "\[LeftDoubleBracket]", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ")"}], "&"}], ",", " ", "ppnew"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.602771354855214*^9, 3.6027715399180803`*^9}, {
   3.602772090161942*^9, 3.6027721053577957`*^9}, {3.602772144060013*^9, 
   3.6027722096047688`*^9}, {3.602772300581979*^9, 3.6027723486707325`*^9}, {
   3.6027723902361107`*^9, 3.602772461242179*^9}, {3.60277249314001*^9, 
   3.60277265759142*^9}, {3.602772692828441*^9, 3.602772767587723*^9}, {
   3.6027728035797834`*^9, 3.602773068437951*^9}, {3.602773104991056*^9, 
   3.602773131446559*^9}, {3.6027731952942204`*^9, 3.602773201396578*^9}, {
   3.602773247262192*^9, 3.6027733927575235`*^9}, {3.6027734386271505`*^9, 
   3.602773473432145*^9}, {3.602773529710368*^9, 3.602773532875548*^9}, {
   3.6027736409987397`*^9, 3.6027736792479324`*^9}, {3.602773732667985*^9, 
   3.602773772298272*^9}, {3.6027738067182302`*^9, 3.6027738360859118`*^9}, {
   3.6027738955923147`*^9, 3.6027739133893385`*^9}, {3.602773949887426*^9, 
   3.6027740525393076`*^9}, {3.6027740900634565`*^9, 3.602774123191353*^9}, {
   3.6027741786165276`*^9, 3.6027742253862057`*^9}, {3.6027743446040325`*^9, 
   3.6027743493453083`*^9}, {3.602774379677041*^9, 3.60277438437531*^9}, 
   3.60277442196346*^9, {3.6027745169319105`*^9, 3.6027745281795454`*^9}, {
   3.6027745978085327`*^9, 3.60277461831671*^9}, {3.602774652301653*^9, 
   3.6027746709417396`*^9}, {3.6027747729415803`*^9, 3.602774894674533*^9}, {
   3.602774931033616*^9, 3.602774957762146*^9}, {3.602774989196966*^9, 
   3.602775027811158*^9}, {3.6027751540993867`*^9, 3.6027751565875297`*^9}, {
   3.602775778500166*^9, 3.6027757803672543`*^9}, {3.602775896430908*^9, 
   3.6027759111767454`*^9}, {3.6027759521430883`*^9, 
   3.6027759756244326`*^9}, {3.602776032311679*^9, 3.602776032540696*^9}, {
   3.6027761150904226`*^9, 3.60277617393979*^9}, {3.602776333461928*^9, 
   3.60277633442098*^9}, {3.6027766502930713`*^9, 3.602776701867025*^9}, {
   3.60277674769665*^9, 3.602776875583973*^9}, {3.602777010516698*^9, 
   3.6027770259715853`*^9}, {3.6027772111911917`*^9, 3.602777256792829*^9}, {
   3.602777322011539*^9, 3.6027773297439795`*^9}, {3.602778136988209*^9, 
   3.6027781505539837`*^9}, {3.6027783139443436`*^9, 3.602778327867141*^9}, {
   3.6027783770759583`*^9, 3.60277840678966*^9}, {3.60277844205768*^9, 
   3.602778474751552*^9}, {3.6027785290946646`*^9, 3.6027785351410103`*^9}, {
   3.602778568535923*^9, 3.6027785695019817`*^9}, {3.6027787154033327`*^9, 
   3.602778728627091*^9}, {3.6027788161621037`*^9, 3.602778818005209*^9}, {
   3.60277905903901*^9, 3.6027791054926724`*^9}, {3.602779250887024*^9, 
   3.6027792993497744`*^9}, {3.6027793471225133`*^9, 
   3.6027794131912937`*^9}, {3.602779444724115*^9, 3.6027794455961485`*^9}, {
   3.6027795990669374`*^9, 3.6027796181080284`*^9}, {3.6027796607384696`*^9, 
   3.602779687722015*^9}, {3.6027798074788723`*^9, 3.6027799566174326`*^9}, {
   3.6027799882922416`*^9, 3.6027800479126415`*^9}, {3.60278022757593*^9, 
   3.6027803222143497`*^9}, {3.602781054624293*^9, 3.60278114171828*^9}, 
   3.602781346299999*^9, {3.602781416154996*^9, 3.6027814357141137`*^9}, {
   3.602808329093297*^9, 3.602808442999769*^9}, {3.6028140732343225`*^9, 
   3.6028142242502446`*^9}, {3.6028142849691257`*^9, 
   3.6028142920628815`*^9}, {3.602814650904155*^9, 3.6028146531513042`*^9}, {
   3.6028223089124584`*^9, 3.6028223348968706`*^9}, {3.6028224942409325`*^9, 
   3.6028225415535245`*^9}, {3.6033809594641466`*^9, 3.603380959748159*^9}, {
   3.603380989773878*^9, 3.6033810836912575`*^9}, 3.603381122273466*^9, {
   3.603381171699297*^9, 3.603381216429858*^9}, {3.603381323583995*^9, 
   3.6033813242810345`*^9}, {3.6033813582089815`*^9, 3.6033815364682055`*^9}, 
   3.6033816035110226`*^9, {3.6033816358428745`*^9, 3.6033818117709527`*^9}, {
   3.6033851340424356`*^9, 3.6033851352299376`*^9}, {3.603385176636269*^9, 
   3.603385181401904*^9}, {3.603385327495936*^9, 3.603385343730343*^9}, {
   3.603385421480511*^9, 3.603385454683688*^9}, {3.6033855197931905`*^9, 
   3.603385710418564*^9}, {3.6033857759499416`*^9, 3.603385812965638*^9}, {
   3.6033858612157345`*^9, 3.6033858630751123`*^9}, {3.6033858953876896`*^9, 
   3.6033860957318172`*^9}, {3.6033869276719065`*^9, 
   3.6033869346443057`*^9}, {3.6033870067004504`*^9, 3.603387030452792*^9}, {
   3.6033874580812807`*^9, 3.6033875110143123`*^9}, {3.6033879381137705`*^9, 
   3.603387945487193*^9}, {3.6033881050203285`*^9, 3.6033881955295115`*^9}, {
   3.603388225961255*^9, 3.6033883154553795`*^9}, {3.6033884106938334`*^9, 
   3.603388411566884*^9}, {3.6033885638006015`*^9, 3.6033885725841045`*^9}, {
   3.6033886107112875`*^9, 3.603388671336757*^9}, {3.603388707707843*^9, 
   3.603388712018091*^9}, {3.6033887926777077`*^9, 3.603388806081476*^9}, {
   3.6033888821318316`*^9, 3.6033889150237336`*^9}, {3.6033889471615553`*^9, 
   3.6033890002225943`*^9}, {3.6033890394158382`*^9, 3.603389088262636*^9}, {
   3.6033891338952484`*^9, 3.6033892143048534`*^9}, {3.6033892824947586`*^9, 
   3.603389369629745*^9}, {3.603389404647754*^9, 3.603389413889283*^9}, {
   3.603389502058337*^9, 3.603389523004532*^9}, 3.603389596668751*^9, {
   3.6033896376280923`*^9, 3.6033898025655413`*^9}, {3.6033898443809357`*^9, 
   3.603389918187162*^9}, {3.603390053413906*^9, 3.6033900564820833`*^9}, {
   3.6033901161755047`*^9, 3.6033901180776095`*^9}, {3.603390159212963*^9, 
   3.603390227931901*^9}, {3.603390291763556*^9, 3.6033902998570194`*^9}, {
   3.603390347423741*^9, 3.60339038489989*^9}, {3.6033904183148007`*^9, 
   3.6033904299514694`*^9}, {3.603390460542222*^9, 3.6033904687076893`*^9}, {
   3.603390510501086*^9, 3.603390510830105*^9}, {3.6033905777449303`*^9, 
   3.6033908367317643`*^9}, {3.603390879273201*^9, 3.6033909021095085`*^9}, {
   3.603390952014366*^9, 3.603391009664668*^9}, {3.603391049519948*^9, 
   3.603391070361144*^9}, {3.6033911875048513`*^9, 3.603391189824985*^9}, 
   3.603391264500261*^9, {3.603391317973324*^9, 3.6033913397255692`*^9}, {
   3.603391438957257*^9, 3.6033914478747625`*^9}, {3.603391487732046*^9, 
   3.603391517794767*^9}, {3.603391640052767*^9, 3.603391643800984*^9}, {
   3.603391679405021*^9, 3.60339173753235*^9}, {3.603391798526852*^9, 
   3.6033918120156217`*^9}, {3.603391860530394*^9, 3.6033918699099493`*^9}, {
   3.6033919239970245`*^9, 3.603391974376927*^9}, {3.6033920043836327`*^9, 
   3.603392053905468*^9}, {3.603392112629831*^9, 3.6033921338770475`*^9}, {
   3.6033922658186035`*^9, 3.6033923412119207`*^9}, {3.603392417752304*^9, 
   3.6033924196264114`*^9}, {3.6033924676851635`*^9, 3.60339251145667*^9}, {
   3.6033925828977613`*^9, 3.6033926048200164`*^9}, {3.6033926611992455`*^9, 
   3.6033928184072485`*^9}, {3.6033928966257315`*^9, 
   3.6033929453425274`*^9}, {3.603392983892725*^9, 3.6033930208528366`*^9}, {
   3.60339305819298*^9, 3.6033930782381473`*^9}, {3.6033931172833652`*^9, 
   3.6033931186574435`*^9}, {3.603393157309656*^9, 3.603393158845744*^9}, {
   3.6033931946667995`*^9, 3.6033933415552073`*^9}, {3.603393467421415*^9, 
   3.6033934848154087`*^9}, {3.6033936819677052`*^9, 3.603393819221561*^9}, {
   3.6033939155590787`*^9, 3.603393917133177*^9}, {3.603394503237728*^9, 
   3.603394566660364*^9}, {3.603394679177808*^9, 3.603394789858146*^9}, 
   3.6033948478224792`*^9, 3.6033948838005266`*^9, {3.6033949556196384`*^9, 
   3.603395019325287*^9}, {3.603395212999378*^9, 3.603395215442518*^9}, {
   3.60339545103401*^9, 3.6033954727072477`*^9}, {3.6033955156047087`*^9, 
   3.6033955428172646`*^9}, {3.603396118532236*^9, 3.603396118858254*^9}, {
   3.603396647168508*^9, 3.603396711276179*^9}, {3.6033969405203075`*^9, 
   3.6033969409233303`*^9}, {3.603396971431077*^9, 3.603396980711609*^9}, {
   3.603397109871006*^9, 3.603397189805581*^9}, {3.6033972485259457`*^9, 
   3.6033974111982613`*^9}, {3.6033974590270004`*^9, 
   3.6033974969621725`*^9}, {3.603397813364295*^9, 3.603398079017505*^9}, {
   3.603398167103549*^9, 3.6033982343634014`*^9}, {3.6033982698264313`*^9, 
   3.6033982727455997`*^9}, {3.6033985877916403`*^9, 3.603398590755824*^9}, {
   3.6033986570836086`*^9, 3.603398659565751*^9}, {3.603407264494526*^9, 
   3.6034073909417667`*^9}, {3.603407490156448*^9, 3.6034076545648637`*^9}, {
   3.6034092222716417`*^9, 3.603409296083868*^9}, {3.603409555332714*^9, 
   3.603409557218822*^9}, 3.6034099554226265`*^9, {3.6034108795435467`*^9, 
   3.603410882377709*^9}, {3.603412303905115*^9, 3.6034123443104477`*^9}, {
   3.603412374328148*^9, 3.6034124944720287`*^9}, {3.6034125896964817`*^9, 
   3.603412591907608*^9}, {3.6034127461004376`*^9, 3.603412771731907*^9}, {
   3.60341312227398*^9, 3.6034131242460933`*^9}, {3.603413203720645*^9, 
   3.603413233255336*^9}, {3.6034133247905817`*^9, 3.6034133250335913`*^9}, {
   3.6034133939975605`*^9, 3.603413418722957*^9}, {3.603413451143813*^9, 
   3.6034134746591573`*^9}, {3.6034135322834606`*^9, 3.603413625279786*^9}, {
   3.603413688616413*^9, 3.6034137038692865`*^9}, {3.603413761288574*^9, 
   3.6034137920683365`*^9}, {3.603413827950396*^9, 3.6034138889648857`*^9}, {
   3.6034139281811347`*^9, 3.6034139291812077`*^9}, {3.6034139654972687`*^9, 
   3.603413984462354*^9}, {3.603414064113912*^9, 3.6034141103535643`*^9}, {
   3.6034141467636676`*^9, 3.603414152430977*^9}, {3.603414252255691*^9, 
   3.6034142889527917`*^9}, {3.603414335429472*^9, 3.6034144048574286`*^9}, {
   3.60341444292861*^9, 3.6034144462037973`*^9}, {3.6034146442791405`*^9, 
   3.6034146660173936`*^9}, {3.6034147000083323`*^9, 3.603414792463626*^9}, {
   3.6034148731092477`*^9, 3.6034149485895667`*^9}, {3.603414981214435*^9, 
   3.6034149922400675`*^9}, {3.603415078291995*^9, 3.6034150787040186`*^9}, {
   3.603415136658333*^9, 3.603415165391994*^9}, {3.603415571322228*^9, 
   3.603415599913866*^9}, {3.603415645542479*^9, 3.6034156561480865`*^9}, {
   3.603415913495826*^9, 3.6034160065701694`*^9}, 3.6034161153513875`*^9, {
   3.6034161578428345`*^9, 3.603416158454871*^9}, {3.603416231528036*^9, 
   3.6034162348382263`*^9}, {3.6034162724203777`*^9, 
   3.6034163356920013`*^9}, {3.6034165179574394`*^9, 
   3.6034165195225286`*^9}, {3.6034166592915363`*^9, 
   3.6034166823908567`*^9}, {3.6034167184999256`*^9, 3.603416761540388*^9}, {
   3.6034171177147827`*^9, 3.6034171191988707`*^9}, {3.6034171521977606`*^9, 
   3.603417200290515*^9}, {3.6034172603499537`*^9, 3.6034172643071847`*^9}, {
   3.603417305705552*^9, 3.603417340895585*^9}, {3.603417408063408*^9, 
   3.6034174459625826`*^9}, {3.6034175411540346`*^9, 
   3.6034175429211397`*^9}, {3.603417576712075*^9, 3.603417901378663*^9}, {
   3.6034180866262693`*^9, 3.603418106718423*^9}, {3.6034181813446956`*^9, 
   3.603418238831007*^9}, {3.603418274017*^9, 3.6034182929290857`*^9}, {
   3.603418513431716*^9, 3.60341876500412*^9}, {3.6034188849469852`*^9, 
   3.6034189039580774`*^9}, {3.6034189359129066`*^9, 3.603419000747618*^9}, {
   3.6034191636789513`*^9, 3.6034191793368473`*^9}, {3.603419483760276*^9, 
   3.603419514943066*^9}, {3.6034195594856167`*^9, 3.603419578045678*^9}, {
   3.603635296484686*^9, 3.6036353195472307`*^9}, {3.6036354038598957`*^9, 
   3.603635426469314*^9}, {3.60363552920389*^9, 3.6036355310632725`*^9}, {
   3.6036355708289714`*^9, 3.603635571203972*^9}, {3.6036360594549246`*^9, 
   3.6036360806893435`*^9}, {3.603755250909111*^9, 3.603755283862301*^9}, {
   3.604789484397304*^9, 3.604789557084938*^9}, {3.6047896053194075`*^9, 
   3.6047896245538197`*^9}, 3.604789665350775*^9, {3.604789704647731*^9, 
   3.6047897243508897`*^9}, {3.604789785897886*^9, 3.604789786757275*^9}, {
   3.604789825429212*^9, 3.6047898270229654`*^9}, {3.6047899067887473`*^9, 
   3.604789962820106*^9}, {3.6047900485233994`*^9, 3.604790124429797*^9}, {
   3.604790167679886*^9, 3.6047901700861363`*^9}, {3.604790399039709*^9, 
   3.604790399305333*^9}, {3.604790513211826*^9, 3.6047905137274413`*^9}, {
   3.604790790540475*^9, 3.6047908227905397`*^9}, 3.6047908918375483`*^9, {
   3.604790965822089*^9, 3.6047910142128057`*^9}, {3.6047910586816206`*^9, 
   3.6047910591191444`*^9}, {3.6047912705101633`*^9, 3.604791283572689*^9}, {
   3.604791473057435*^9, 3.604791486479336*^9}, {3.6047916361202536`*^9, 
   3.6047916368546314`*^9}, {3.604792509653226*^9, 3.604792586684615*^9}, {
   3.6047926286534452`*^9, 3.6047926552003717`*^9}, {3.6048421862844896`*^9, 
   3.6048422273470764`*^9}, {3.604842263581523*^9, 3.6048423878786373`*^9}, 
   3.6048424578162737`*^9, {3.6048424992538557`*^9, 3.60484250466012*^9}, {
   3.604842551472706*^9, 3.604842564128981*^9}, {3.6048425963634405`*^9, 
   3.604842601660304*^9}, {3.604842700707372*^9, 3.6048427655356255`*^9}, {
   3.6048428059575806`*^9, 3.6048428084263487`*^9}, {3.6048428601608124`*^9, 
   3.6048429102702913`*^9}, {3.604842971332903*^9, 3.6048429880204396`*^9}, {
   3.604843037489298*^9, 3.6048430463018136`*^9}, {3.6048431343176117`*^9, 
   3.6048431427238827`*^9}, {3.604843199380226*^9, 3.6048432059114866`*^9}, {
   3.6048433140210886`*^9, 3.6048433324898605`*^9}, {3.6048433700055585`*^9, 
   3.6048434264275446`*^9}, {3.6048436768030396`*^9, 3.604843770787593*^9}, {
   3.6048438706315393`*^9, 3.6048438817721834`*^9}, {3.6048439886317825`*^9, 
   3.604843992819276*^9}, {3.6048440362412357`*^9, 3.6048440803975906`*^9}, {
   3.604844211266294*^9, 3.6048442135534244`*^9}, {3.6048456792933617`*^9, 
   3.6048456881378665`*^9}, {3.604846812299245*^9, 3.6048468249459705`*^9}, {
   3.6048468748918295`*^9, 3.6048469746175404`*^9}, 3.6048477570913506`*^9, {
   3.6048478465554733`*^9, 3.604847872639971*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Test Euler-Lagrange with NLinks\
\>", "Section",
 CellChangeTimes->{{3.6028005564911757`*^9, 3.6028005569755673`*^9}, 
   3.602800616022543*^9, {3.602800660178879*^9, 3.602800710850868*^9}, {
   3.603756704568203*^9, 3.6037567089900894`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", 
    RowBox[{"{", 
     RowBox[{"t_", ",", " ", "a_", ",", " ", "b_"}], "}"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "f"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", " ", "-", " ", "b"}], ")"}], " ", "//", " ", 
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Norm", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "n", "]"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"N", "@", "n"}], ",", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "6"}]}]}], "]"}], " ", "\[Equal]", " ", "0"}]}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Success! \>\"", " ", "<>", " ", "t", " ", "<>", " ", 
          "\"\< are equal.\>\""}], "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Nooooo... \>\"", " ", "<>", " ", "t", " ", "<>", " ", 
          "\"\< are not equal.\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Simplify", "@", "a"}], ",", " ", 
        RowBox[{"Simplify", "@", "b"}], ",", " ", "n"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ELTestModel", "::", "tests"}], " ", "=", " ", 
    "\"\<The number of tests available `1` does not equal the number you want \
to run `2`.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ELTestModel", "::", "der"}], " ", "=", " ", 
    "\"\<Tests that require derivatives will not work properly unless n\
\[Lambda] equals 3 nq.  Calling SetModel with the optional derivative \
argument set to All resolves the issue.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ELTestModel", "[", 
     RowBox[{"x_", ",", " ", "u_", ",", " ", 
      RowBox[{"run_:", "run"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", " ", "r"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"run", " ", "===", " ", "All"}], ",", "\[IndentingNewLine]", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"True", ",", " ", 
            RowBox[{"Length", "[", "tests", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", " ", "=", " ", "run"}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NLink`Private`n\[Lambda]", " ", "\[NotEqual]", " ", 
          RowBox[{"3", "NLink`Private`nq"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"ELTestModel", "::", "der"}], ",", " ", 
            "NLink`Private`n\[Lambda]", ",", " ", 
            RowBox[{"3", " ", "NLink`Private`nq"}]}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "r", "]"}], " ", "\[NotEqual]", " ", 
          RowBox[{"Length", "[", "tests", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ELTestModel", "::", "tests"}], ",", " ", 
           RowBox[{"Length", "[", "tests", "]"}], ",", " ", 
           RowBox[{"Length", "[", "r", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", " ", "=", " ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"#1", ",", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Running \>\"", ",", " ", "#2"}], "]"}], ";", 
               RowBox[{"#2", "[", 
                RowBox[{"x", ",", " ", "u"}], "]"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Skipping \>\"", ",", " ", "#2"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "&"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"MapThread", "[", 
           RowBox[{"f", ",", " ", 
            RowBox[{"{", 
             RowBox[{"r", ",", " ", "tests"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TestMc", "[", 
    RowBox[{"x_", ",", " ", 
     RowBox[{"u_:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NM", ",", " ", "M", ",", " ", "NC", ",", " ", "c"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NLink`Private`Fcrb", "[", 
       RowBox[{"x", ",", " ", "NLink`Private`znq"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NM", " ", "=", " ", 
       RowBox[{"NLink`Private`Mx", "[", 
        RowBox[{"NLink`Private`M", ",", " ", 
         RowBox[{"IdentityMatrix", "[", "NLink`Private`nq", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"ELM", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NC", " ", "=", " ", "NLink`Private`uJ"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"ELc", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"test", " ", "/@", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<M's\>\"", ",", " ", "M", ",", " ", "NM"}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"\"\<c's\>\"", ",", " ", "c", ",", " ", "NC"}], "}"}]}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TestQnt", "[", 
    RowBox[{"x_", ",", " ", 
     RowBox[{"u_:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Nqnt", ",", " ", "pcom", ",", " ", "PE", ",", " ", "KE"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Nqnt", " ", "=", " ", 
       RowBox[{"NLink`Private`MechanicalQuantities", "[", "x", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pcom", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "6", ",", "6"}], 
           "\[RightDoubleBracket]"}], "*", 
          RowBox[{
           RowBox[{"ELp", "[", "x", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", 
            RowBox[{"4", ";;", "6"}]}], "\[RightDoubleBracket]"}]}], "]"}], 
        "/", 
        RowBox[{"Total", "[", 
         RowBox[{"\[DoubleStruckCapitalI]", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "6", ",", "6"}], "\[RightDoubleBracket]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"KE", " ", "=", " ", 
       RowBox[{"ELKE", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PE", " ", "=", " ", 
       RowBox[{"ELPE", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"test", " ", "/@", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<KE's\>\"", ",", " ", "KE", ",", " ", 
           RowBox[{
           "Nqnt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<PE's\>\"", ",", " ", "PE", ",", " ", 
           RowBox[{
           "Nqnt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<com's\>\"", ",", " ", "pcom", ",", " ", 
           RowBox[{"Nqnt", "\[LeftDoubleBracket]", 
            RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TestP", "[", 
     RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "qd", ",", " ", "dx", ",", " ", "du", ",", " ", "NF", ",", " ", "F", 
        ",", " ", "NJ", ",", " ", "J", ",", " ", "NJdot", ",", " ", "Jdot", 
        ",", " ", "NP", ",", " ", "P", ",", " ", "NdF", ",", " ", "dF", ",", 
        " ", "NdJ", ",", " ", "dJ", ",", " ", "NdJdot", ",", " ", "dJdot", 
        ",", " ", "NdP", ",", " ", "dP"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "NLink`Private`nq"}], ";;"}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dx", " ", "=", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"NLink`Private`nx", ",", " ", "NLink`Private`n\[Lambda]"}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"du", " ", "=", " ", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "NLink`Private`nq", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"NLink`Private`nq", ",", " ", "NLink`Private`n\[Lambda]"}],
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", " ", "=", " ", 
        RowBox[{"NLink`Private`Fcrb", "[", 
         RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NdF", " ", "=", " ", 
        RowBox[{"NLink`Private`dFcrb", "[", 
         RowBox[{"x", ",", " ", "u", ",", " ", "dx", ",", " ", "du"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NP", " ", "=", " ", 
        RowBox[{"NLink`Private`P", "[", 
         RowBox[{"x", ",", " ", "NF"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NdP", " ", "=", " ", 
        RowBox[{"NLink`Private`dP", "[", 
         RowBox[{"x", ",", " ", "dx", ",", " ", "NF", ",", " ", "NdF"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NJ", " ", "=", " ", "NLink`Private`J"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NJdot", " ", "=", " ", "NLink`Private`Jdot"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NdJ", " ", "=", " ", 
        RowBox[{"NLink`Private`dXb", "[", 
         RowBox[{"NLink`Private`dJ", ",", " ", "qd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NdJdot", " ", "=", " ", 
        RowBox[{"NLink`Private`dXb", "[", 
         RowBox[{"NLink`Private`dJdot", ",", " ", "qd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"F", " ", "=", " ", 
        RowBox[{"ELF", "[", 
         RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dF", " ", "=", " ", 
        RowBox[{"ELdF", "[", 
         RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"ELP", "[", 
         RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        RowBox[{"ELJ", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jdot", " ", "=", " ", 
        RowBox[{"ELJdot", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dP", " ", "=", " ", 
        RowBox[{"ELdP", "[", 
         RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dJ", " ", "=", " ", 
        RowBox[{"NLink`Private`dXb", "[", 
         RowBox[{
          RowBox[{"ELdJ", "[", "x", "]"}], ",", " ", "qd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dJdot", " ", "=", " ", 
        RowBox[{"NLink`Private`dXb", "[", 
         RowBox[{
          RowBox[{"ELdJdot", "[", "x", "]"}], ",", " ", "qd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"test", " ", "/@", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<F's\>\"", ",", " ", "F", ",", " ", "NF"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"\"\<dF's\>\"", ",", " ", "dF", ",", " ", "NdF"}], "}"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<J's\>\"", ",", " ", "J", ",", " ", "NJ"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"\"\<dJ's\>\"", ",", " ", "dJ", ",", " ", "NdJ"}], "}"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Jdot's\>\"", ",", " ", "Jdot", ",", " ", "NJdot"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<dJdot's\>\"", ",", " ", "dJdot", ",", " ", "NdJdot"}],
            "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<P's\>\"", ",", " ", "P", ",", " ", "NP"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"\"\<dP's\>\"", ",", " ", "dP", ",", " ", "NdP"}], "}"}]}],
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TestF", "[", 
    RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dx", ",", " ", "du", ",", " ", "NFaba", ",", " ", "NFcrb", ",", " ", 
       "F", ",", " ", "NdFaba", ",", " ", "NdFcrb", ",", " ", "dF"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", " ", "=", " ", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"NLink`Private`nx", ",", " ", "NLink`Private`n\[Lambda]"}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"du", " ", "=", " ", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "NLink`Private`nq", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"NLink`Private`nq", ",", " ", "NLink`Private`n\[Lambda]"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NFaba", " ", "=", " ", 
       RowBox[{"NLink`Private`Faba", "[", 
        RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NFcrb", " ", "=", " ", 
       RowBox[{"NLink`Private`Fcrb", "[", 
        RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NdFcrb", " ", "=", " ", 
       RowBox[{"NLink`Private`dFcrb", "[", 
        RowBox[{"x", ",", " ", "u", ",", " ", "dx", ",", " ", "du"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"F", " ", "=", " ", 
       RowBox[{"ELF", "[", 
        RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dF", " ", "=", " ", 
       RowBox[{"ELdF", "[", 
        RowBox[{"x", ",", " ", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"test", " ", "/@", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<F's using ABA\>\"", ",", " ", "F", ",", " ", "NFaba"}],
           "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<F's using CRB\>\"", ",", " ", "F", ",", " ", "NFcrb"}],
           "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<dF's using CRB\>\"", ",", " ", "dF", ",", " ", "NdFcrb"}], 
          "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6037555901597743`*^9, 3.60375565014427*^9}, {
   3.6037556956912456`*^9, 3.6037558554415426`*^9}, {3.60375589583226*^9, 
   3.603756134863965*^9}, {3.6037561976297264`*^9, 3.6037563529425173`*^9}, {
   3.6037563847238235`*^9, 3.603756390145713*^9}, {3.6037564326457987`*^9, 
   3.6037564623958573`*^9}, {3.603756498864682*^9, 3.6037565949898643`*^9}, {
   3.6037566255992985`*^9, 3.6037566443024607`*^9}, {3.6037567491932898`*^9, 
   3.603756983287498*^9}, {3.603757053647011*^9, 3.6037570539595118`*^9}, {
   3.6037571131940036`*^9, 3.6037572626317945`*^9}, {3.60375730392875*^9, 
   3.603757335006936*^9}, {3.6037573709757586`*^9, 3.6037573731632633`*^9}, {
   3.603757632695019*^9, 3.603757635413776*^9}, {3.6037576687419653`*^9, 
   3.603757716476435*^9}, {3.603757757476514*^9, 3.6037577982734675`*^9}, {
   3.603757839445424*^9, 3.6037578487110653`*^9}, {3.603757884914262*^9, 
   3.6037579063830495`*^9}, {3.6037579556331496`*^9, 3.60375796625817*^9}, {
   3.603758021867657*^9, 3.6037580319458003`*^9}, {3.6037581148365855`*^9, 
   3.603758114992836*^9}, {3.6037581538991623`*^9, 3.603758197539873*^9}, {
   3.603758305493213*^9, 3.6037587101346254`*^9}, {3.6037588894162273`*^9, 
   3.603758999666442*^9}, {3.603760029435766*^9, 3.6037600481701946`*^9}, {
   3.6037600784827356`*^9, 3.6037601110609264`*^9}, {3.603760223779894*^9, 
   3.6037603111706905`*^9}, {3.603760365311421*^9, 3.6037603757489414`*^9}, {
   3.6037605467024007`*^9, 3.6037605778118362`*^9}, {3.603760610233775*^9, 
   3.6037606469525976`*^9}, {3.60376086706242*^9, 3.6037609833595047`*^9}, {
   3.603761053828392*^9, 3.603761106234744*^9}, {3.603761172953624*^9, 
   3.6037611887036552`*^9}, {3.603761225578728*^9, 3.603761325188298*^9}, {
   3.6037614364541416`*^9, 3.60376146506359*^9}, {3.6037614970792627`*^9, 
   3.603761523985562*^9}, {3.603761568251274*^9, 3.603761570501278*^9}, {
   3.603761662673334*^9, 3.603761684345251*^9}, {3.603761717189066*^9, 
   3.6037617192984447`*^9}, {3.603761823986148*^9, 3.6037619607989163`*^9}, {
   3.6037624264248266`*^9, 3.603762430362336*^9}, {3.6037625122531195`*^9, 
   3.6037625126593704`*^9}, {3.6037629309570627`*^9, 
   3.6037630241134963`*^9}, {3.603763101004267*^9, 3.6037631963482113`*^9}, {
   3.6037632988484077`*^9, 3.6037632992234087`*^9}, {3.603763442864315*^9, 
   3.6037634470830727`*^9}, {3.603763642614705*^9, 3.6037636674116282`*^9}, {
   3.6037639461465483`*^9, 3.603763994740393*^9}, {3.603764572682246*^9, 
   3.603764572963496*^9}, {3.603764743729475*^9, 3.6037647479482136`*^9}, {
   3.603764921511053*^9, 3.603764921995429*^9}, {3.6037649829017982`*^9, 
   3.6037649839330544`*^9}, {3.6037650203549967`*^9, 3.603765021058124*^9}, {
   3.6037650563238297`*^9, 3.603765186995943*^9}, {3.6037652853242645`*^9, 
   3.603765354886901*^9}, 3.603765556231045*^9, {3.6037655949967456`*^9, 
   3.603765724340749*^9}, {3.6037659285442734`*^9, 3.603765944341179*^9}, {
   3.6037660176850724`*^9, 3.6037661880291553`*^9}, {3.6037662287792435`*^9, 
   3.603766229747986*^9}, 3.6037662742012005`*^9, {3.6037663091543913`*^9, 
   3.603766540529842*^9}, {3.6037665891705647`*^9, 3.6037666776551123`*^9}, {
   3.603766723842703*^9, 3.603766724342723*^9}, {3.603766863405475*^9, 
   3.603767069515258*^9}, {3.603767100984065*^9, 3.603767169531079*^9}, {
   3.6037673630470777`*^9, 3.603767382406491*^9}, {3.6037674567035108`*^9, 
   3.603767456828511*^9}, 3.603767763532256*^9, {3.6037678731418266`*^9, 
   3.603767946860719*^9}, {3.603768038110899*^9, 3.6037680397827835`*^9}, {
   3.603768088548497*^9, 3.6037681814393034`*^9}, {3.6037682167675114`*^9, 
   3.6037682493144355`*^9}, 3.604790237258142*^9, {3.60479132699465*^9, 
   3.6047913274477763`*^9}, {3.604791443698002*^9, 3.6047914441823893`*^9}, {
   3.6047928438257394`*^9, 3.6047928828414545`*^9}, {3.604792936950922*^9, 
   3.604792993466672*^9}, {3.6048420822217875`*^9, 3.6048421417219067`*^9}, {
   3.6048443912936025`*^9, 3.6048444722002363`*^9}, {3.604844510972452*^9, 
   3.6048446689845057`*^9}, {3.6048449731099215`*^9, 3.6048449760061064`*^9}, 
   3.6048450112711067`*^9, {3.604845158044513*^9, 3.6048452272454743`*^9}, {
   3.6048452947243395`*^9, 3.6048454314711695`*^9}, {3.6048454942857676`*^9, 
   3.604845581004737*^9}, {3.604845776814945*^9, 3.6048458210444803`*^9}, {
   3.604847094393404*^9, 3.6048471028008814`*^9}, {3.6048481865799503`*^9, 
   3.6048481898261356`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 3.5914868026208353`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{884, 832},
WindowMargins->{{22, Automatic}, {Automatic, 20}},
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 86, "Section"],
Cell[682, 25, 10110, 250, 732, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10829, 280, 175, 2, 86, "Section"],
Cell[CellGroupData[{
Cell[11029, 286, 106, 1, 49, "Subsection"],
Cell[11138, 289, 5966, 143, 352, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[17141, 437, 104, 1, 49, "Subsection"],
Cell[17248, 440, 35655, 729, 1695, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52952, 1175, 252, 5, 86, "Section"],
Cell[53207, 1182, 20661, 443, 2012, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[73905, 1630, 30, 0, 86, "Section"],
Cell[73938, 1632, 207, 4, 52, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
